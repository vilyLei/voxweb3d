(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["Lib_VoxUI"]=e():t["Lib_VoxUI"]=e()})("undefined"!==typeof self?self:this,(function(){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s="fae3")}({"0241":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("d632"),n=i("7dab");e.CtrlInfo=n.CtrlInfo;const l=i("d1de"),r=i("f042"),a=i("0efa"),o=i("1dcc"),h=i("822b"),u=i("9ba1");class c extends s.UIPanel{constructor(){super(),this.m_marginWidth=10,this.m_colorPanel=null,this.m_selectedPlane=null,this.m_btnMap=new Map,this.m_contentW=0,this.m_contentH=0,this.m_initing=!0,this.m_fontSize=30,this.m_btnPX=122,this.m_visiBtns=[],this.m_btns=[],this.m_menuBtn=null,this.m_currUUID=""}initialize(t,e,i=300,s=350,n=3){this.isIniting()&&(this.init(),this.m_marginWidth=n,this.m_scene=t,this.m_rpi=e,this.m_panelW=i,this.m_panelH=s,this.buildItems())}destroy(){super.destroy()}buildPanel(t,e){}buildItems(){this.m_initing&&(this.m_initing=!1,l.RendererDevice.IsMobileWeb()&&(this.m_fontSize=64,this.m_btnPX=300),l.RendererDevice.IsWebGL1()&&(this.m_btnPX+=32,this.m_fontSize=r.MathConst.CalcCeilPowerOfTwo(this.m_fontSize)),this.m_menuBtn=this.createSelectBtn("","menuCtrl","Menu Open","Menu Close",!1,!0))}createSelectBtn(t,e,i,s,n,r=!1){let a=this.m_scene,h=new o.SelectionEntity;return h.uuid=e,h.initialize(a,t,i,s,this.m_fontSize),h.addEventListener(l.SelectionEvent.SELECT,this,this.selectChange),n?h.select(!1):h.deselect(!1),this.m_btns.push(h),this.addEntity(h),h}createProgressBtn(t,e,i,s=!1){let n=this.m_scene,r=new h.ProgressEntity;return r.uuid=e,r.initialize(n,t,this.m_fontSize),r.setProgress(i,!1),r.addEventListener(l.ProgressDataEvent.PROGRESS,this,this.valueChange),this.m_btns.push(r),this.addEntity(r),r}createValueBtn(t,e,i,s,n,r=!1){let a=this.m_scene,o=new h.ProgressEntity;return o.uuid=e,o.initialize(a,t,this.m_fontSize),o.setRange(s,n),o.setValue(i,!1),o.addEventListener(l.ProgressDataEvent.PROGRESS,this,this.valueChange),this.m_btns.push(o),this.addEntity(o),o}openThis(){null!=this.m_menuBtn&&(this.menuCtrl(!0),this.m_menuBtn.deselect(!0),this.layoutItem())}closeThis(){null!=this.m_menuBtn&&(this.menuCtrl(!1),this.m_menuBtn.select(!1),null!=this.m_selectedPlane&&this.m_selectedPlane.setVisible(!1))}layout(){}layoutPickColorPanel(t){let e=this.m_colorPanel;if(null!=e&&e.isOpen()){let i=t.getGlobalBounds();e.setXY(i.max.x-e.getWidth(),i.max.y+2),e.setZ(t.getZ()+.3),e.update()}}colorSelectListener(t,e,i){let s=this.m_colorPanel;if(null!=s&&s.isOpen())s.close(),this.m_colorPanel=null;else{let s=this.getScene().panel.getPanel("colorPickPanel");null!=s&&(s.isOpen()?s.close():(this.m_colorPanel=s,s.open(),s.setPickXY(-1,-1),s.setColor(i),this.layoutPickColorPanel(e),s.setSelectColorCallback((e,i,s)=>{this.selectColor(t,e)})))}}moveSelectToBtn(t){this.createSelectPlane();let e=r.VoxMath.createVec3(t.getX(),t.getY());this.m_selectedPlane.setXY(e.x,e.y),this.m_selectedPlane.setScaleXY(t.getWidth(),3),this.m_selectedPlane.update(),this.m_selectedPlane.setVisible(!0)}createSelectPlane(){null==this.m_selectedPlane&&(this.m_selectedPlane=new u.ColorLabel,this.m_selectedPlane.initialize(1,1),this.m_selectedPlane.depthTest=!0,this.addEntity(this.m_selectedPlane),this.m_selectedPlane.setColor(a.VoxMaterial.createColor4(.05,.1,.05)))}addItem(t){let e=this.m_btnMap;if(!e.has(t.uuid)){let i=new n.CtrlItemObj;i.param=t,i.type=t.type,i.uuid=t.uuid;let s=t,l=!!s.visibleAlways&&s.visibleAlways;switch(s.colorPick=!!s.colorPick&&s.colorPick,t.type){case"number_value":case"number":s.value=s.value?s.value:0,s.minValue=s.minValue?s.minValue:0,s.maxValue=s.maxValue?s.maxValue:10,i.btn=this.createValueBtn(s.name,s.uuid,s.value,s.minValue,s.maxValue),e.set(i.uuid,i),s.colorPick||(i.info={type:t.type,uuid:t.uuid,values:[s.value],flag:s.flag},t.callback(i.info));break;case"progress":s.progress=s.progress?s.progress:0,i.btn=this.createProgressBtn(s.name,s.uuid,s.progress,l),e.set(i.uuid,i),s.colorPick||(i.info={type:t.type,uuid:t.uuid,values:[s.progress],flag:s.flag},t.callback(i.info));break;case"status":case"status_select":s.flag=!!s.flag&&s.flag,i.btn=this.createSelectBtn(s.name,s.uuid,s.selectNS,s.deselectNS,s.flag,l),e.set(i.uuid,i),i.info={type:t.type,uuid:t.uuid,values:[],flag:s.flag},t.callback(i.info);break;default:break}}}addItems(t){for(let e=0;e<t.length;++e)this.addItem(t[e])}getItemByUUID(t){return this.m_btnMap.has(t)?this.m_btnMap.get(t):null}menuCtrl(t){let e=this.m_visiBtns;if(e.length>0)if(t&&!e[0].isOpen()){for(let t=0;t<e.length;++t)e[t].open();this.m_menuBtn.getPosition(this.m_pos),this.m_pos.x=this.m_btnPX,this.m_menuBtn.setPosition(this.m_pos)}else if(e[0].isOpen()){for(let t=0;t<e.length;++t)e[t].close();this.m_menuBtn.getPosition(this.m_pos),this.m_pos.x=0,this.m_menuBtn.setPosition(this.m_pos),null!=this.m_selectedPlane&&this.m_selectedPlane.setVisible(!1)}null!=this.m_colorPanel&&this.m_colorPanel.close()}layoutItem(){if(null!=this.m_menuBtn){let t=2,e=2,i=this.m_marginWidth,s=r.VoxMath.createVec3(i+t,i),n=s.clone(),l=0,a=this.m_btns;for(let r=0;r<a.length;++r)a[r].update(),a[r].getNameWidth()>l&&(l=a[r].getNameWidth());s.x+=l;let o=0,h=n.y;for(let r=0;r<a.length;++r){let i=a[r].getNameWidth();i=i>0?i+t:0,n.x=s.x-i,a[r].setPosition(n),a[r].update(),a[r].getWidth()>o&&(o=a[r].getWidth()),n.y+=a[r].getHeight()+e}this.m_contentW=o+2*i,this.m_contentH=n.y-h+3*i,this.updateBgSize()}}updateBgSize(){let t=this.m_contentW,e=this.m_contentH,i=Math.abs(t-this.m_panelW)>1e-4;if(i=i||Math.abs(e-this.m_panelH)>1e-4,null!=this.m_bgLabel&&i){let i=t/this.m_panelW,s=e/this.m_panelH;this.m_bgLabel.setScaleXY(i,s),this.m_bgLabel.update(),this.update()}}selectChange(t){let e=t.flag,i=t.uuid,s=this.m_btnMap;if(s.has(i)){let n=s.get(i);n.sendFlagOut(e),this.moveSelectToBtn(t.target)}null!=this.m_colorPanel&&this.m_colorPanel.close()}selectColor(t,e){let i=this.m_btnMap;if(i.has(t)){let s=i.get(t),n=s.param;n.colorPick&&s.sendColorOut(e)}}valueChange(t){let e=t.value,i=t.uuid,s=this.m_btnMap,n=this.m_currUUID!=i;if(this.m_currUUID=i,s.has(i)){let l=s.get(i),r=l.param;if(2==t.status)l.sendValueOut(e),null!=this.m_colorPanel&&n&&this.m_colorPanel.close();else if(0==t.status)if(r.colorPick){let e=a.VoxMaterial.createColor4();e.fromArray3(l.color),this.colorSelectListener(t.uuid,t.target,e)}else null!=this.m_colorPanel&&this.m_colorPanel.close();this.moveSelectToBtn(t.target)}}addStatusItem(t,e,i,s,n,l,r=!0){let a={type:"status_select",name:t,uuid:e,selectNS:i,deselectNS:s,flag:n,visibleAlways:r,callback:l};this.addItem(a)}addProgressItem(t,e,i,s,n,l=!0){let r={type:"progress",name:t,uuid:e,progress:i,visibleAlways:l,colorPick:n,callback:s};this.addItem(r)}addValueItem(t,e,i,s,n,l,r,a=!0,o){let h={type:"number_value",name:t,uuid:e,value:i,minValue:s,maxValue:n,visibleAlways:a,colorPick:r,values:o,callback:l};this.addItem(h)}}e.ParamCtrlPanel=c},"05f0":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("c21f"),n=i("9b53"),l=i("228b"),r=i("0efa");class a extends s.ClipLabelBase{constructor(){super(...arguments),this.m_colors=null,this.m_material=null,this.m_fixSize=!0,this.m_hasTex=!1}createMesh(t,e){let i=new Uint16Array([0,1,2,0,2,3]),s=new Float32Array(this.createVS(0,0,this.m_width,this.m_height)),n=l.VoxMesh.createRawMesh();if(n.reset(),n.setIVS(i),n.addFloat32Data(s,3),""!=e&&null!=t){let i=t.getTexObjFromAtlas(e),s=new Float32Array(i.uvs);n.addFloat32Data(s,2)}return n.initialize(),n}hasTexture(){return this.m_hasTex}initialize(t,e,i){if(this.isIniting()&&i>0){this.init(),this.m_hasTex=!1;let s=null;if(""!=e&&null!=t){let i=t.getTexObjFromAtlas(e);this.m_fixSize&&(this.m_width=i.getWidth(),this.m_height=i.getHeight()),this.m_hasTex=!0,s=i.texture}let l=this.createMaterial(s),a=this.createMesh(t,e),o=n.VoxEntity.createDisplayEntity();o.setMaterial(l),o.setMesh(a),this.m_entities.push(o),this.m_material=l;let h=new Array(i);for(let t=0;t<i;++t)h[t]=r.VoxMaterial.createColor4();this.m_colors=h,this.m_total=i,this.setClipIndex(0)}}initializeWithoutTex(t,e,i){this.m_width=t,this.m_height=e,this.m_fixSize=!1,this.initialize(null,"",i)}initializeWithSize(t,e,i,s,n){t>0&&e>0&&(this.m_width=t,this.m_height=e,this.m_fixSize=!1,this.initialize(i,s,n))}initializeWithLable(t){if(this.isIniting()&&null!=t&&t!=this){if(t.getClipsTotal()<1)throw Error("Error: srcLable.getClipsTotal() < 1");let e=t.getREntities();for(let i=0;i<e.length;++i){let s=e[i],l=s.getMesh(),a=s.getMaterial().getTextureAt(0),o=this.m_total=t.getClipsTotal(),h=t.getColors(),u=new Array(o);for(let t=0;t<o;++t)u[t]=r.VoxMaterial.createColor4(),u[t].copyFrom(h[t]);this.m_colors=u,this.m_width=t.getWidth(),this.m_height=t.getHeight();let c=this.createMaterial(a),m=n.VoxEntity.createDisplayEntity();m.setMaterial(c),m.setMesh(l),this.m_entities.push(m),null==this.m_material&&(this.m_material=c)}this.setClipIndex(0)}}displaceFromLable(t){if(null!=t&&t!=this&&t.getClipsTotal()<1)throw Error("Error: srcLable.getClipsTotal() < 1")}getColorAt(t){if(t>=0&&t<this.m_total)return this.m_colors[t]}setColorAt(t,e){t>=0&&t<this.m_total&&null!=e&&this.m_colors[t].copyFrom(e)}setColors(t){if(null!=t){let e=this.m_colors,i=t.length;i>e.length&&(i=e.length);for(let s=0;s<i;++s)e[s].copyFrom(t[s]);3==i&&4==e.length&&e[3].copyFrom(t[1]),this.setClipIndex(this.m_index)}}setColorsWithHex(t){if(null!=t){let e=this.m_colors,i=t.length;i>e.length&&(i=e.length);for(let s=0;s<i;++s)e[s].setRGBUint24(t[s]);3==i&&4==e.length&&e[3].setRGBUint24(t[1]),this.setClipIndex(this.m_index)}}setClipIndex(t){t>=0&&t<this.m_total&&(this.m_index=t,this.m_material.setColor(this.m_colors[t]))}getColors(){return this.m_colors}}e.ClipColorLabel=a},"0aa4":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.m_tipEntity=null}initialize(t,e=2){if(null==this.m_tipEntity){this.m_uiscene=t;let i=Lib_VoxUI.createRectTextTip();i.initialize(t,e),this.m_tipEntity=i}}getTipEntity(t){return this.m_tipEntity}addTipsTarget(t,e){this.m_tipEntity.addEntity(t)}removeTipsTarget(t,e){this.m_tipEntity.removeEntity(t)}destroy(){}}e.TipsSystem=s},"0b77":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.m_sc=null,this.m_parent=null,this.m_rotation=0,this.m_visible=!0,this.m_entities=[],this.m_width=0,this.m_height=0,this.m_v0=null,this.m_bounds=null,this.m_rcontainer=null,this.premultiplyAlpha=!1,this.transparent=!1,this.info=null,this.depthTest=!1}init(){this.isIniting()&&(this.m_pos=CoMath.createVec3(),this.m_scaleV=CoMath.createVec3(1,1,1),this.m_v0=CoMath.createVec3(),this.m_bounds=CoMath.createAABB())}isIniting(){return null==this.m_bounds}createMaterial(t=null){let e=CoMaterial.createDefaultMaterial();return e.premultiplyAlpha=this.premultiplyAlpha,null!=t&&e.setTextureList([t]),e.initializeByCodeBuf(null!=t),e}applyRST(t){const e=CoRScene.RendererState;this.transparent?this.premultiplyAlpha?t.setRenderState(e.BACK_ALPHA_ADD_ALWAYS_STATE):this.depthTest?t.setRenderState(e.BACK_TRANSPARENT_STATE):t.setRenderState(e.BACK_TRANSPARENT_ALWAYS_STATE):this.depthTest?t.setRenderState(e.NORMAL_STATE):t.setRenderState(e.BACK_NORMAL_ALWAYS_STATE)}createVS(t,e,i,s){let n=t,l=e,r=t+i,a=e+s,o=0;return[n,l,o,r,l,o,r,a,o,n,a,o]}updateScene(){}updateParent(){}__$setScene(t){this.m_sc!=t&&(this.m_sc=t,this.updateScene())}getScene(){return this.m_sc}setParent(t){return t!=this&&(this.m_parent=t,this.updateParent()),this}getParent(){return this.m_parent}getGlobalBounds(){return this.m_bounds}setVisible(t){this.m_visible=t;let e=this.m_entities;for(let i=0;i<e.length;++i)e[i].setVisible(t);null!=this.m_rcontainer&&this.m_rcontainer.setVisible(t)}isVisible(){return this.m_visible}getWidth(){return this.m_bounds.getWidth()}getHeight(){return this.m_bounds.getHeight()}setPosition(t){this.m_pos.copyFrom(t)}setX(t){this.m_pos.x=t}setY(t){this.m_pos.y=t}setZ(t){this.m_pos.z=t}getX(){return this.m_pos.x}getY(){return this.m_pos.y}getZ(){return this.m_pos.z}setXY(t,e){this.m_pos.x=t,this.m_pos.y=e}setXYZ(t,e,i){this.m_pos.setXYZ(t,e,i)}getPosition(t){return t.copyFrom(this.m_pos),t}setRotation(t){this.m_rotation=t}getRotation(){return this.m_rotation}setScaleXYZ(t,e,i){this.m_scaleV.setXYZ(t,e,i)}setScaleXY(t,e){this.setScaleXYZ(t,e,1)}setScaleX(t){this.m_scaleV.x=t}setScaleY(t){this.m_scaleV.y=t}getScaleX(){return this.m_scaleV.x}getScaleY(){return this.m_scaleV.y}copyTransformFrom(t){if(null!=t){let e=t.getScaleX(),i=t.getScaleY(),s=t.getRotation();this.setScaleXY(e,i),this.setRotation(s),t.getPosition(this.m_v0),this.setPosition(this.m_v0)}}getREntities(){return this.m_entities.slice(0)}getRContainer(){return this.m_rcontainer}updateEntity(t){t.setPosition(this.m_pos),t.setScale3(this.m_scaleV),t.setRotationXYZ(0,0,this.m_rotation),t.update(),this.m_bounds.union(t.getGlobalBounds())}update(){let t=this.m_entities,e=this.m_bounds;this.m_bounds.reset();for(let i=0;i<t.length;++i)this.updateEntity(t[i]);null!=this.m_rcontainer&&this.updateEntity(this.m_rcontainer),e.updateFast()}destroy(){let t=this.m_sc;null!=t&&t.removeEntity(this),this.m_rcontainer=null,this.m_sc=null,this.m_parent=null,this.m_bounds=null;let e=this.m_entities;for(let i=0;i<e.length;++i)e[i].destroy();e=[]}}e.UIEntityBase=s},"0efa":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("75f5");class n{constructor(){this.m_init=!0}initialize(t=null,e=""){return this.m_init=!this.isEnabled(),!!this.m_init&&(this.m_init=!1,""!=e&&void 0!==e||(e="static/cospace/coMaterial/CoMaterial.umd.min.js"),new s.ModuleLoader(1,()=>{null!=t&&this.isEnabled()&&t([e])}).load(e),!0)}isEnabled(){return"undefined"!==typeof CoMaterial}createColor4(t,e,i,s){return CoMaterial.createColor4(t,e,i,s)}createDefaultMaterial(t){return CoMaterial.createDefaultMaterial(t)}createLineMaterial(t){return CoMaterial.createLineMaterial(t)}createQuadLineMaterial(t){return CoMaterial.createQuadLineMaterial(t)}createShaderMaterial(t){return CoMaterial.createShaderMaterial(t)}createMaterial(t){return CoMaterial.createMaterial(t)}creatMaterialContextParam(){return CoMaterial.creatMaterialContextParam()}createMaterialContext(){return CoMaterial.createMaterialContext()}}const l=new n;e.VoxMaterial=l},"189a":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("5470");class n extends s.LayouterBase{constructor(){super(),this.m_offsetvs=[]}update(t){const e=this.m_entities,i=e.length;let s=CoMath.createVec3();for(let n=0;n<i;++n)s.copyFrom(this.m_offsetvs[n]),s.x=t.width-s.x,s.y=t.height-s.y,s.addBy(this.m_offsetV),e[n].setPosition(s),e[n].update()}initEntityLayout(t,e){let i=CoMath.createVec3();t.getPosition(i),i.x=e.width-i.x,i.y=e.height-i.y,this.m_offsetvs.push(i)}destroy(){this.m_offsetvs=null,super.destroy()}}e.RightTopLayouter=n},"1dcc":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("d1de"),n=i("5ea3");class l extends n.CompEntityBase{constructor(){super(),this.m_dispatcher=null,this.m_currEvent=null,this.m_nameItem=null,this.m_flagItem=null,this.m_flag=!0,this.m_enabled=!0,this.m_nameWidth=0,this.uuid="SelectionEntity"}enable(){this.m_enabled=!0}disable(){this.m_enabled=!1}open(){this.setVisible(!0)}close(){this.setVisible(!1)}isOpen(){return this.isVisible()}isClosed(){return!this.isVisible()}addEventListener(t,e,i,s=!0,n=!1){this.m_dispatcher.addEventListener(t,e,i,s,n)}removeEventListener(t,e,i){this.m_dispatcher.removeEventListener(t,e,i)}select(t=!1){this.m_flag||(this.m_flag=!0,this.updateState(),t&&this.sendEvt())}deselect(t=!1){this.m_flag&&(this.m_flag=!1,this.updateState(),t&&this.sendEvt())}setFlag(t,e=!1){t?this.select(e):this.deselect(e)}isSelected(){return this.m_flag}nameBtnMouseDown(t){this.m_enabled&&(this.m_flag=!this.m_flag,this.updateState(),this.sendEvt())}sendEvt(){let t=this.m_currEvent;t.target=this,t.type=s.SelectionEvent.SELECT,t.flag=this.m_flag,t.phase=1,t.uuid=this.uuid,this.m_dispatcher.dispatchEvt(t),t.target=null}updateState(){this.m_flagItem.label.setClipIndex(this.m_flag?0:1)}btnMouseUp(t){this.m_enabled&&(this.m_flag=!this.m_flag,this.updateState(),this.sendEvt())}destroy(){super.destroy(),null!=this.m_flagItem&&(this.m_nameItem.destroy(),this.m_nameItem=null,this.m_flagItem.destroy(),this.m_flagItem=null,this.m_dispatcher.destroy(),this.m_dispatcher=null)}getNameWidth(){return this.m_nameWidth}initialize(t,e="select",i="Yes",n="No",l=30,r=70,a=50,o=40){if(this.isIniting()){this.init();let h=2;if(this.m_dispatcher=s.VoxRScene.createEventBaseDispatcher(),this.m_currEvent=s.VoxRScene.createSelectionEvent(),""!=e){let i=this.createBtn("name",t,[e],l,r,o);this.addEntity(i.button),this.m_nameWidth=i.button.getWidth(),this.m_nameItem=i,i.button.addEventListener(s.MouseEvent.MOUSE_DOWN,this,this.nameBtnMouseDown)}let u=this.createBtn("flag",t,[i,n],l,a,o);""!=e&&u.button.setX(this.m_nameWidth+h),this.addEntity(u.button),this.m_flagItem=u,u.button.addEventListener(s.MouseEvent.MOUSE_UP,this,this.btnMouseUp)}}}e.SelectionEntity=l},"1eb2":function(t,e,i){"use strict";if("undefined"!==typeof window){var s=window.document.currentScript,n=i("8875");s=n(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:n});var l=s&&s.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);l&&(i.p=l[1])}},"228b":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("75f5");class n{constructor(){this.m_init=!0}initialize(t=null,e=""){return this.m_init=!this.isEnabled(),!!this.m_init&&(this.m_init=!1,""!=e&&void 0!==e||(e="static/cospace/comesh/CoMesh.umd.min.js"),new s.ModuleLoader(1,()=>{null!=t&&this.isEnabled()&&t([e])}).load(e),!0)}isEnabled(){return"undefined"!==typeof CoMesh}get plane(){return CoMesh.plane}get line(){return CoMesh.line}get cone(){return CoMesh.cone}get box(){return CoMesh.box}get sphere(){return CoMesh.sphere}createDataMesh(){return CoMesh.createDataMesh()}createRawMesh(){return CoMesh.createRawMesh()}createBoundsMesh(){return CoMesh.createBoundsMesh()}}const l=new n;e.VoxMesh=l},"23ac":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("0b77");class n extends s.UIEntityBase{constructor(){super(),this.m_uientities=[]}init(){this.isIniting()&&(super.init(),this.m_rcontainer=CoRScene.createDisplayEntityContainer())}addedEntity(t){}removedEntity(t){}update(){for(let t=0;t<this.m_uientities.length;++t)this.m_uientities[t].update();null!=this.m_rcontainer&&this.m_rcontainer.update(),super.update()}addEntity(t){if(null!=t){let e=0;for(;e<this.m_uientities.length;++e)if(this.m_uientities[e]==t)break;if(e>=this.m_uientities.length){this.m_uientities.push(t),t.update();let e=t.getRContainer();null!=e&&this.m_rcontainer.addChild(e);let i=t.getREntities();for(let t=0;t<i.length;++t)this.m_rcontainer.addEntity(i[t]);this.addedEntity(t)}}}removeEntity(t){if(null!=t){let e=0;for(;e<this.m_uientities.length;++e)if(this.m_uientities[e]==t){this.m_uientities.splice(e,1);let i=t.getRContainer();null!=i&&this.m_rcontainer.removeChild(i);let s=t.getREntities();for(let t=0;t<s.length;++t)this.m_rcontainer.removeEntity(s[t]);this.removedEntity(t);break}}}globalToLocal(t){this.m_rcontainer.globalToLocal(t)}localToGlobal(t){this.m_rcontainer.localToGlobal(t)}getEneitysTotal(){return this.m_uientities.length}}e.UIEntityContainer=n},2564:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(t,e=null,i=null){this.m_uid=s.s_uid++,this.m_urlChecker=null,this.m_oneTimes=!0,this.m_loaderMap=null,this.m_callback=e,this.m_times=t,this.m_urlChecker=i}setUrlChecker(t=null){this.m_urlChecker=t}getUrlChecker(){return this.m_urlChecker}getUid(){return this.m_uid}setCallback(t){return this.m_callback=t,this}addLoader(t){if(null!=t&&t!=this)if(this.isFinished())t.use();else{null==this.m_loaderMap&&(this.m_loaderMap=new Map);let e=this.m_loaderMap;e.has(t.getUid())||e.set(t.getUid(),t)}return this}isFinished(){return 0==this.m_times}useOnce(){this.m_oneTimes&&(this.m_oneTimes=!1,this.use())}use(){if(this.m_times>0&&(this.m_times--,this.isFinished()&&null!=this.m_callback&&(this.m_callback(),this.m_callback=null,null!=this.m_loaderMap))){for(let[t,e]of this.m_loaderMap)e.use();this.m_loaderMap=null}}hasModuleByUrl(t){return s.loadedMap.has(t)}load(t){if(""==t)return this;null!=this.m_urlChecker&&(t=this.m_urlChecker(t));let e=s.loadedMap;if(e.has(t))return void this.use();let i=s.loadingMap;if(!i.has(t))return i.set(t,[this]),this.loadData(t),this;{let e=i.get(t);for(let t=0;t<e.length;++t)if(e[t]==this)return;e.push(this)}}loadData(t){let e=new XMLHttpRequest;e.open("GET",t,!0),e.onerror=function(t){},e.onload=e=>{this.loadedUrl(t)},e.send(null)}loadedData(t,e){}loadedUrl(t){let e=s.loadedMap,i=s.loadingMap;e.set(t,1);let n=i.get(t);for(let s=0;s<n.length;++s)n[s].use();i.delete(t)}getDataByUrl(t){return null}clearAllData(){}destroy(){this.m_urlChecker=null}}s.s_uid=0,s.loadedMap=new Map,s.loadingMap=new Map,e.PackedLoader=s},"2b5a":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("4041");e.CtrlInfo=s.CtrlInfo,e.ItemCallback=s.ItemCallback},"36f3":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("5470");class n extends s.LayouterBase{constructor(){super(),this.m_offsetvs=[]}update(t){const e=this.m_entities,i=e.length;for(let s=0;s<i;++s)e[s].update()}initEntityLayout(t,e){let i=CoMath.createVec3();t.getPosition(i),i.y=e.height-i.y,this.m_offsetvs.push(i)}destroy(){this.m_offsetvs=null,super.destroy()}}e.FreeLayouter=n},"38b3":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("0b77");class n extends s.UIEntityBase{constructor(){super(),this.m_pw=10,this.m_ph=10,this.m_sx=1,this.m_sy=1,this.m_material=null,this.m_tex=null,this.m_fontSize=24,this.m_text=""}initialize(t,e,i=24){if(""!=t&&this.isIniting()){i<8&&(i=8),this.m_fontSize=i,this.init(),this.m_text=t,this.m_uiScene=e;let s=CoEntity.createDisplayEntity();this.m_fontColor=CoMaterial.createColor4(),this.m_bgColor=CoMaterial.createColor4(1,1,1,0);let n=this.m_uiScene.texAtlas.createCharsImage(this.m_text,this.m_fontSize,this.m_fontColor,this.m_bgColor);this.m_tex=e.rscene.textureBlock.createImageTex2D(n.width,n.height),this.m_tex.setDataFromImage(n),this.m_tex.flipY=!0,this.m_tex.premultiplyAlpha=!0,this.m_tex.minFilter=CoRScene.TextureConst.LINEAR,this.m_tex.magFilter=CoRScene.TextureConst.NEAREST;let l=this.createMaterial(this.m_tex);this.m_material=l,CoMesh.plane.setBufSortFormat(l.getBufSortFormat());let r=CoMesh.plane.createXOY(0,0,1,1);this.m_pw=n.width,this.m_ph=n.height,s.setMaterial(l),s.setMesh(r),this.m_entities.push(s),this.applyRST(s),super.setScaleXY(this.m_sx*this.m_pw,this.m_sy*this.m_ph),this.update()}}setScaleXY(t,e){this.m_sx=t,this.m_sy=e,super.setScaleXY(t*this.m_pw,e*this.m_ph)}setScaleX(t){this.m_sx=t,super.setScaleX(t*this.m_pw)}setScaleY(t){this.m_sy=t,super.setScaleX(t*this.m_ph)}getScaleX(){return this.m_sx}getScaleY(){return this.m_sy}setText(t){if(null!=this.m_tex&&""!=t&&this.m_text!=t){this.m_text=t;let e=this.m_uiScene.texAtlas.createCharsImage(t,this.m_fontSize,this.m_fontColor,this.m_bgColor);this.m_tex.setDataFromImage(e,0,0,0,!0),this.m_tex.updateDataToGpu(),this.m_pw=e.width,this.m_ph=e.height,super.setScaleXY(this.m_sx*this.m_pw,this.m_sy*this.m_ph),this.update()}}getText(){return this.m_text}setColor(t){return this.m_fontColor.copyFrom(t),null!=this.m_material&&this.m_material.setColor(t),this}getColor(){return this.m_fontColor}destroy(){super.destroy(),this.m_material=null,this.m_uiScene=null,this.m_tex=null}}e.TextLabel=n},4041:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},5470:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.m_entities=[],this.m_opvs=[],this.m_initRect=null,this.m_offsetV=CoMath.createVec3()}setOffset(t){this.m_offsetV.copyFrom(t)}addUIEntity(t){if(null!=t){let e=0;for(;e<this.m_entities.length;++e)if(this.m_entities[e]==t)break;if(e>=this.m_entities.length){let e=CoMath.createVec3();t.getPosition(e),this.m_opvs.push(e),this.m_entities.push(t),null!=this.m_initRect&&this.initEntityLayout(t,this.m_initRect)}}}removeUIEntity(t){if(null!=t){let e=0;for(;e<this.m_entities.length;++e)if(this.m_entities[e]==t){this.m_entities.splice(e,1),this.m_opvs.splice(e,1);break}}}initLayout(t){if(null!=t){null!=this.m_initRect?this.m_initRect.copyFrom(t):this.m_initRect=t.clone();let e=this.m_entities;for(let t=0;t<e.length;++t)this.initEntityLayout(e[t],this.m_initRect)}}initEntityLayout(t,e){}applyLayout(t){}update(t){}destroy(){}}e.LayouterBase=s},"5ea3":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("0efa"),n=i("88b9"),l=i("05f0"),r=i("f35d"),a=i("23ac");class o{constructor(t,e,i){this.button=t,this.label=e,this.bgLabel=i}destroy(){null!=this.button&&(this.button.destroy(),this.button=null),null!=this.bgLabel&&(this.bgLabel.destroy(),this.bgLabel=null),null!=this.label&&(this.label.destroy(),this.label=null)}}e.ButtonItem=o;class h extends a.UIEntityContainer{constructor(){super(),this.m_fontColor=null,this.m_fontBgColor=null,this.m_bgColors=null}getNameWidth(){return 0}setFontColor(t,e){this.m_fontColor=t,this.m_fontBgColor=e}setBGColors(t){if(null==t)throw Error("colors == null !!!");if(t.length<4)throw Error("colors.length < 4 !!!");this.m_bgColors=t}destroy(){super.destroy(),this.m_fontColor=null,this.m_fontBgColor=null,this.m_bgColors=null}createBgLabel(t,e,i=1){let s=new l.ClipColorLabel;s.initializeWithoutTex(t,e,4);let n=this.m_bgColors,r=s.getColors();if(null==n)s.getColorAt(0).setRGB3f(.2,.2,.2),s.getColorAt(1).setRGB3f(.3,.3,.3),s.getColorAt(2).setRGB3f(.2,.6,1),s.getColorAt(3).setRGB3f(.3,.3,.3);else for(let l=0;l<r.length;++l)r[l].copyFrom(n[l]);for(let l=0;l<r.length;++l){const t=r[l];t.r*=i,t.g*=i,t.b*=i}return s.setClipIndex(0),s}createBtn(t,e,i,l,a,h,u=1){let c,m=e.transparentTexAtlas,_=null,d=null!=this.m_fontColor?this.m_fontColor:s.VoxMaterial.createColor4(1,1,1,1),p=null!=this.m_fontBgColor?this.m_fontBgColor:s.VoxMaterial.createColor4(1,1,1,0);if(null!=i&&i.length>0){for(let t=0;t<i.length;++t)c=m.createCharsCanvasWithSize(a,h,6,4,i[t],l,d,p),m.addImageToAtlas(i[t],c);_=new r.ClipLabel,_.transparent=!0,_.premultiplyAlpha=!0,_.initialize(m,i),_.update(),a=_.getWidth()}let g=this.createBgLabel(a,h,u),C=new n.Button;return""!=t&&(C.uuid=t),null!=i&&i.length>0&&(C.syncLabelClip=!1,C.addLabel(_)),C.initializeWithLable(g),C.update(),new o(C,_,g)}}e.CompEntityBase=h},"677d":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){}calcRange(t,e=.7,i=.5){i<0?i=0:i>1&&(i=1),e<0?e=0:e>1&&(e=1);let s=t*(1-e),n=i*t,l=n+.5*s;l>t&&(l=t);let r=l-s;return[r,l]}avgLayout(t,e,i,s=-1){if(null!=t&&t.length>0){let n=t.length;switch(n){case 1:let n=.5*(i-e)+e;return[n-.5*t[0]];default:return this.calcAvgMulti(t,e,i,s)}}return null}calcAvgLayout(t,e,i=.7,s=.5){let n=this.calcRange(e,i,s);return this.avgLayout(t,n[0],n[1])}calcAvgFixLayout(t,e,i=10,s=.7,n=.5){let l=this.calcRange(e,s,n);return this.avgLayout(t,l[0],l[1],i)}calcAvgMulti(t,e,i,s=-1){let n=i-e,l=t.length,r=0;for(let o=0;o<l;o++)r+=t[o],s>0&&o>0&&(r+=s);let a=new Array(l);if(a[0]=e,a[l-1]=i-t[l-1],l>2)if(r<n){let e=(n-r)/(l-1);l--;for(let i=1;i<l;i++)a[i]=a[i-1]+t[i-1]+e}else if(s<=0){let e=a[0]+.5*t[0];n=a[l-1]+.5*t[l-1]-e;let i=n/(l-1);e+=i,l--;for(let t=1;t<l;t++)a[t]=e,e+=i}if(r>=n&&s>0){let i=.5*n+e-.5*(r+(l-1)*s);for(let e=0;e<l;e++)a[e]=i,i+=t[e]+s}return a}}e.AxisAlignCalc=s},7020:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(t=!0){this.m_map=new Map,this.m_selectFunc=null,this.m_deselectFunc=null,this.m_mouseUpSelect=!0,this.m_btn=null,this.m_mouseUpSelect=t}addButton(t){if(null!=t){null==this.m_map&&(this.m_map=new Map),this.m_map.set(t.uuid,t);const e=CoRScene.MouseEvent;this.m_mouseUpSelect?t.addEventListener(e.MOUSE_UP,this,this.mouseEvtFunc):t.addEventListener(e.MOUSE_DOWN,this,this.mouseEvtFunc)}}mouseEvtFunc(t){this.select(t.currentTarget.uuid)}setSelectedFunction(t,e){this.m_selectFunc=t,this.m_deselectFunc=e}select(t){if(null!=this.m_map&&this.m_map.has(t)){let e=this.m_map.get(t);this.m_btn!=e&&(null!=this.m_btn&&null!=this.m_deselectFunc&&this.m_deselectFunc(this.m_btn),this.m_btn=e,null!=this.m_selectFunc&&this.m_selectFunc(e))}}destroy(){this.m_btn=null,this.m_map=null,this.m_selectFunc=null,this.m_deselectFunc=null}}e.SelectButtonGroup=s},"75f5":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("2564");class n extends s.PackedLoader{constructor(t,e=null,i=null){super(t,e,i)}loadData(t){let e=new XMLHttpRequest;e.open("GET",t,!0),e.onerror=function(t){},e.onload=i=>{this.loadedData(e.response,t),this.loadedUrl(t)},e.send(null)}loadedData(t,e){let i=document.createElement("script");i.onerror=t=>{},i.type="text/javascript";try{i.innerHTML=t,document.head.appendChild(i)}catch(s){throw s}}}e.ModuleLoader=n},7908:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("efac"),n=i("189a"),l=i("9686"),r=i("36f3");class a{constructor(){this.m_layouters=[],this.m_rect=null}createFreeLayouter(){let t=new r.FreeLayouter;return this.addLayouter(t),t}createLeftTopLayouter(){let t=new s.LeftTopLayouter;return this.addLayouter(t),t}createRightTopLayouter(){let t=new n.RightTopLayouter;return this.addLayouter(t),t}createRightBottomLayouter(){let t=new l.RightBottomLayouter;return this.addLayouter(t),t}initialize(t){null!=t&&null==this.m_rect&&(t.update(),this.m_rect=CoMath.createAABB2D(t.x,t.y,t.width,t.height))}getAreaRect(){return this.m_rect}addLayouter(t){if(null!=t){let e=0,i=this.m_layouters;for(;e<i.length;++e)if(i[e]==t)break;e>=i.length&&(i.push(t),t.initLayout(this.m_rect))}}removeLayouter(t){if(null!=t){let e=0,i=this.m_layouters;for(;e<i.length;++e)if(i[e]==t){i.splice(e,1);break}}}update(t){this.m_rect.copyFrom(t);for(let e=0;e<this.m_layouters.length;++e)this.m_layouters[e].update(t)}destroy(){}}e.UILayout=a},7913:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("38b3"),n=i("d632"),l=i("cdda"),r=i("677d");class a extends n.UIPanel{constructor(){super(),this.m_promptLabel=null,this.m_prompt="Hi,Prompt Panel.",this.m_btnW=90,this.m_btnH=50,this.m_confirmFunc=null,this.m_cancelFunc=null,this.m_cancelBtnVis=!0,this.marginWidth=70,this.marginXFactor=.5,this.marginYFactor=.6,this.m_alignCalc=new r.AxisAlignCalc}initialize(t,e,i,s,n,l,r="Confirm",a="Cancel"){this.isIniting()&&(this.init(),this.m_scene=t,this.m_rpi=e,this.m_panelW=i,this.m_panelH=s,this.m_btnW=n,this.m_btnH=l,this.m_confirmNS=r,this.m_cancelNS=a,null==this.m_bgColor&&(this.m_bgColor=CoMaterial.createColor4()))}applyConfirmButton(){this.m_cancelBtnVis=!1;let t=this.m_cancelBtn;null==t||t.isVisible()||(this.m_cancelBtn.setVisible(!1),null!=this.m_confirmBtn&&this.isOpen()&&(this.layoutItems(),this.layout()))}applyAllButtons(){this.m_cancelBtnVis=!0,null!=this.m_cancelBtn&&this.m_cancelBtn.setVisible(!0)}setPrompt(t){if(""!=t&&this.m_prompt!=t){this.m_prompt=t;let e=this.m_promptLabel;if(null!=e){e.setText(t);let i=.5*(this.m_panelW-e.getWidth());e.setX(i),e.update(),null!=this.m_confirmBtn&&this.isOpen()&&(this.layoutItems(),this.layout())}}}setPromptTextColor(t){let e=this.m_promptLabel;null!=e&&e.setColor(t)}setListener(t,e){this.m_confirmFunc=t,this.m_cancelFunc=e}destroy(){super.destroy(),this.m_confirmFunc=null,this.m_cancelFunc=null,null!=this.m_confirmBtn&&(this.m_confirmBtn.destroy(),this.m_cancelBtn.destroy(),this.m_confirmBtn=null,this.m_cancelBtn=null)}buildPanel(t,e){this.buildItems()}buildItems(){if(null==this.m_confirmBtn){let t=this.getScene(),e=t.transparentTexAtlas,i=CoMaterial.createColor4,n=this.m_scene.uiConfig,r=n.getUIGlobalColor(),a=n.getUIPanelCfgByName("promptPanel"),o=a.btnKeys,h=a.btnTextFontFormat,u=a.textFontFormat,c=new s.TextLabel;c.depthTest=!0,c.transparent=!0,c.premultiplyAlpha=!0,c.initialize(this.m_prompt,t,u.fontSize);let m=i();m.fromBytesArray3(u.fontColor),c.setColor(m),this.m_promptLabel=c;CoRScene.MouseEvent;let _={text:this.m_confirmNS,textColor:i(),fontSize:h.fontSize,font:""};_.textColor.fromBytesArray3(h.fontColor);let d=[i(),i(),i(),i()];n.applyButtonColor(d,r.button.light);let p=l.ButtonBuilder,g=p.createTextButton(this.m_btnW,this.m_btnH,o[0],e,_,d);this.m_confirmBtn=g,_.text=this.m_cancelNS;let C=p.createTextButton(this.m_btnW,this.m_btnH,o[1],e,_,d);this.m_cancelBtn=C,this.addEntity(C),this.addEntity(g),this.addEntity(c)}}updateBgSize(){let t=this.m_panelW,e=this.m_promptLabel;e.update();let i=this.m_confirmBtn;i.update();let s=this.m_cancelBtn;s.update();let n=s.isVisible()?s.getWidth():0,l=i.getWidth()+n;n=l+Math.round(.2*l)+this.marginWidth;let r=e.getWidth()+this.marginWidth;r=n>r?n:r,t=this.m_panelW=r;let a=this.m_bgLabel;Math.abs(a.getWidth()-t)>.01&&(a.setScaleX(1),a.update(),r=a.getWidth(),a.setScaleX(t/r),a.update())}layoutItems(){this.m_cancelBtn.setVisible(this.m_cancelBtnVis),this.updateBgSize();let t=this.m_panelW,e=this.m_promptLabel,i=[this.m_btnH,e.getHeight()],s=this.m_alignCalc.calcAvgFixLayout(i,this.m_panelH,15,this.marginYFactor,.5),n=.5*(t-e.getWidth());e.setXY(n,s[1]),e.update(),this.m_cancelBtn.isVisible()?this.layoutButtons(n,s[0]):this.layoutOnlyConfirm(n,s[0])}layoutButtons(t,e){let i=[this.m_btnW,this.m_btnW],s=this.m_alignCalc.calcAvgFixLayout(i,this.m_panelW,10,this.marginXFactor,.5),n=this.m_confirmBtn,l=this.m_cancelBtn;n.setXY(s[0],e),n.update(),l.setXY(s[1],e),l.update()}layoutOnlyConfirm(t,e){let i=[this.m_btnW],s=this.m_alignCalc.calcAvgFixLayout(i,this.m_panelW,10,this.marginXFactor,.5),n=this.m_confirmBtn;n.setXY(s[0],e),n.update()}openThis(){let t=CoRScene.MouseEvent;null!=this.m_scene&&(this.m_scene.addEventListener(t.MOUSE_DOWN,this,this.stMouseDownListener),this.m_confirmBtn.addEventListener(t.MOUSE_UP,this,this.btnMouseUpListener),this.m_cancelBtn.addEventListener(t.MOUSE_UP,this,this.btnMouseUpListener),this.layoutItems())}closeThis(){this.m_cancelBtnVis=!0;let t=CoRScene.MouseEvent;null!=this.m_scene&&(this.m_scene.removeEventListener(t.MOUSE_DOWN,this,this.stMouseDownListener),this.m_confirmBtn.removeEventListener(t.MOUSE_UP,this,this.btnMouseUpListener),this.m_cancelBtn.removeEventListener(t.MOUSE_UP,this,this.btnMouseUpListener))}stMouseDownListener(t){let e=t.mouseX,i=t.mouseY,s=this.m_v0;s.setXYZ(e,i,0),this.globalToLocal(s),(s.x<0||s.x>this.m_panelW||s.y<0||s.y>this.m_panelH)&&this.close()}btnMouseUpListener(t){let e=t.uuid;switch(e){case"confirm":this.close(),null!=this.m_confirmFunc&&this.m_confirmFunc();break;case"cancel":this.close(),null!=this.m_cancelFunc&&this.m_cancelFunc();break;default:break}}}e.PromptPanel=a},"7dab":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("2b5a");e.CtrlInfo=s.CtrlInfo,e.ItemCallback=s.ItemCallback,e.CtrlItemParam=s.CtrlItemParam;class n{constructor(){this.type="",this.uuid="",this.btn=null,this.param=null,this.color=[1,1,1],this.colorId=-1,this.info=null,this.syncEnabled=!1}setValueToParam(t){let e=this.param;"progress"==e.type?e.progress=t:e.value=t}sendFlagOut(t,e=!1){let i=this.param;(null!=i.callback&&i.flag!=t||e)&&(i.flag=t,this.info={type:i.type,uuid:this.uuid,values:[],flag:t},i.callback(this.info))}sendColorOut(t,e=!1){let i=this.param,s=this.color;if(t.toArray3(s),null!=i.callback){let t="progress"==i.type?i.progress:i.value,e=s.slice();e[0]*=t,e[1]*=t,e[2]*=t,this.info={type:i.type,uuid:this.uuid,values:e,flag:!0,colorPick:!0},i.callback(this.info)}}sendValueOut(t,e=!1){let i=this.param,s="progress"==i.type,n=s?i.progress:i.value;if(null!=i.callback&&Math.abs(n-t)>1e-5||e){if(s?i.progress=t:i.value=t,i.colorPick){let e=this.color.slice();e[0]*=t,e[1]*=t,e[2]*=t,this.info={type:i.type,uuid:this.uuid,values:e,flag:!0,colorPick:!0}}else this.info={type:i.type,uuid:this.uuid,values:[t],flag:!0};i.callback(this.info)}}updateParamToUI(){let t=this.param,e=t;switch(e.colorPick=!!e.colorPick&&e.colorPick,t.type){case"number_value":case"number":e.value=e.value?e.value:0,e.minValue=e.minValue?e.minValue:0,e.maxValue=e.maxValue?e.maxValue:10;const t=this.btn;t.setRange(e.minValue,e.maxValue),t.setValue(e.value,!1),this.syncEnabled&&this.sendValueOut(e.value,!0);break;case"progress":e.progress=e.progress?e.progress:0;const i=this.btn;i.setProgress(e.progress,!1),this.syncEnabled&&this.sendValueOut(e.progress,!0);break;case"status":case"status_select":e.flag=!!e.flag&&e.flag;const s=this.btn;e.flag?s.select(!1):s.deselect(!1),this.syncEnabled&&this.sendFlagOut(e.flag,!0);break;default:break}}}e.CtrlItemObj=n},"7dc1":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("f35d"),n=i("05f0"),l=i("ddfa"),r=i("9ba1"),a=i("38b3"),o=i("88b9"),h=i("e8f9"),u=i("cdda"),c=i("7020"),m=i("8698"),_=i("9f6b"),d=i("9043"),p=i("7908"),g=i("7913"),C=i("d632"),f=i("f280"),b=i("0aa4"),y=i("b6c0"),E=i("0241"),M=i("d1de"),v=i("f042"),S=i("0efa"),x=i("9b53"),L=i("228b");let P=!0;function R(){P&&(P=!1,M.VoxRScene.isEnabled()&&(M.VoxRScene.initialize(),L.VoxMesh.isEnabled()&&L.VoxMesh.initialize(),v.VoxMath.isEnabled()&&v.VoxMath.initialize(),S.VoxMaterial.isEnabled()&&S.VoxMaterial.initialize(),x.VoxEntity.isEnabled()&&x.VoxEntity.initialize()))}function B(){return new r.ColorLabel}function T(){return new _.RectTextTip}function I(){return new s.ClipLabel}function V(){return new n.ClipColorLabel}function O(){return new l.ColorClipLabel}function w(){return new a.TextLabel}function D(){return new o.Button}function A(){return new h.FlagButton}function F(){return new c.SelectButtonGroup}function z(t,e,i,s,n,l){return u.ButtonBuilder.createTextButton(t,e,i,s,n,l)}function U(){return new C.UIPanel}function W(){return new g.PromptPanel}function k(){return new E.ParamCtrlPanel}e.initialize=R,e.createColorLabel=B,e.createRectTextTip=T,e.createClipLabel=I,e.createClipColorLabel=V,e.createColorClipLabel=O,e.createTextLabel=w,e.createButton=D,e.createFlagButton=A,e.createSelectButtonGroup=F,e.createTextButton=z,e.createUIPanel=U,e.createPromptPanel=W,e.createParamCtrlPanel=k;let X=null;function Y(t,e=null,i=512,s=3){R();let n=new m.VoxUIScene;if(X=n,null!=t&&n.initialize(t,i,s),n.uiConfig=e,null!=e){let t=new f.PromptSystem;t.initialize(n),n.prompt=t;let e=new b.TipsSystem;e.initialize(n),n.tips=e}let l=new y.PanelSystem;return l.initialize(n),n.panel=l,n}function G(){return new d.TipInfo}function j(){return new p.UILayout}function N(t,e,i=90,s=50,n=null,l=30,r=""){if(""==e||null==X)return null;let a=X,o=a.transparentTexAtlas;return u.ButtonBuilder.createTextLabelButton(o,t,e,i,s,n,l,r)}e.createUIScene=Y,e.createTipInfo=G,e.createUILayout=j,e.createTextLabelButton=N},"822b":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("f042"),n=i("d1de"),l=i("5ea3");class r extends l.CompEntityBase{constructor(){super(),this.m_dispatcher=null,this.m_currEvent=null,this.m_nameItem=null,this.m_addItem=null,this.m_subItem=null,this.m_bgBarItem=null,this.m_barPlane=null,this.m_ruisc=null,this.m_barInitLength=1,this.m_barLength=1,this.m_preProgress=-1,this.m_progress=0,this.m_nameWidth=0,this.m_value=0,this.m_enabled=!0,this.m_minValue=0,this.m_maxValue=1,this.step=.1,this.uuid="ProgressEntity",this.m_moveMin=0,this.m_autoDelay=0,this.m_changeStep=0}enable(){this.m_enabled=!0}disable(){this.m_enabled=!1}open(){this.setVisible(!0)}close(){this.setVisible(!1)}isOpen(){return this.isVisible()}isClosed(){return!this.isVisible()}addEventListener(t,e,i,s=!0,n=!1){this.m_dispatcher.addEventListener(t,e,i,s,n)}removeEventListener(t,e,i){this.m_dispatcher.removeEventListener(t,e,i)}destroy(){super.destroy(),null!=this.m_barPlane&&(this.m_dispatcher.destroy(),this.m_dispatcher=null,this.m_nameItem.destroy(),this.m_nameItem=null,this.m_subItem.destroy(),this.m_subItem=null,this.m_addItem.destroy(),this.m_addItem=null,this.m_bgBarItem.destroy(),this.m_bgBarItem=null,this.m_barPlane.destroy(),this.m_barPlane=null,this.m_ruisc=null)}getNameWidth(){return this.m_nameWidth}initialize(t,e="prog",i=30,s=30,l=200,r=40){if(this.isIniting()){this.init(),this.m_ruisc=t,this.m_barInitLength=l,this.m_dispatcher=n.VoxRScene.createEventBaseDispatcher(),this.m_currEvent=n.VoxRScene.createProgressDataEvent();let a=2,o=0;if(""!=e){let l=this.createBtn("name",t,[e],i,s,r);this.addEntity(l.button),this.m_nameWidth=s=l.button.getWidth(),r=l.button.getHeight(),this.m_nameItem=l,l.button.addEventListener(n.MouseEvent.MOUSE_DOWN,this,this.nameBtnMouseDown),o+=a+this.m_nameWidth}let h=this.createBtn("subProg",t,["-"],i,r,r),u=this.createBtn("addProg",t,["+"],i,r,r);h.button.setX(o),this.addEntity(h.button),o+=h.button.getWidth(),u.button.setX(this.m_barInitLength+o),this.addEntity(u.button),h.button.addEventListener(n.MouseEvent.MOUSE_DOWN,this,this.btnMouseDown),u.button.addEventListener(n.MouseEvent.MOUSE_DOWN,this,this.btnMouseDown),this.m_subItem=h,this.m_addItem=u,this.initProg(t,o,this.m_barInitLength,r),this.setProgressV(this.m_progress)}}initProg(t,e,i,s){let l=this.createBtn("progBarBg",t,[],0,i,s,.8);this.m_bgBarItem=l;let r=l.button;r.setX(e),this.addEntity(r);let a=l.bgLabel;a.getColorAt(2).copyFrom(a.getColorAt(1)),r.addEventListener(n.MouseEvent.MOUSE_DOWN,this,this.barMouseDown),this.m_ruisc.addEventListener(n.MouseEvent.MOUSE_UP,this,this.barMouseUp,!0,!1),r.addEventListener(n.MouseEvent.MOUSE_OVER,this,this.barMouseOver),r.addEventListener(n.MouseEvent.MOUSE_OUT,this,this.barMouseOut);let o=this.createBgLabel(1,s,1.2);o.setX(e),o.setZ(.05),this.addEntity(o),this.m_barPlane=o}setRange(t,e){this.m_preProgress=-1,this.m_minValue=t,this.m_maxValue=e}setValue(t,e=!0){this.m_preProgress=-1,t=s.MathConst.Clamp(t,this.m_minValue,this.m_maxValue),this.m_progress=(t-this.m_minValue)/(this.m_maxValue-this.m_minValue),this.setProgressV(this.m_progress,e)}getValue(){return this.m_value}setProgress(t,e=!0){this.m_preProgress=-1,this.setProgressV(t,e)}setProgressV(t,e=!0){this.m_progress=s.MathConst.Clamp(t,0,1),this.m_barLength=this.m_barInitLength*this.m_progress,this.sendValue(e)}sendValue(t){if(this.m_barPlane.setScaleX(this.m_barLength),this.m_barPlane.update(),this.m_value=this.m_minValue+(this.m_maxValue-this.m_minValue)*this.m_progress,t){let t=Math.abs(this.m_preProgress-this.m_progress);t>s.MathConst.MATH_MIN_POSITIVE&&(this.m_preProgress=this.m_progress,this.sendEvt(2))}}getProgress(){return this.m_progress}sendEvt(t){let e=this.m_currEvent;e.target=this,e.status=t,e.type=n.ProgressDataEvent.PROGRESS,e.minValue=this.m_minValue,e.maxValue=this.m_maxValue,e.value=this.m_value,e.progress=this.m_progress,e.phase=1,e.uuid=this.uuid,this.m_dispatcher.dispatchEvt(e),e.target=null}setProgressLength(t,e=!0){this.m_barLength=s.MathConst.Clamp(t,0,this.m_barInitLength),this.m_progress=this.m_barLength/this.m_barInitLength,this.sendValue(e)}nameBtnMouseDown(t){this.sendEvt(0)}barMouseDown(t){this.m_preProgress=-1,this.m_moveMin=t.mouseX-this.m_progress*this.m_barInitLength,this.setProgressV(this.m_progress),this.m_ruisc.addEventListener(n.MouseEvent.MOUSE_MOVE,this,this.barMouseMove,!0,!1)}barMouseMove(t){this.setProgressV((t.mouseX-this.m_moveMin)/this.m_barInitLength)}barMouseUp(t){this.m_ruisc.removeEventListener(n.MouseEvent.MOUSE_MOVE,this,this.barMouseMove),this.m_ruisc.removeEventListener(n.EventBase.ENTER_FRAME,this,this.barEnterFrame)}barEnterFrame(t){this.m_autoDelay>20&&this.m_autoDelay%7==0&&this.setProgressLength(this.m_barLength+this.m_changeStep),this.m_autoDelay++}barMouseOver(t){this.m_barPlane.setClipIndex(1)}barMouseOut(t){this.m_barPlane.setClipIndex(0)}btnMouseDown(t){this.m_autoDelay=0,"subProg"==t.uuid?(this.m_changeStep=-this.step,this.setProgressLength(this.m_barLength-this.step),this.m_ruisc.addEventListener(n.EventBase.ENTER_FRAME,this,this.barEnterFrame,!0,!1)):"addProg"==t.uuid&&(this.m_changeStep=this.step,this.setProgressLength(this.m_barLength+this.step),this.m_ruisc.addEventListener(n.EventBase.ENTER_FRAME,this,this.barEnterFrame,!0,!1))}}e.ProgressEntity=r},8698:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("7908");class n{constructor(){this.m_graph=null,this.texAtlas=null,this.transparentTexAtlas=null,this.layout=new s.UILayout,this.prompt=null,this.tips=null,this.panel=null,this.uiConfig=null,this.keyboardInteraction=null,this.texAtlasNearestFilter=!0}resizeHandle(t){this.resize()}initialize(t,e=1024,i=3){if(null==this.m_graph){this.m_graph=t;let s=t.getSceneAt(0),n=s.getStage3D();s.addEventListener(CoRScene.EventBase.RESIZE,this,this.resizeHandle);let l=t.createRendererSceneParam();l.cameraPerspectiveEnabled=!1,l.setAttriAlpha(!1),l.setCamProject(45,.1,3e3),l.setCamPosition(0,0,1500);let r=t.createSubScene(l,i,!0);r.enableMouseEvent(!0);let a=this;a.rscene=r;let o=a.texAtlas=CoTexture.createCanvasTexAtlas(),h=a.transparentTexAtlas=CoTexture.createCanvasTexAtlas();o.initialize(s,e,e,CoMaterial.createColor4(1,1,1,1),!1,this.texAtlasNearestFilter),o.getTexture().premultiplyAlpha=!1,h.initialize(s,e,e,CoMaterial.createColor4(1,1,1,0),!0,this.texAtlasNearestFilter),h.getTexture().premultiplyAlpha=!0,this.m_rstage=n;let u=this.rscene.getCamera();u.translationXYZ(n.stageHalfWidth,n.stageHalfHeight,1500),u.update();let c=this.getStage();this.m_stageRect=CoMath.createAABB2D(0,0,c.stageWidth,c.stageHeight),this.layout.initialize(this.m_stageRect)}}addEventListener(t,e,i,s=!0,n=!1){return this.m_rstage.addEventListener(t,e,i,s,n),this}removeEventListener(t,e,i){return this.m_rstage.removeEventListener(t,e,i),this}getStage(){return this.rscene.getStage3D()}addEntity(t,e=0){if(null!=t){t.__$setScene(this),t.update();let i=t.getRContainer();null!=i&&this.rscene.addContainer(i,e);let s=t.getREntities();for(let t=0;t<s.length;++t)this.rscene.addEntity(s[t],e,!0)}}removeEntity(t){if(null!=t){let e=this.rscene,i=t.getRContainer();null!=i&&e.removeContainer(i);let s=t.getREntities();for(let t=0;t<s.length;++t)e.removeEntity(s[t]);t.__$setScene(null)}}getRect(){return this.m_stageRect}resize(){let t=this.m_rstage,e=this.rscene.getCamera();e.translationXYZ(t.stageHalfWidth,t.stageHalfHeight,1500),e.update(),this.m_stageRect.setTo(0,0,t.stageWidth,t.stageHeight),this.updateLayout()}updateLayout(){this.layout.update(this.m_stageRect)}run(){const t=this.rscene;null!=t&&t.run()}}e.VoxUIScene=n},8875:function(t,e,i){var s,n,l;(function(i,r){n=[],s=r,l="function"===typeof s?s.apply(e,n):s,void 0===l||(t.exports=l)})("undefined"!==typeof self&&self,(function(){function t(){var e=Object.getOwnPropertyDescriptor(document,"currentScript");if(!e&&"currentScript"in document&&document.currentScript)return document.currentScript;if(e&&e.get!==t&&document.currentScript)return document.currentScript;try{throw new Error}catch(_){var i,s,n,l=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,r=/@([^@]*):(\d+):(\d+)\s*$/gi,a=l.exec(_.stack)||r.exec(_.stack),o=a&&a[1]||!1,h=a&&a[2]||!1,u=document.location.href.replace(document.location.hash,""),c=document.getElementsByTagName("script");o===u&&(i=document.documentElement.outerHTML,s=new RegExp("(?:[^\\n]+?\\n){0,"+(h-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),n=i.replace(s,"$1").trim());for(var m=0;m<c.length;m++){if("interactive"===c[m].readyState)return c[m];if(c[m].src===o)return c[m];if(o===u&&c[m].innerHTML&&c[m].innerHTML.trim()===n)return c[m]}return null}}return t}))},"88b9":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("f35d"),n=i("0b77");class l extends n.UIEntityBase{constructor(){super(),this.m_enabled=!0,this.m_lb=null,this.m_lbs=[],this.uuid="btn",this.syncLabelClip=!0}addLabel(t){this.m_lbs.push(t)}enable(){return null!=this.m_dp&&(this.m_dp.enabled=!0),this.m_enabled=!0,this}disable(){return null!=this.m_dp&&(this.m_dp.enabled=!1),this.m_enabled=!1,this}isEnabled(){return this.m_enabled}setMouseEnabled(t){null!=this.m_entities&&(this.m_entities[0].mouseEnabled=t)}isMouseEnabled(){return null!=this.m_entities&&this.m_entities[0].mouseEnabled}initialize(t,e=null){if(this.isIniting()&&null!=t&&null!=e){if(this.init(),4!=e.length)throw Error("Error: idnsList.length != 4");let i=new s.ClipLabel;i.initialize(t,e),this.m_lb=i,this.initializeEvent(),this.m_lb.setClipIndex(0)}return this}initializeWithLable(t){if(this.isIniting()){if(this.init(),t.getClipsTotal()<1)throw Error("Error: lable.getClipsTotal() < 1");this.m_lb=t,this.initializeEvent(),this.m_lb.setClipIndex(0)}return this}getLable(){return this.m_lb}initializeEvent(){if(null==this.m_dp){const t=CoRScene.MouseEvent;let e=CoRScene.createMouseEvt3DDispatcher();e.currentTarget=this,e.uuid=this.uuid,e.enabled=this.m_enabled,e.addEventListener(t.MOUSE_DOWN,this,this.mouseDownListener),e.addEventListener(t.MOUSE_UP,this,this.mouseUpListener),e.addEventListener(t.MOUSE_OVER,this,this.mouseOverListener),e.addEventListener(t.MOUSE_OUT,this,this.mouseOutListener),this.m_lb.getREntities()[0].setEvtDispatcher(e),this.m_dp=e}this.m_entities=this.m_lb.getREntities().slice(0),this.m_entities[0].mouseEnabled=!0}setVisible(t){super.setVisible(t);let e=this.m_lbs;for(let i=0;i<e.length;++i)e[i].setVisible(t)}addEventListener(t,e,i,s=!0,n=!1){return this.m_dp.addEventListener(t,e,i,s,n),this}removeEventListener(t,e,i){return this.m_dp.removeEventListener(t,e,i),this}setLabelsClipAt(t){if(this.syncLabelClip){let e=this.m_lbs;if(e.length>0)for(let i=0;i<e.length;++i)e[i].setClipIndex(t)}}mouseOverListener(t){this.m_enabled&&(this.m_lb.setClipIndex(1),this.setLabelsClipAt(1))}mouseOutListener(t){this.m_enabled&&(this.m_lb.setClipIndex(0),this.setLabelsClipAt(0))}mouseDownListener(t){this.m_enabled&&(this.m_lb.setClipIndex(2),this.setLabelsClipAt(2))}mouseUpListener(t){this.m_enabled&&(this.m_lb.setClipIndex(3),this.setLabelsClipAt(3))}setClipIndex(t){return this.m_lb.setClipIndex(t),this}copyTransformFrom(t){if(null!=t){let e=t.getScaleX(),i=t.getScaleY(),s=t.getRotation();this.setScaleXY(e,i),this.setRotation(s),t.getPosition(this.m_v0),this.setPosition(this.m_v0)}}getREntities(){let t=this.m_lb.getREntities(),e=this.m_lbs;if(e.length>0){for(let i=0;i<e.length;++i)t=t.concat(e[i].getREntities());return t}return t}getRContainer(){return null}update(){this.m_bounds.reset();let t=this.m_scaleV,e=this.m_lb;e.setRotation(this.m_rotation),e.setScaleXY(t.x,t.y),e.setPosition(this.m_pos),e.update(),this.m_bounds.union(e.getGlobalBounds());let i=this.m_lbs;if(i.length>0)for(let s=0;s<i.length;++s)i[s].copyTransformFrom(this.m_lb),i[s].update(),this.m_bounds.union(i[s].getGlobalBounds());this.m_bounds.updateFast()}destroy(){let t=this.m_lb;null!=t&&(t.destroy(),t=null);let e=this.m_lbs;if(e.length>0){for(let t=0;t<e.length;++t)e[t].destroy();this.m_lbs=[]}null!=this.m_dp&&(this.m_dp.destroy(),this.m_dp=null),super.destroy()}}e.Button=l},9043:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.m_pv=null}getPos(t,e,i,s,n){null==this.m_pv&&(this.m_pv=CoMath.createVec3());let l=this.m_pv,r=s.getHeight(),a=s.getWidth(),o=i.min;return l.x=o.x-2-a,l.y=e+2-r,l.y+r>n.getTop()&&(l.y=n.getTop()-2-r),l}}class n{constructor(){this.m_pv=null}getPos(t,e,i,s,n){null==this.m_pv&&(this.m_pv=CoMath.createVec3());let l=this.m_pv,r=s.getHeight(),a=i.max;return l.x=a.x+2,l.y=e+2-r,l.y+r>n.getTop()&&(l.y=n.getTop()-2-r),l}}class l{constructor(){this.m_pv=null}getPos(t,e,i,s,n){null==this.m_pv&&(this.m_pv=CoMath.createVec3());let l=this.m_pv,r=i.max,a=s.getWidth();return l.x=t+2,l.y=r.y+2,l.x+a>n.getRight()&&(l.x=n.getRight()-2-a),l}}class r{constructor(){this.m_pv=null}getPos(t,e,i,s,n){null==this.m_pv&&(this.m_pv=CoMath.createVec3());let l=this.m_pv,r=s.getHeight(),a=s.getWidth(),o=i.min;return l.x=t+2,l.y=o.y-2-r,l.x+a>n.getRight()&&(l.x=n.getRight()-2-a),l}}const a=new s,o=new n,h=new l,u=new r;class c{constructor(){this.m_content="ui entity tip info",this.m_aligner=null}setContent(t){return this.m_content=t,this}getCotent(){return this.m_content}alignLeft(){return this.m_aligner=a,this}alignRight(){return this.m_aligner=o,this}alignTop(){return this.m_aligner=h,this}alignBottom(){return this.m_aligner=u,this}getPos(t,e,i,n,l=null){return null==this.m_aligner&&(this.m_aligner=new s),this.m_aligner.getPos(t,e,i,n,l)}destroy(){this.m_aligner=null}}e.TipInfo=c},9686:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("5470");class n extends s.LayouterBase{constructor(){super(),this.m_offsetvs=[]}update(t){const e=this.m_entities,i=e.length;let s=CoMath.createVec3();for(let n=0;n<i;++n)s.copyFrom(this.m_offsetvs[n]),s.x=t.width-s.x,s.addBy(this.m_offsetV),e[n].setPosition(s),e[n].update()}initEntityLayout(t,e){t.update();let i=CoMath.createVec3();t.getPosition(i),i.x=e.width-i.x,this.m_offsetvs.push(i)}destroy(){this.m_offsetvs=null,super.destroy()}}e.RightBottomLayouter=n},"9b53":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("75f5");class n{constructor(){this.m_init=!0}initialize(t=null,e=""){return this.m_init=!this.isEnabled(),!!this.m_init&&(this.m_init=!1,""!=e&&void 0!==e||(e="static/cospace/coentity/CoEntity.umd.min.js"),new s.ModuleLoader(1,()=>{null!=t&&this.isEnabled()&&t([e])}).load(e),!0)}isEnabled(){return"undefined"!==typeof CoEntity&&"undefined"!==typeof CoRScene}createDataMeshFromModel(t,e,i){return CoEntity.createDataMeshFromModel(t,e,i)}createDisplayEntityFromModel(t,e,i){return CoEntity.createDisplayEntityFromModel(t,e,i)}createFreeAxis3DEntity(t,e){return CoEntity.createFreeAxis3DEntity(t,e)}createAxis3DEntity(t){return CoEntity.createAxis3DEntity(t)}createDisplayEntityWithDataMesh(t,e,i){return CoEntity.createDisplayEntityWithDataMesh(t,e,i)}createDisplayEntity(){return CoEntity.createDisplayEntity()}createMouseEventEntity(){return CoEntity.createMouseEventEntity()}createBoundsEntity(){return CoEntity.createBoundsEntity()}createCrossAxis3DEntity(t){return CoEntity.createCrossAxis3DEntity(t)}createDisplayEntityContainer(){return CoEntity.createDisplayEntityContainer()}createFixScreenPlane(t=-1,e=-1,i=2,s=2,n=null,l=!1){return CoEntity.createFixScreenPlane(t,e,i,s,n,l)}createXOYPlane(t,e,i,s,n=null,l=!1){return CoEntity.createXOYPlane(t,e,i,s,n,l)}createXOZPlane(t,e,i,s,n=null,l=!1){return CoEntity.createXOZPlane(t,e,i,s,n,l)}createYOZPlane(t,e,i,s,n=null,l=!1){return CoEntity.createYOZPlane(t,e,i,s,n,l)}createCube(t,e=null,i=!1){return CoEntity.createCube(t,e,i)}createBox(t,e,i=null,s=!1){return CoEntity.createBox(t,e,i,s)}createSphere(t,e=20,i=20,s=null,n=!1,l=!1){return CoEntity.createSphere(t,e,i,s,n,l)}createCone(t,e,i=20,s=null,n=!1,l=-.5){return CoEntity.createCone(t,e,i,s,n,l)}createCylinder(t,e,i=20,s=null,n=!1,l=-.5){return CoEntity.createCylinder(t,e,i,s,n,l)}createTube(t,e,i=20,s=1,n=0,l=null,r=!1,a=1,o=-.5){return CoEntity.createTube(t,e,i,s,n,l,r,a,o)}createTorus(t,e,i=20,s=1,n=0,l=null,r=!1,a=1,o=-.5){return CoEntity.createTorus(t,e,i,s,n,l,r,a,o)}}const l=new n;e.VoxEntity=l},"9ba1":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("0b77"),n=i("9b53"),l=i("228b"),r=i("0efa");class a extends s.UIEntityBase{constructor(){super(),this.m_color=null,this.m_material=null}createMesh(t){let e=new Uint16Array([0,1,2,0,2,3]),i=new Float32Array(this.createVS(0,0,this.m_width,this.m_height)),s=l.VoxMesh.createRawMesh();return s.reset(),s.setBufSortFormat(t.getBufSortFormat()),s.setIVS(e),s.addFloat32Data(i,3),s.initialize(),s}initialize(t,e){if(this.isIniting()){this.init(),this.m_width=t,this.m_height=e;let i=r.VoxMaterial.createDefaultMaterial();i.initializeByCodeBuf(!1),this.m_color=r.VoxMaterial.createColor4();let s=this.createMesh(i),l=n.VoxEntity.createDisplayEntity();l.setMaterial(i),l.setMesh(s),this.applyRST(l),this.m_entities.push(l),this.m_material=i}}setColor(t){return this.m_color.copyFrom(t),null!=this.m_material&&this.m_material.setColor(t),t}getColor(){return this.m_color}destroy(){super.destroy(),this.m_material=null}}e.ColorLabel=a},"9d95":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("0b77");class n extends s.UIEntityBase{constructor(){super(),this.m_pw=10,this.m_ph=10,this.m_sx=1,this.m_sy=1,this.m_material=null,this.m_tex=null}initialize(t,e,i=128,s=128){if(null!=e&&this.isIniting()){this.init(),this.m_tex=e,this.m_uiScene=t,this.m_color=CoMaterial.createColor4(),this.m_tex.flipY=!0,this.m_tex.premultiplyAlpha=!0,this.m_tex.minFilter=CoRScene.TextureConst.LINEAR,this.m_tex.magFilter=CoRScene.TextureConst.NEAREST;let n=this.createMaterial(this.m_tex);this.m_material=n,CoMesh.plane.applyMaterial(n,!0);let l=CoMesh.plane.createXOY(0,0,1,1);this.m_pw=i,this.m_ph=s;let r=CoEntity.createDisplayEntity();r.setMaterial(n),r.setMesh(l),this.m_entities.push(r),this.applyRST(r),super.setScaleXY(this.m_sx*this.m_pw,this.m_sy*this.m_ph),this.update()}}setScaleXY(t,e){this.m_sx=t,this.m_sy=e,super.setScaleXY(t*this.m_pw,e*this.m_ph)}setScaleX(t){this.m_sx=t,super.setScaleX(t*this.m_pw)}setScaleY(t){this.m_sy=t,super.setScaleX(t*this.m_ph)}getScaleX(){return this.m_sx}getScaleY(){return this.m_sy}setColor(t){return this.m_color.copyFrom(t),null!=this.m_material&&this.m_material.setColor(t),this}getColor(){return this.m_color}destroy(){super.destroy(),this.m_material=null,this.m_uiScene=null,this.m_tex=null}}e.TextureLabel=n},"9f6b":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("0b77");class n extends s.UIEntityBase{constructor(){super(),this.m_pw=10,this.m_ph=10,this.m_rpi=0,this.m_texAtlas=null,this.m_tex=null,this.m_fontSize=24,this.m_text="tipsInfo",this.premultiplyAlpha=!0}initialize(t,e=0,i=24,s=null,n=null){if(this.isIniting()){e<0&&(e=0),i<12&&(i=12),this.m_texAtlas=t.texAtlas,this.init(),this.m_uiScene=t,this.m_rpi=e;let l=CoEntity.createDisplayEntity(),r=t.uiConfig,a=r.getUIGlobalText().fontFormat.tips;this.m_fontSize=a.fontSize,this.m_fontColor=null==s?r.createColorByData(a.fontColor):s,this.m_bgColor=null==n?CoMaterial.createColor4(.1,.1,.1,.5):n;let o=this.m_texAtlas.createCharsImage(this.m_text,this.m_fontSize,this.m_fontColor,this.m_bgColor);this.m_tex=t.rscene.textureBlock.createImageTex2D(o.width,o.height),this.m_tex.setDataFromImage(o),this.m_tex.flipY=!0,this.m_tex.premultiplyAlpha=!0,this.m_tex.minFilter=CoRScene.TextureConst.LINEAR,this.m_tex.magFilter=CoRScene.TextureConst.NEAREST;let h=this.createMaterial(this.m_tex);CoMesh.plane.setBufSortFormat(h.getBufSortFormat());let u=CoMesh.plane.createXOY(0,0,1,1);this.m_pw=o.width,this.m_ph=o.height,l.setMaterial(h),l.setMesh(u),this.m_entities.push(l),this.applyRST(l),this.setScaleXY(o.width,o.height)}}addEntity(t){if(null!=t){const e=CoRScene.MouseEvent;t.addEventListener(e.MOUSE_OUT,this,this.targetMouseOut),t.addEventListener(e.MOUSE_OVER,this,this.targetMouseOver),t.addEventListener(e.MOUSE_MOVE,this,this.targetMouseMove)}}removeEntity(t){if(null!=t){const e=CoRScene.MouseEvent;t.removeEventListener(e.MOUSE_OUT,this,this.targetMouseOut),t.removeEventListener(e.MOUSE_OVER,this,this.targetMouseOver),t.removeEventListener(e.MOUSE_MOVE,this,this.targetMouseMove)}}moveTar(t,e,i){let s=t.getGlobalBounds(),n=t.info,l=n.getPos(e,i,s,this.getGlobalBounds(),this.m_uiScene.getRect());this.setXY(l.x,l.y),this.update()}targetMouseOver(t){null==this.getScene()&&this.m_uiScene.addEntity(this,this.m_rpi),this.setVisible(!0);let e=t.currentTarget;this.setText(e.info.getCotent()),this.moveTar(e,t.mouseX,t.mouseY)}targetMouseMove(t){let e=t.currentTarget;this.moveTar(e,t.mouseX,t.mouseY)}targetMouseOut(t){this.setVisible(!1)}setText(t){if(null!=this.m_tex&&""!=t&&this.m_text!=t){this.m_text=t;let e=this.m_texAtlas.createCharsImage(t,this.m_fontSize,this.m_fontColor,this.m_bgColor);this.m_tex.setDataFromImage(e,0,0,0,!0),this.m_tex.updateDataToGpu(),this.m_pw=e.width,this.m_ph=e.height,this.setScaleXY(e.width,e.height)}}getText(){return this.m_text}destroy(){super.destroy(),this.m_uiScene=null,null!=this.m_tex&&(this.m_tex=null),this.m_texAtlas=null}}e.RectTextTip=n},b6c0:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("d1ef");class n{constructor(){this.m_colorPickPanel=new s.ColorPickPanel,this.m_curPanel=null}initialize(t,e=1){null==this.m_uiscene&&(this.m_uiscene=t,this.m_colorPickPanel.setBGColor(CoMaterial.createColor4(.4,.4,.4)),this.m_colorPickPanel.initialize(t,e,260,260,3))}getPanelByName(t){switch(t){case"colorPickPanel":return this.m_colorPickPanel;default:return null}}setXY(t,e,i,s=0){let n=this.getPanelByName(t);null!=n&&n.setXY(e,i)}openPanel(t,e=0){let i=this.getPanelByName(t);null!=i&&i.open()}closePanel(t,e=0){let i=this.getPanelByName(t);null!=i&&i.close()}getPanel(t,e=0){return this.getPanelByName(t)}}e.PanelSystem=n},c21f:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("0b77");class n extends s.UIEntityBase{constructor(){super(),this.m_index=0,this.m_total=0,this.m_step=6,this.m_vtCount=0,this.m_sizes=null,this.uuid="label"}createVS(t,e,i,s){let n=t,l=e,r=t+i,a=e+s,o=0;return[n,l,o,r,l,o,r,a,o,n,a,o]}setClipIndex(t){}setCircleClipIndex(t){t%=this.m_total,t+=this.m_total,t%=this.m_total,this.setClipIndex(t)}getClipIndex(){return this.m_index}getClipsTotal(){return this.m_total}getClipWidthAt(t){return null==this.m_sizes?this.m_width:t>=0&&t<this.m_total?(t<<=1,this.m_sizes[t]):void 0}getClipHeightAt(t){return null==this.m_sizes?this.m_height:t>=0&&t<this.m_total?(t<<=1,this.m_sizes[t+1]):void 0}getClipWidth(){return this.m_width}getClipHeight(){return this.m_height}destroy(){this.m_sizes=null,this.m_total=0,super.destroy()}}e.ClipLabelBase=n},cdda:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("f35d"),n=i("05f0"),l=i("88b9"),r=i("0efa");class a{static createCurrTextBtn(t,e,i,r,a,o=null){if(null!==a.text&&""!=a.text){let h=new n.ClipColorLabel;h.initializeWithoutTex(t,e,4),h.setColors(o);let u=new s.ClipLabel;u.depthTest=!0,u.transparent=!0,u.premultiplyAlpha=!0,u.initialize(r,[a.text]),u.setColor(a.textColor);let c=new l.Button;return c.uuid=i,c.addLabel(u),c.initializeWithLable(h),c}return null}static createTextLabelButton(t,e,i,a=90,o=50,h=null,u=30,c=""){if(""==i||null==t)return null;let m=t,_=null!=h?h:r.VoxMaterial.createColor4(0,0,0,1),d=r.VoxMaterial.createColor4(1,1,1,0);""!=c&&m.setFontName(c);let p=m.createCharsCanvasFixSize(a,o,i,u,_,d);m.addImageToAtlas(i,p);let g=new n.ClipColorLabel;g.initializeWithoutTex(a,o,4),g.getColorAt(0).setRGB3f(.5,.5,.5),g.getColorAt(1).setRGB3f(.7,.7,.7),g.getColorAt(2).setRGB3f(.6,.6,.6),g.getColorAt(3).copyFrom(g.getColorAt(1));let C=new s.ClipLabel;C.transparent=!0,C.premultiplyAlpha=!0,C.initialize(m,[i]);let f=new l.Button;return f.uuid=e,f.addLabel(C),f.initializeWithLable(g),f}static createTextButton(t,e,i,s,n,l){let o=n,h=s.createCharsCanvasFixSize(t,e,o.text,o.fontSize,r.VoxMaterial.createColor4(),r.VoxMaterial.createColor4(1,1,1,0));return s.addImageToAtlas(o.text,h),a.createCurrTextBtn(t,e,i,s,n,l)}static createPanelBtnWithCfg(t,e,i,s,n){let l=t.transparentTexAtlas,a=t.uiConfig,o=n.btnSize,h=o[0],u=o[1],c=n.btnNames,m=n.btnKeys,_=n.btnTips,d=n.btnTextFontFormat;l.setFontName(d.font);let p=r.VoxMaterial.createColor4();p.fromBytesArray3(a.getUIGlobalColor().text);let g=r.VoxMaterial.createColor4(1,1,1,0),C=l.createCharsCanvasFixSize(h,u,c[s],d.fontSize,p,g);l.addImageToAtlas(c[s],C);let f=Lib_VoxUI.createClipColorLabel();f.initializeWithoutTex(h,u,4);let b=Lib_VoxUI.createClipLabel();b.transparent=!0,b.premultiplyAlpha=!0,b.initialize(l,[c[s]]);let y=Lib_VoxUI.createButton();y.uuid=m[s],y.addLabel(b),y.initializeWithLable(f);let E="right",M=n.buttonStyle;if(void 0!=M&&void 0!=M.globalColor&&(E=M.tipsAlign,a.applyButtonGlobalColor(y,M.globalColor)),_.length>s){t.tips.addTipsTarget(y);let e=Lib_VoxUI.createTipInfo().setContent(_[s]);switch(E){case"top":y.info=e.alignTop();break;case"bottom":y.info=e.alignBottom();break;default:y.info=e.alignRight();break}}return y.setXY(e,i),y}}e.ButtonBuilder=a},d1de:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("75f5"),n=i("dab7");var l=null;e.RendererDevice=l;var r=null;e.SelectionEvent=r;var a=null;e.ProgressDataEvent=a;var o=null;e.MouseEvent=o;var h=null;e.EventBase=h;var u=null;e.RendererState=u;class c{constructor(){this.m_init=!0}init(){"undefined"!==typeof CoRScene&&(e.RendererDevice=l=CoRScene.RendererDevice,e.SelectionEvent=r=CoRScene.SelectionEvent,e.ProgressDataEvent=a=CoRScene.ProgressDataEvent,e.EventBase=h=CoRScene.EventBase,e.MouseEvent=o=CoRScene.MouseEvent,e.RendererState=u=CoRScene.RendererState)}initialize(t=null,e=""){if(this.m_init=!this.isEnabled(),this.m_init||(n.VoxRenderer.initialize(),this.init()),this.m_init){this.m_init=!1;let i=!1,l=0,r="";return i=n.VoxRenderer.initialize(i=>{r=i[0],l++,l>1&&null!=t&&this.isEnabled()&&t([r,e])}),""!=e&&void 0!==e||(e="static/cospace/engine/rscene/CoRScene.umd.min.js"),new s.ModuleLoader(1,()=>{n.VoxRenderer.initialize(),this.init(),i?(l++,l>1&&null!=t&&this.isEnabled()&&t([r,e])):null!=t&&"undefined"!==typeof CoRScene&&t([e])}).load(e),!0}return!1}get RendererDevice(){return CoRScene.RendererDevice}get RendererState(){return CoRScene.RendererState}get RenderDrawMode(){return CoRScene.RenderDrawMode}get VtxBufConst(){return CoRScene.VtxBufConst}get TextureConst(){return CoRScene.TextureConst}get Vector3D(){return CoRScene.Vector3D}get MouseEvent(){return CoRScene.MouseEvent}get EventBase(){return CoRScene.EventBase}get SelectionEvent(){return CoRScene.SelectionEvent}get ProgressDataEvent(){return CoRScene.ProgressDataEvent}get KeyboardEvent(){return CoRScene.KeyboardEvent}get Keyboard(){return CoRScene.Keyboard}get ShaderCodeUUID(){return CoRScene.ShaderCodeUUID}get MaterialContextParam(){return CoRScene.MaterialContextParam}get MaterialPipeType(){return CoRScene.MaterialPipeType}createSelectionEvent(){return CoRScene.createSelectionEvent()}createProgressDataEvent(){return CoRScene.createProgressDataEvent()}createVec3(t,e,i,s){return CoRScene.createVec3(t,e,i,s)}createMat4(t,e){return CoRScene.createMat4(t,e)}createColor4(t,e,i,s){return CoRScene.createColor4(t,e,i,s)}createAABB(){return CoRScene.createAABB()}applySceneBlock(t){return CoRScene.applySceneBlock(t)}createRendererSceneParam(t){return CoRScene.createRendererSceneParam(t)}createRendererScene(t,e,i){return CoRScene.createRendererScene(t,e,i)}setRendererScene(t){return CoRScene.setRendererScene(t)}getRendererScene(){return CoRScene.getRendererScene()}createMouseEvt3DDispatcher(){return CoRScene.createMouseEvt3DDispatcher()}createEventBaseDispatcher(){return CoRScene.createEventBaseDispatcher()}createVtxDrawingInfo(){return CoRScene.createVtxDrawingInfo()}createDefaultMaterial(t){return CoRScene.createDefaultMaterial()}createLineMaterial(t){return CoRScene.createLineMaterial(t)}createQuadLineMaterial(t){return CoRScene.createQuadLineMaterial(t)}createShaderMaterial(t){return CoRScene.createShaderMaterial(t)}createMaterial(t){return CoRScene.createMaterial(t)}createDataMesh(){return CoRScene.createDataMesh()}createRawMesh(){return CoRScene.createRawMesh()}createBoundsMesh(){return CoRScene.createBoundsMesh()}createDataMeshFromModel(t,e,i){return CoRScene.createDataMeshFromModel(t,e,i)}createDisplayEntityFromModel(t,e,i){return CoRScene.createDisplayEntityFromModel(t,e,i)}createFreeAxis3DEntity(t,e,i){return CoRScene.createFreeAxis3DEntity(t,e,i)}createAxis3DEntity(t,e){return CoRScene.createAxis3DEntity(t,e)}createCrossAxis3DEntity(t,e){return CoRScene.createCrossAxis3DEntity(t,e)}createDisplayEntityWithDataMesh(t,e,i){return CoRScene.createDisplayEntityWithDataMesh(t,e,i)}createDisplayEntity(t){return CoRScene.createDisplayEntity(t)}createMouseEventEntity(t){return CoRScene.createMouseEventEntity(t)}createBoundsEntity(t){return CoRScene.createBoundsEntity(t)}createDisplayEntityContainer(){return CoRScene.createDisplayEntityContainer()}creatMaterialContextParam(){return CoRScene.creatMaterialContextParam()}createMaterialContext(){return CoRScene.createMaterialContext()}VerticalCCWOnXOY(t){return CoRScene.VerticalCCWOnXOY(t)}VerticalCWOnXOY(t){return CoRScene.VerticalCWOnXOY(t)}createRendererSceneGraph(){return CoRScene.createRendererSceneGraph()}createEvtNode(){return CoRScene.createEvtNode()}isEnabled(){return n.VoxRenderer.isEnabled()&&"undefined"!==typeof CoRScene}}const m=new c;e.VoxRScene=m},d1ef:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("d632"),n=i("9d95"),l=i("9ba1"),r=i("d1de"),a=i("0efa");class o extends s.UIPanel{constructor(){super(),this.m_marginWidth=15,this.m_colorLabel=null,this.m_callback=null,this.m_initing=!0,this.m_pixelsW=256,this.m_pixelsH=256,this.m_prePickX=-1,this.m_prePickY=-1,this.m_autoDelay=0}initialize(t,e,i=260,s=260,n=3){this.isIniting()&&(this.init(),this.m_marginWidth=n,this.m_scene=t,this.m_rpi=e,this.m_panelW=i,this.m_panelH=s)}destroy(){super.destroy()}setColor(t){this.isOpen()&&null!=t&&(null==this.m_colorLabel&&(this.m_colorLabel=new l.ColorLabel,this.m_colorLabel.initialize(32,32),this.m_colorLabel.setXY(2,this.m_panelH),this.addEntity(this.m_colorLabel)),this.m_colorLabel.setColor(t),this.m_colorLabel.setVisible(!0))}setPickXY(t,e){this.m_prePickX=t,this.m_prePickY=e}setSelectColorCallback(t){this.m_callback=t}buildPanel(t,e){this.buildItems()}buildItems(){if(this.m_initing){this.m_initing=!1;let t=this.getScene(),e="static/assets/colors.png",i=this.m_marginWidth,s=this.m_panelW-2*i,l=this.m_panelH-2*i,r=this.createTexByUrl(e),a=new n.TextureLabel;a.initialize(t,r,s,l),a.setXY(i,i),this.addEntity(a)}}getRGBAByXY(t,e){t|=0,e|=0,t<0&&(t=0),e<0&&(e=0),t>255&&(t=255),e>255&&(e=255),e=255-e,null==this.m_color&&(this.m_color=a.VoxMaterial.createColor4());let i=this.m_pixels;if(null!=this.m_pixels){let s=4*(e*this.m_pixelsW+t),n=i[s],l=i[s+1],r=i[s+2];this.m_color.setRGB3Bytes(n,l,r)}return this.m_color}createColorData(t){let e=document.createElement("canvas");e.style.display="bolck",e.style.overflow="hidden",e.style.left="0px",e.style.top="0px",e.style.position="absolute",e.width=t.width,e.height=t.height;let i=e.getContext("2d");i.drawImage(t,0,0);let s=i.getImageData(0,0,t.width,t.height);this.m_pixels=s.data}createTexByUrl(t=""){let e=this.getScene(),i=e.rscene.textureBlock.createImageTex2D(64,64,!1),s=new Image;return s.onload=t=>{this.createColorData(s),i.setDataFromImage(s,0,0,0,!1)},s.src=t,i}openThis(){null!=this.m_scene&&this.m_scene.addEventListener(r.MouseEvent.MOUSE_DOWN,this,this.stMouseDownListener)}closeThis(){null!=this.m_scene&&this.m_scene.removeEventListener(r.MouseEvent.MOUSE_DOWN,this,this.stMouseDownListener),this.m_callback=null,null!=this.m_colorLabel&&this.m_colorLabel.setVisible(!1),this.stMouseUp(null)}pickColorByXY(t,e){if((this.m_prePickX!=t||this.m_prePickY!=e)&&(this.m_prePickX=t,this.m_prePickY=e,t>=0||t<=this.m_panelW||e>=0||e<=this.m_panelH)){let i=this.m_marginWidth;t-=i,e-=i;let s=this.getRGBAByXY(t,e);null!=this.m_callback&&(this.setColor(s),this.m_callback(s,t,e))}}stMouseDownListener(t){let e=t.mouseX,i=t.mouseY,s=this.m_v0;s.setXYZ(e,i,0),this.globalToLocal(s),s.x<0||s.x>this.m_panelW||s.y<0||s.y>this.m_panelH?this.close():(this.pickColorByXY(s.x,s.y),this.m_scene.addEventListener(r.EventBase.ENTER_FRAME,this,this.enterFrame,!0,!1),this.m_scene.addEventListener(r.MouseEvent.MOUSE_UP,this,this.stMouseUp,!0,!1))}enterFrame(t){if(this.m_autoDelay>20&&this.m_autoDelay%7==0){let t=this.getScene().getStage(),e=this.m_v0;e.setXYZ(t.mouseX,t.mouseY,0),this.globalToLocal(e),this.pickColorByXY(e.x,e.y)}this.m_autoDelay++}stMouseUp(t){null!=this.m_scene&&(this.m_scene.removeEventListener(r.EventBase.ENTER_FRAME,this,this.enterFrame),this.m_scene.removeEventListener(r.MouseEvent.MOUSE_UP,this,this.stMouseUp))}layout(){}}e.ColorPickPanel=o},d632:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("23ac"),n=i("9ba1");class l extends s.UIEntityContainer{constructor(){super(),this.m_panelW=100,this.m_panelH=150,this.m_isOpen=!1,this.autoLayout=!0,this.m_openListener=null,this.m_closeListener=null,this.m_panelBuilding=!0}setSize(t,e){this.m_panelW=t,this.m_panelH=e}setBGColor(t){return null==this.m_bgColor&&(this.m_bgColor=CoMaterial.createColor4()),this.m_bgColor.copyFrom(t),null!=this.m_bgLabel&&this.m_bgLabel.setColor(t),this}init(){this.isIniting()&&(null==this.m_bgColor&&(this.m_bgColor=CoMaterial.createColor4()),super.init())}setUIscene(t,e=-1){null==this.m_scene&&null!=t&&(this.m_scene=t,e>=0&&(this.m_rpi=e),this.init())}openThis(){}closeThis(){}setOpenAndLoseListener(t,e){this.m_openListener=t,this.m_closeListener=e}open(t=null,e=-1){this.m_isOpen||(this.isIniting()&&this.init(),null!=t&&(this.m_scene=t),e>=0&&(this.m_rpi=e),this.m_scene.addEntity(this,this.m_rpi),this.m_isOpen=!0,this.setVisible(!0),this.openThis(),this.autoLayout&&(this.addLayoutEvt(),this.layout()),null!=this.m_openListener&&this.m_openListener())}isOpen(){return this.m_isOpen}isClosed(){return!this.m_isOpen}close(){this.m_isOpen&&(this.m_scene.removeEntity(this),this.m_isOpen=!1,this.setVisible(!1),this.removeLayoutEvt(),this.closeThis(),null!=this.m_closeListener&&this.m_closeListener())}destroy(){super.destroy(),this.m_panelBuilding=!0,null!=this.m_bgLabel&&(this.m_bgLabel.destroy(),this.m_bgLabel=null),this.m_openListener=null,this.m_closeListener=null}buildPanel(t,e){}updateScene(){let t=this.getScene();if(null!=t&&this.m_panelBuilding&&null==this.m_bgLabel){this.m_panelBuilding=!1;let t=this.m_panelW,e=this.m_panelH,i=this.createBG(t,e);this.buildPanel(t,e),this.addEntity(i),this.setVisible(this.m_isOpen),this.m_isOpen&&(this.addLayoutEvt(),this.layout())}}addLayoutEvt(){if(this.autoLayout){let t=this.getScene();if(null!=t){let e=CoRScene.EventBase;t.addEventListener(e.RESIZE,this,this.resize)}}}removeLayoutEvt(){if(this.autoLayout){let t=this.getScene();if(null!=t){let e=CoRScene.EventBase;t.removeEventListener(e.RESIZE,this,this.resize)}}}createBG(t,e){let i=new n.ColorLabel;return i.depthTest=!0,i.initialize(t,e),i.setZ(-.2),i.setColor(this.m_bgColor),this.m_bgLabel=i,this.initializeEvent(i.getREntities()[0]),i}initializeEvent(t,e="uiPlane"){const i=CoRScene.MouseEvent;let s=CoRScene.createMouseEvt3DDispatcher();s.currentTarget=this,s.uuid=e,s.addEventListener(i.MOUSE_OVER,this,this.mouseOverListener),s.addEventListener(i.MOUSE_OUT,this,this.mouseOutListener),t.setEvtDispatcher(s),t.mouseEnabled=!0}mouseOverListener(t){}mouseOutListener(t){}resize(t){this.layout()}layout(){let t=this.getScene();if(null!=t){this.update();let e=t.getRect(),i=Math.round(e.x+.5*(e.width-this.getWidth())),s=Math.round(e.y+.5*(e.height-this.getHeight()));this.setXY(i,s),this.update()}}}e.UIPanel=l},dab7:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("75f5");var n,l,r,a,o,h,u,c;e.RenderDrawMode=n,e.CullFaceMode=l,e.DepthTestMode=r,e.RenderBlendMode=a,e.GLStencilFunc=o,e.GLStencilOp=h,e.GLBlendMode=u,e.GLBlendEquation=c;class m{constructor(){this.m_init=!0}init(){"undefined"!==typeof CoRenderer&&(e.RenderDrawMode=n=CoRenderer.RenderDrawMode,e.CullFaceMode=l=CoRenderer.CullFaceMode,e.DepthTestMode=r=CoRenderer.DepthTestMode,e.RenderBlendMode=a=CoRenderer.RenderBlendMode,e.GLStencilFunc=o=CoRenderer.GLStencilFunc,e.GLStencilOp=h=CoRenderer.GLStencilOp,e.GLBlendMode=u=CoRenderer.GLBlendMode,e.GLBlendEquation=c=CoRenderer.GLBlendEquation)}initialize(t=null,e=""){return this.init(),this.m_init=!this.isEnabled(),!!this.m_init&&(this.m_init=!1,""!=e&&void 0!==e||(e="static/cospace/engine/renderer/CoRenderer.umd.min.js"),new s.ModuleLoader(1,()=>{this.init(),null!=t&&this.isEnabled()&&t([e])}).load(e),!0)}get RenderDrawMode(){return CoRenderer.RenderDrawMode}get CullFaceMode(){return CoRenderer.CullFaceMode}get DepthTestMode(){return CoRenderer.DepthTestMode}get RenderBlendMode(){return CoRenderer.RenderBlendMode}get GLStencilFunc(){return CoRenderer.GLStencilFunc}get GLStencilOp(){return CoRenderer.GLStencilOp}get GLBlendMode(){return CoRenderer.GLBlendMode}get GLBlendEquation(){return CoRenderer.GLBlendEquation}get RendererDevice(){return CoRenderer.RendererDevice}get RendererState(){return CoRenderer.RendererState}createRendererInstance(){return CoRenderer.createRendererInstance()}isEnabled(){return"undefined"!==typeof CoRenderer}}const _=new m;e.VoxRenderer=_},ddfa:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("0b77");class n extends s.UIEntityBase{constructor(){super(),this.m_index=0,this.m_total=0,this.m_colors=null,this.m_hasTex=!0,this.m_lb=null,this.m_ilb=null,this.uuid="colorClipLabel"}hasTexture(){return this.m_hasTex}setIconLabel(t){this.m_ilb=t}getIconLabel(){return this.m_ilb}initialize(t,e){if(this.isIniting()&&e>0){this.init(),this.m_lb=t;let i=new Array(e);for(let t=0;t<e;++t)i[t]=CoMaterial.createColor4();this.m_colors=i,this.m_total=e,this.setClipIndex(0)}}getColorAt(t){if(t>=0&&t<this.m_total)return this.m_colors[t]}setColorAt(t,e){t>=0&&t<this.m_total&&null!=e&&this.m_colors[t].copyFrom(e)}setClipIndex(t){t>=0&&t<this.m_total&&(this.m_index=t,this.m_lb.setColor(this.m_colors[t]))}setColors(t){if(null!=t){let e=this.m_colors,i=t.length;i>e.length&&(i=e.length);for(let s=0;s<i;++s)e[s].copyFrom(t[s]);3==i&&4==e.length&&e[3].copyFrom(t[1]),this.setClipIndex(this.m_index)}}setColorsWithHex(t){if(null!=t){let e=this.m_colors,i=t.length;i>e.length&&(i=e.length);for(let s=0;s<i;++s)e[s].setRGBUint24(t[s]);3==i&&4==e.length&&e[3].setRGBUint24(t[1]),this.setClipIndex(this.m_index)}}setCircleClipIndex(t){t%=this.m_total,t+=this.m_total,t%=this.m_total,this.setClipIndex(t)}getClipIndex(){return this.m_index}getClipsTotal(){return this.m_total}setLabelClipIndex(t){this.m_lb.setClipIndex(t)}getLabelClipIndex(){return this.m_lb.getClipIndex()}setLabelCircleClipIndex(t){this.m_lb.setCircleClipIndex(t)}getLabelClipsTotal(){return this.m_lb.getClipsTotal()}getColors(){return this.m_colors}getClipWidth(){return this.m_lb.getClipHeight()}getClipHeight(){return this.m_lb.getClipWidth()}copyTransformFrom(t){if(null!=t){let e=t.getScaleX(),i=t.getScaleY(),s=t.getRotation();this.setScaleXY(e,i),this.setRotation(s),t.getPosition(this.m_v0),this.setPosition(this.m_v0)}}getREntities(){if(null!=this.m_ilb){let t=this.m_lb.getREntities();return t.concat(this.m_ilb.getREntities())}return this.m_lb.getREntities()}getRContainer(){return null}update(){this.m_bounds.reset();let t=this.m_scaleV,e=this.m_lb;e.setRotation(this.m_rotation),e.setScaleXY(t.x,t.y),e.setPosition(this.m_pos),e.update(),this.m_bounds.union(e.getGlobalBounds()),e=this.m_ilb,null!=e&&(e.copyTransformFrom(this.m_lb),e.update(),this.m_bounds.union(e.getGlobalBounds())),this.m_bounds.updateFast()}destroy(){this.m_colors=null,this.m_total=0;let t=this.m_lb;null!=t&&(t.destroy(),t=null),t=this.m_ilb,null!=t&&(t.destroy(),t=null),super.destroy()}}e.ColorClipLabel=n},e8f9:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("88b9"),n=i("f35d"),l=i("ddfa");class r extends s.Button{constructor(){super(),this.m_flagLb=null,this.m_pw=32,this.m_ph=32,this.m_borderWidth=4,this.m_dis=4,this.uuid="flagBtn"}initializeWithSize(t,e=32,i=32,s=4,n=4){return this.isIniting()&&null!=t&&(this.m_pw=e,this.m_ph=i,this.m_borderWidth=s,this.m_dis=n,this.m_selectDispatcher=CoRScene.createEventBaseDispatcher(),this.m_currEvent=CoRScene.createSelectionEvent(),this.createFlagBtn(t)),this}addEventListener(t,e,i,s=!0,n=!1){return t==CoRScene.SelectionEvent.SELECT?this.m_selectDispatcher.addEventListener(t,e,i,s,n):super.addEventListener(t,e,i,s,n),this}removeEventListener(t,e,i){return t==CoRScene.SelectionEvent.SELECT?this.m_selectDispatcher.removeEventListener(t,e,i):super.removeEventListener(t,e,i),this}createFlagBtn(t){let e=t,i=CoMaterial.createColor4(.7,.7,.7),s=CoMaterial.createColor4(.3,.3,.3),r=this.createFlagImg(e,i,s);e.addImageToAtlas("flagBtn_01",r),i=CoMaterial.createColor4(.7,.7,.7),s=CoMaterial.createColor4(.3,.3,.3);let a=CoMaterial.createColor4(1,1,1);r=this.createFlagImg(e,i,s,a,this.m_dis),e.addImageToAtlas("flagBtn_02",r);let o=["flagBtn_01","flagBtn_02"],h=new n.ClipLabel;h.initialize(e,o);let u=new l.ColorClipLabel;u.initialize(h,4),u.getColorAt(0).setRGB3f(.8,.8,.8),u.getColorAt(1).setRGB3f(0,1,.2),u.getColorAt(2).setRGB3f(1,.2,1),u.setLabelClipIndex(0),this.m_flagLb=h,this.initializeWithLable(u)}sendSelectionEvt(){this.m_selectDispatcher.uuid=this.uuid,this.m_currEvent.target=this,this.m_currEvent.type=CoRScene.SelectionEvent.SELECT,this.m_currEvent.flag=this.getFlag(),this.m_currEvent.phase=1,this.m_selectDispatcher.dispatchEvt(this.m_currEvent),this.m_currEvent.target=null}mouseUpListener(t){this.isEnabled()&&(super.mouseUpListener(t),this.selectListener())}setFlag(t,e=!1){this.m_flagLb.setClipIndex(t?1:0),e&&this.sendSelectionEvt()}getFlag(){return 1==this.m_flagLb.getClipIndex()}selectListener(){1==this.m_flagLb.getClipIndex()?this.m_flagLb.setClipIndex(0):this.m_flagLb.setClipIndex(1),this.sendSelectionEvt()}createFlagImg(t,e,i,s=null,n=2){let l=this.m_pw,r=this.m_ph,a=this.m_borderWidth,o=t.createCanvas(l,r,e,!1),h=o.getContext("2d");return h.fillStyle=i.getCSSDecRGBAColor(),h.fillRect(a,a,l-2*a,r-2*a-1),null!=s&&(h.fillStyle=s.getCSSDecRGBAColor(),h.fillRect(a+n,a+n,l-2*(a+n),r-2*(a+n)-1)),o}destroy(){this.m_flagLb=null,super.destroy()}}e.FlagButton=r},efac:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("5470");class n extends s.LayouterBase{constructor(){super(),this.m_offsetvs=[]}update(t){const e=this.m_entities,i=e.length;let s=CoMath.createVec3();for(let n=0;n<i;++n)s.copyFrom(this.m_offsetvs[n]),s.y=t.height-s.y,s.addBy(this.m_offsetV),e[n].setPosition(s),e[n].update()}initEntityLayout(t,e){let i=CoMath.createVec3();t.getPosition(i),i.y=e.height-i.y,this.m_offsetvs.push(i)}destroy(){this.m_offsetvs=null,super.destroy()}}e.LeftTopLayouter=n},f042:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("75f5");var n,l,r;e.OrientationType=n,e.MathConst=l,e.Vector3D=r;class a{constructor(){this.m_init=!0}init(){this.isEnabled()&&(e.OrientationType=n=CoMath.OrientationType,e.MathConst=l=CoMath.MathConst,e.Vector3D=r=CoMath.Vector3D)}initialize(t=null,e=""){return this.init(),this.m_init=!this.isEnabled(),!!this.m_init&&(this.m_init=!1,""!=e&&void 0!==e||(e="static/cospace/math/CoMath.umd.min.js"),new s.ModuleLoader(1,()=>{this.init(),null!=t&&this.isEnabled()&&t([e])}).load(e),!0)}isEnabled(){return"undefined"!==typeof CoMath}get Vector3D(){return CoMath.Vector3D}get MathConst(){return CoMath.MathConst}get OrientationType(){return CoMath.OrientationType}createVec3(t,e,i,s){return CoMath.createVec3(t,e,i,s)}createMat4(t,e){return CoMath.createMat4(t,e)}createAABB(){return CoMath.createAABB()}createAABB2D(t,e,i,s){return CoMath.createAABB2D(t,e,i,s)}isZero(t){return CoMath.isZero(t)}isNotZero(t){return CoMath.isNotZero(t)}isGreaterPositiveZero(t){return CoMath.isGreaterPositiveZero(t)}isLessNegativeZero(t){return CoMath.isLessNegativeZero(t)}isLessPositiveZero(t){return CoMath.isLessPositiveZero(t)}isGreaterNegativeZero(t){return CoMath.isGreaterNegativeZero(t)}isPostiveZero(t){return CoMath.isPostiveZero(t)}isNegativeZero(t){return CoMath.isNegativeZero(t)}isGreaterRealZero(t){return CoMath.isGreaterRealZero(t)}isLessRealZero(t){return CoMath.isLessRealZero(t)}}const o=new a;e.VoxMath=o},f280:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("7913");class n{constructor(){this.m_promptPanel=null}initialize(t,e=3){if(null==this.m_promptPanel){this.m_uiscene=t;let i=t.uiConfig,n=i.getUIPanelCfgByName("promptPanel"),l=n.panelSize,r=n.btnSize,a=n.btnNames,o=new s.PromptPanel;o.initialize(this.m_uiscene,e,l[0],l[1],r[0],r[1],a[0],a[1]),o.setZ(3);let h=CoMaterial.createColor4();h.fromBytesArray3(n.bgColor),o.setBGColor(h),this.m_promptPanel=o}}setPromptListener(t,e,i=0){null!=this.m_promptPanel&&this.m_promptPanel.setListener(t,e)}showPrompt(t,e=0){null!=this.m_promptPanel&&(this.m_promptPanel.setPrompt(t),this.m_promptPanel.open())}setPromptTextColor(t,e=0){null!=this.m_promptPanel&&this.m_promptPanel.setPromptTextColor(t)}setPromptBGColor(t,e=0){null!=this.m_promptPanel&&this.m_promptPanel.setBGColor(t)}getPromptPanel(t=0){return this.m_promptPanel}}e.PromptSystem=n},f35d:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("c21f");class n extends s.ClipLabelBase{constructor(){super(),this.m_material=null}createMesh(t,e){let i=4,s=[0,1,2,0,2,3];const n=this.m_total;let l=new Uint16Array(6*n),r=new Float32Array(12*n),a=new Float32Array(8*n);this.m_sizes=new Array(2*n);let o=0;for(let u=0;u<n;++u){const n=t.getTexObjFromAtlas(e[u]);l.set(s,u*s.length),r.set(this.createVS(0,0,n.getWidth(),n.getHeight()),12*u),a.set(n.uvs,8*u);for(let t=0;t<s.length;++t)s[t]+=i;this.m_sizes[o++]=n.getWidth(),this.m_sizes[o++]=n.getHeight()}let h=CoMesh.createRawMesh();return h.reset(),h.setIVS(l),h.addFloat32Data(r,3),h.addFloat32Data(a,2),h.initialize(),h}hasTexture(){return!0}initialize(t,e){if(this.isIniting()&&null!=t&&null!=e&&e.length>0){this.init(),this.m_pos=CoMath.createVec3(),this.m_total=e.length;let i=t.getTexObjFromAtlas(e[0]),s=this.createMesh(t,e);this.m_vtCount=s.vtCount,this.m_material=this.createMaterial(i.texture),this.m_material.vtxInfo=CoRScene.createVtxDrawingInfo();let n=CoEntity.createDisplayEntity();n.setMaterial(this.m_material),n.setMesh(s),n.setIvsParam(0,this.m_step),this.m_entities.push(n),this.applyRST(n),this.setClipIndex(0)}}initializeWithLable(t){if(this.isIniting()&&null!=t&&t!=this){if(t.getClipsTotal()<1)throw Error("Error: srcLable.getClipsTotal() < 1");this.init();let e=t.getREntities();for(let i=0;i<e.length;++i){let s=e[i],n=s.getMesh();this.m_pos=CoMath.createVec3();let l=s.getMaterial().getTextureAt(0),r=this.m_total=t.getClipsTotal();this.m_sizes=new Array(2*r);let a=0;for(let e=0;e<r;++e)this.m_sizes[a++]=t.getClipWidthAt(e),this.m_sizes[a++]=t.getClipHeightAt(e);this.m_vtCount=n.vtCount,this.m_material=this.createMaterial(l),this.m_material.vtxInfo=CoRScene.createVtxDrawingInfo();let o=CoEntity.createDisplayEntity();o.setMaterial(this.m_material),o.setMesh(n),o.setIvsParam(0,this.m_step),this.m_entities.push(o),this.applyRST(o)}this.setClipIndex(0)}}displaceFromLable(t){if(null!=t&&t!=this&&t.getClipsTotal()<1)throw Error("Error: srcLable.getClipsTotal() < 1")}setColor(t){null!=this.m_material&&this.m_material.setColor(t)}getColor(t){null!=this.m_material&&this.m_material.getColor(t)}setClipIndex(t){if(t>=0&&t<this.m_total){this.m_index=t;let e=this.m_entities;for(let i=0;i<e.length;++i)e[i].getMaterial().vtxInfo.setIvsParam(t*this.m_step,this.m_step);t<<=1,this.m_width=this.m_sizes[t],this.m_height=this.m_sizes[t+1]}}}e.ClipLabel=n},fae3:function(t,e,i){"use strict";i.r(e);i("1eb2");var s=i("7dc1");for(var n in s)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(n)}})}));