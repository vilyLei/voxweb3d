(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["ModuleCTMGeomParser"]=t():e["ModuleCTMGeomParser"]=t()})("undefined"!==typeof self?self:this,(function(){return function(e){var t={};function r(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(s,i,function(t){return e[t]}.bind(null,i));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="fae3")}({"1eb2":function(e,t,r){"use strict";if("undefined"!==typeof window){var s=window.document.currentScript,i=r("8875");s=i(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:i});var a=s&&s.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);a&&(r.p=a[1])}},"1f9e":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{}s.PARSE="CTM_PARSE",s.LOAD_AND_PARSE="CTM_LOAD_AND_PARSE",t.CTMTaskCMD=s},"3a68":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{constructor(e=!0){e&&ThreadCore.initializeExternModule(this)}receiveData(e){}postMessageToThread(e,t=null){null!=t?ThreadCore.postMessageToThread(e):ThreadCore.postMessageToThread(e,t)}getTaskClass(){throw Error("the taskClass value is illegal !!!")}dependencyFinish(){}getUniqueName(){throw Error("the uniqueName value is illegal !!!")}}t.BaseTaskInThread=s},"64e2":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{constructor(){this._pos=0,this._streamPos=0,this._windowSize=0}create(e){this._buffer&&this._windowSize===e||(this._buffer=[]),this._windowSize=e,this._pos=0,this._streamPos=0}flush(){var e=this._pos-this._streamPos;if(0!==e){while(e--)this._stream.writeByte(this._buffer[this._streamPos++]);this._pos>=this._windowSize&&(this._pos=0),this._streamPos=this._pos}}releaseStream(){this.flush(),this._stream=null}setStream(e){this.releaseStream(),this._stream=e}init(e){e||(this._streamPos=0,this._pos=0)}copyBlock(e,t){var r=this._pos-e-1;r<0&&(r+=this._windowSize);while(t--)r>=this._windowSize&&(r=0),this._buffer[this._pos++]=this._buffer[r++],this._pos>=this._windowSize&&this.flush()}putByte(e){this._buffer[this._pos++]=e,this._pos>=this._windowSize&&this.flush()}getByte(e){var t=this._pos-e-1;return t<0&&(t+=this._windowSize),this._buffer[t]}}class i{constructor(){this._code=0,this._range=-1}setStream(e){this._stream=e}releaseStream(){this._stream=null}init(){var e=5;this._code=0,this._range=-1;while(e--)this._code=this._code<<8|this._stream.readByte()}decodeDirectBits(e){var t,r=0,s=e;while(s--)this._range>>>=1,t=this._code-this._range>>>31,this._code-=this._range&t-1,r=r<<1|1-t,0===(4278190080&this._range)&&(this._code=this._code<<8|this._stream.readByte(),this._range<<=8);return r}decodeBit(e,t){var r=e[t],s=(this._range>>>11)*r;return(2147483648^this._code)<(2147483648^s)?(this._range=s,e[t]+=2048-r>>>5,0===(4278190080&this._range)&&(this._code=this._code<<8|this._stream.readByte(),this._range<<=8),0):(this._range-=s,this._code-=s,e[t]-=r>>>5,0===(4278190080&this._range)&&(this._code=this._code<<8|this._stream.readByte(),this._range<<=8),1)}}class a{constructor(e){this._models=[],this._numBitLevels=0,this._models=[],this._numBitLevels=e}init(){c.initBitModels(this._models,1<<this._numBitLevels)}decode(e){var t=1,r=this._numBitLevels;while(r--)t=t<<1|e.decodeBit(this._models,t);return t-(1<<this._numBitLevels)}reverseDecode(e){for(var t,r=1,s=0,i=0;i<this._numBitLevels;++i)t=e.decodeBit(this._models,r),r=r<<1|t,s|=t<<i;return s}}class o{constructor(){this._choice=[],this._lowCoder=[],this._midCoder=[],this._highCoder=new a(8),this._numPosStates=0}create(e){for(;this._numPosStates<e;++this._numPosStates)this._lowCoder[this._numPosStates]=new a(3),this._midCoder[this._numPosStates]=new a(3)}init(){var e=this._numPosStates;c.initBitModels(this._choice,2);while(e--)this._lowCoder[e].init(),this._midCoder[e].init();this._highCoder.init()}decode(e,t){return 0===e.decodeBit(this._choice,0)?this._lowCoder[t].decode(e):0===e.decodeBit(this._choice,1)?8+this._midCoder[t].decode(e):16+this._highCoder.decode(e)}}class n{constructor(){this._decoders=[]}init(){c.initBitModels(this._decoders,768)}decodeNormal(e){var t=1;do{t=t<<1|e.decodeBit(this._decoders,t)}while(t<256);return 255&t}decodeWithMatchByte(e,t){var r,s,i=1;do{if(r=t>>7&1,t<<=1,s=e.decodeBit(this._decoders,(1+r<<8)+i),i=i<<1|s,r!==s){while(i<256)i=i<<1|e.decodeBit(this._decoders,i);break}}while(i<256);return 255&i}}class d{constructor(){this._coders=null}create(e,t){var r;if(!this._coders||this._numPrevBits!==t||this._numPosBits!==e){this._numPosBits=e,this._posMask=(1<<e)-1,this._numPrevBits=t,this._coders=[],r=1<<this._numPrevBits+this._numPosBits;while(r--)this._coders[r]=new n}}init(){var e=1<<this._numPrevBits+this._numPosBits;while(e--)this._coders[e].init()}getDecoder(e,t){return this._coders[((e&this._posMask)<<this._numPrevBits)+((255&t)>>>8-this._numPrevBits)]}}class h{constructor(){this._outWindow=new s,this._rangeDecoder=new i,this._isMatchDecoders=[],this._isRepDecoders=[],this._isRepG0Decoders=[],this._isRepG1Decoders=[],this._isRepG2Decoders=[],this._isRep0LongDecoders=[],this._posSlotDecoder=[],this._posDecoders=[],this._posAlignDecoder=new a(4),this._lenDecoder=new o,this._repLenDecoder=new o,this._literalDecoder=new d,this._dictionarySize=-1,this._dictionarySizeCheck=-1,this._posStateMask=0,this._posSlotDecoder[0]=new a(6),this._posSlotDecoder[1]=new a(6),this._posSlotDecoder[2]=new a(6),this._posSlotDecoder[3]=new a(6)}setDictionarySize(e){return!(e<0)&&(this._dictionarySize!==e&&(this._dictionarySize=e,this._dictionarySizeCheck=Math.max(this._dictionarySize,1),this._outWindow.create(Math.max(this._dictionarySizeCheck,4096))),!0)}setLcLpPb(e,t,r){var s=1<<r;return!(e>8||t>4||r>4)&&(this._literalDecoder.create(t,e),this._lenDecoder.create(s),this._repLenDecoder.create(s),this._posStateMask=s-1,!0)}init(){var e=4;this._outWindow.init(!1),c.initBitModels(this._isMatchDecoders,192),c.initBitModels(this._isRep0LongDecoders,192),c.initBitModels(this._isRepDecoders,12),c.initBitModels(this._isRepG0Decoders,12),c.initBitModels(this._isRepG1Decoders,12),c.initBitModels(this._isRepG2Decoders,12),c.initBitModels(this._posDecoders,114),this._literalDecoder.init();while(e--)this._posSlotDecoder[e].init();this._lenDecoder.init(),this._repLenDecoder.init(),this._posAlignDecoder.init(),this._rangeDecoder.init()}decode(e,t,r){var s,i,a,o,n,d,h=0,l=0,u=0,_=0,f=0,p=0,m=0;this._rangeDecoder.setStream(e),this._outWindow.setStream(t),this.init();while(r<0||p<r)if(s=p&this._posStateMask,0===this._rangeDecoder.decodeBit(this._isMatchDecoders,(h<<4)+s))i=this._literalDecoder.getDecoder(p++,m),m=h>=7?i.decodeWithMatchByte(this._rangeDecoder,this._outWindow.getByte(l)):i.decodeNormal(this._rangeDecoder),this._outWindow.putByte(m),h=h<4?0:h-(h<10?3:6);else{if(1===this._rangeDecoder.decodeBit(this._isRepDecoders,h))a=0,0===this._rangeDecoder.decodeBit(this._isRepG0Decoders,h)?0===this._rangeDecoder.decodeBit(this._isRep0LongDecoders,(h<<4)+s)&&(h=h<7?9:11,a=1):(0===this._rangeDecoder.decodeBit(this._isRepG1Decoders,h)?o=u:(0===this._rangeDecoder.decodeBit(this._isRepG2Decoders,h)?o=_:(o=f,f=_),_=u),u=l,l=o),0===a&&(a=2+this._repLenDecoder.decode(this._rangeDecoder,s),h=h<7?8:11);else if(f=_,_=u,u=l,a=2+this._lenDecoder.decode(this._rangeDecoder,s),h=h<7?7:10,n=this._posSlotDecoder[a<=5?a-2:3].decode(this._rangeDecoder),n>=4){if(d=(n>>1)-1,l=(2|1&n)<<d,n<14)l+=c.reverseDecode2(this._posDecoders,l-n-1,this._rangeDecoder,d);else if(l+=this._rangeDecoder.decodeDirectBits(d-4)<<4,l+=this._posAlignDecoder.reverseDecode(this._rangeDecoder),l<0){if(-1===l)break;return!1}}else l=n;if(l>=p||l>=this._dictionarySizeCheck)return!1;this._outWindow.copyBlock(l,a),p+=a,m=this._outWindow.getByte(0)}return this._outWindow.flush(),this._outWindow.releaseStream(),this._rangeDecoder.releaseStream(),!0}setDecoderProperties(e){var t,r,s,i,a;return!(e.size<5)&&(t=e.readByte(),r=t%9,t=~~(t/9),s=t%5,i=~~(t/5),!!this.setLcLpPb(r,s,i)&&(a=e.readByte(),a|=e.readByte()<<8,a|=e.readByte()<<16,a+=16777216*e.readByte(),this.setDictionarySize(a)))}}class c{constructor(){this.uuid="LZMA"}static initBitModels(e,t){while(t--)e[t]=1024}static reverseDecode2(e,t,r,s){for(var i,a=1,o=0,n=0;n<s;++n)i=r.decodeBit(e,t+a),a=a<<1|i,o|=i<<n;return o}static decompress(e,t,r,s){var i=new h;if(!i.setDecoderProperties(e))throw"Incorrect stream properties";if(!i.decode(t,r,s))throw"Error in data stream";return!0}}t.LZMA=c},8875:function(e,t,r){var s,i,a;(function(r,o){i=[],s=o,a="function"===typeof s?s.apply(t,i):s,void 0===a||(e.exports=a)})("undefined"!==typeof self&&self,(function(){function e(){var t=Object.getOwnPropertyDescriptor(document,"currentScript");if(!t&&"currentScript"in document&&document.currentScript)return document.currentScript;if(t&&t.get!==e&&document.currentScript)return document.currentScript;try{throw new Error}catch(_){var r,s,i,a=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,o=/@([^@]*):(\d+):(\d+)\s*$/gi,n=a.exec(_.stack)||o.exec(_.stack),d=n&&n[1]||!1,h=n&&n[2]||!1,c=document.location.href.replace(document.location.hash,""),l=document.getElementsByTagName("script");d===c&&(r=document.documentElement.outerHTML,s=new RegExp("(?:[^\\n]+?\\n){0,"+(h-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),i=r.replace(s,"$1").trim());for(var u=0;u<l.length;u++){if("interactive"===l[u].readyState)return l[u];if(l[u].src===d)return l[u];if(d===c&&l[u].innerHTML&&l[u].innerHTML.trim()===i)return l[u]}return null}}return e}))},ae3d:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r("d169");class i{constructor(){}parserStringData(e){var t=new s.CTMStringStream(e);t.offset=0;let r=new s.CTMFile(t);if(null!=r){let e=r.body;return e}return null}parserBinaryData(e){let t=new s.CTMStream(new Uint8Array(e));t.offset=0;let r=new s.CTMFile(t);if(null!=r){let e=r.body;return e}return null}}t.CTMGeomDataParser=i},c37c:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r("ae3d"),i=r("3a68"),a=r("1f9e");class o extends i.BaseTaskInThread{constructor(){super(!1)}parseMeshData(e,t){let r=new s.CTMGeomDataParser,i=null;try{i=r.parserBinaryData(t)}catch(o){}let a=[t.buffer];if(null!=i){let t=i.uvMaps.length,r=[];for(let e=0;e<t;++e)r.push(i.uvMaps[e].uv),a.push(i.uvMaps[e].uv.buffer);if(t=i.indices.length,t<65536){let e=new Uint16Array(i.indices.buffer),r=i.indices;for(let s=0;s<t;++s)e[s]=r[s];i.indices=e.subarray(0,t)}e.data={uvsList:r,vertices:i.vertices,normals:i.normals,indices:i.indices}}else e.data={uvsList:null,vertices:null,normals:null,indices:null};this.postMessageToThread(e,a)}}class n extends i.BaseTaskInThread{constructor(){super(),this.m_parser=new o}receiveData(e){switch(e.taskCmd){case a.CTMTaskCMD.PARSE:let t=e.streams[0];this.m_parser.parseMeshData(e,t);break;case a.CTMTaskCMD.LOAD_AND_PARSE:Date.now();this.loadMeshDataByUrl(e.descriptor.url,(t,r)=>{let s=new o;try{s.parseMeshData(e,new Uint8Array(t))}catch(i){}},(e,t)=>{});break;default:break}}async loadMeshDataByUrl(e,t,r,s=""){const i=new FileReader;i.onload=r=>{t(i.result,e)};const a=new XMLHttpRequest;a.open("GET",e,!0),""!=s&&a.setRequestHeader("Range",s),a.responseType="blob",a.onload=t=>{a.status<=206?i.readAsArrayBuffer(a.response):r(a.status,e)},a.onerror=t=>{r(a.status,e)},a.send(null)}getTaskClass(){return 101}}t.ModuleCTMGeomParser=n;new n},d169:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r("64e2");class i{constructor(e,t){this.data=null,this.data=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),this.offset=d.isLittleEndian?3:0,this.count=4*t,this.len=this.data.length}writeByte(e){this.data[this.offset]=e,this.offset+=this.count,this.offset>=this.len&&(this.offset-=this.len-4,this.offset>=this.count&&(this.offset-=this.count+(d.isLittleEndian?1:-1)))}}class a{constructor(e){e.readInt32(),this.fileFormat=e.readInt32(),this.compressionMethod=e.readInt32(),this.vertexCount=e.readInt32(),this.triangleCount=e.readInt32(),this.uvMapCount=e.readInt32(),this.attrMapCount=e.readInt32(),this.flags=e.readInt32(),this.comment=e.readString()}hasNormals(){return this.flags&d.Flags.NORMALS}}class o{constructor(e){e.readInt32(),this.vertexPrecision=e.readFloat32(),this.normalPrecision=e.readFloat32(),this.lowerBoundx=e.readFloat32(),this.lowerBoundy=e.readFloat32(),this.lowerBoundz=e.readFloat32(),this.higherBoundx=e.readFloat32(),this.higherBoundy=e.readFloat32(),this.higherBoundz=e.readFloat32(),this.divx=e.readInt32(),this.divy=e.readInt32(),this.divz=e.readInt32(),this.sizex=(this.higherBoundx-this.lowerBoundx)/this.divx,this.sizey=(this.higherBoundy-this.lowerBoundy)/this.divy,this.sizez=(this.higherBoundz-this.lowerBoundz)/this.divz}}class n{getUVSAt(e){return this.uvMaps[e].uv}constructor(e){let t=3*e.triangleCount,r=3*e.vertexCount,s=e.hasNormals()?3*e.vertexCount:0,i=2*e.vertexCount,a=4*e.vertexCount,o=0,n=new ArrayBuffer(4*(t+r+s+i*e.uvMapCount+a*e.attrMapCount));if(this.indices=new Uint32Array(n,0,t),this.vertices=new Float32Array(n,4*t,r),e.hasNormals()&&(this.normals=new Float32Array(n,4*(t+r),s)),e.uvMapCount)for(this.uvMaps=[],o=0;o<e.uvMapCount;++o)this.uvMaps[o]={uv:new Float32Array(n,4*(t+r+s+o*i),i)};if(e.attrMapCount)for(this.attrMaps=[],o=0;o<e.attrMapCount;++o)this.attrMaps[o]={attr:new Float32Array(n,4*(t+r+s+i*e.uvMapCount+o*a),a)}}}t.CTMFileBody=n;class d{static isLittleEndian(){let e=new ArrayBuffer(2),t=new Uint8Array(e),r=new Uint16Array(e);return t[0]=1,1===r[0]}static InterleavedStream(e,t){return new i(e,t)}static restoreIndices(e,t){let r=3;for(t>0&&(e[2]+=e[0]);r<t;r+=3)e[r]+=e[r-3],e[r]===e[r-3]?e[r+1]+=e[r-2]:e[r+1]+=e[r],e[r+2]+=e[r]}static calcSmoothNormals(e,t){let r,s,i,a,o,n,d,h,c,l,u,_,f,p,m,M=new Float32Array(t.length);for(p=0,m=e.length;p<m;)r=3*e[p++],s=3*e[p++],i=3*e[p++],d=t[s]-t[r],l=t[i]-t[r],h=t[s+1]-t[r+1],u=t[i+1]-t[r+1],c=t[s+2]-t[r+2],_=t[i+2]-t[r+2],a=h*_-c*u,o=c*l-d*_,n=d*u-h*l,f=Math.sqrt(a*a+o*o+n*n),f>1e-10&&(a/=f,o/=f,n/=f),M[r]+=a,M[r+1]+=o,M[r+2]+=n,M[s]+=a,M[s+1]+=o,M[s+2]+=n,M[i]+=a,M[i+1]+=o,M[i+2]+=n;for(p=0,m=M.length;p<m;p+=3)f=Math.sqrt(M[p]*M[p]+M[p+1]*M[p+1]+M[p+2]*M[p+2]),f>1e-10&&(M[p]/=f,M[p+1]/=f,M[p+2]/=f);return M}static restoreVertices(e,t,r,s){let i,a,o,n,d,h=new Uint32Array(e.buffer,e.byteOffset,e.length),c=t.divx,l=c*t.divy,u=2147483647,_=0,f=0,p=0,m=r.length;for(;f<m;p+=3)o=i=r[f++],d=~~(o/l),o-=~~(d*l),n=~~(o/c),o-=~~(n*c),a=h[p],i===u&&(a+=_),e[p]=t.lowerBoundx+o*t.sizex+s*a,e[p+1]=t.lowerBoundy+n*t.sizey+s*h[p+1],e[p+2]=t.lowerBoundz+d*t.sizez+s*h[p+2],u=i,_=a}static restoreGridIndices(e,t){let r=1;for(;r<t;++r)e[r]+=e[r-1]}static restoreNormals(e,t,r){let s,i,a,o,n,d,h,c,l,u,_=new Uint32Array(e.buffer,e.byteOffset,e.length),f=0,p=e.length,m=1.5707963267948966;for(;f<p;f+=3)s=_[f]*r,i=_[f+1],0===i?(e[f]=t[f]*s,e[f+1]=t[f+1]*s,e[f+2]=t[f+2]*s):(a=i<=4?(_[f+2]-2)*m:(4*_[f+2]/i-2)*m,i*=r*m,o=s*Math.sin(i),n=o*Math.cos(a),d=o*Math.sin(a),h=s*Math.cos(i),l=t[f+1],c=t[f]-t[f+2],u=Math.sqrt(2*l*l+c*c),u>1e-20&&(c/=u,l/=u),e[f]=t[f]*h+(t[f+1]*l-t[f+2]*c)*d-l*n,e[f+1]=t[f+1]*h-(t[f+2]+t[f])*l*d+c*n,e[f+2]=t[f+2]*h+(t[f]*c+t[f+1]*l)*d+l*n)}static restoreMap(e,t,r){let s,i,a,o=new Uint32Array(e.buffer,e.byteOffset,e.length),n=0,d=e.length;for(;n<t;++n)for(s=0,a=n;a<d;a+=t)i=o[a],s+=1&i?-(i+1>>1):i>>1,e[a]=s*r}}d.CompressionMethod={RAW:5718354,MG1:3229517,MG2:3295053},d.Flags={NORMALS:1};class h{constructor(){}readAttrMaps(e,t){let r=0;for(;r<t.length;++r)e.readInt32(),t[r].name=e.readString(),e.readArrayFloat32(t[r].attr)}readUVMaps(e,t){let r=0;for(;r<t.length;++r)e.readInt32(),t[r].name=e.readString(),t[r].filename=e.readString(),e.readArrayFloat32(t[r].uv)}readNormals(e,t){e.readInt32(),e.readArrayFloat32(t)}readVertices(e,t){e.readInt32(),e.readArrayFloat32(t)}readIndices(e,t){e.readInt32(),e.readArrayInt32(t)}read(e,t){this.readIndices(e,t.indices),this.readVertices(e,t.vertices),t.normals&&this.readNormals(e,t.normals),t.uvMaps&&this.readUVMaps(e,t.uvMaps),t.attrMaps&&this.readAttrMaps(e,t.attrMaps)}}class c{constructor(){}read(e,t){this.readIndices(e,t.indices),this.readVertices(e,t.vertices),t.normals&&this.readNormals(e,t.normals),t.uvMaps&&this.readUVMaps(e,t.uvMaps),t.attrMaps&&this.readAttrMaps(e,t.attrMaps)}readIndices(e,t){e.readInt32(),e.readInt32();let r=d.InterleavedStream(t,3);s.LZMA.decompress(e,e,r,r.data.length),d.restoreIndices(t,t.length)}readVertices(e,t){e.readInt32(),e.readInt32();let r=d.InterleavedStream(t,1);s.LZMA.decompress(e,e,r,r.data.length)}readNormals(e,t){e.readInt32(),e.readInt32();let r=d.InterleavedStream(t,3);s.LZMA.decompress(e,e,r,r.data.length)}readUVMaps(e,t){let r=0;for(;r<t.length;++r){e.readInt32(),t[r].name=e.readString(),t[r].filename=e.readString(),e.readInt32();let i=d.InterleavedStream(t[r].uv,2);s.LZMA.decompress(e,e,i,i.data.length)}}readAttrMaps(e,t){let r=0;for(;r<t.length;++r){e.readInt32(),t[r].name=e.readString(),e.readInt32();let i=d.InterleavedStream(t[r].attr,4);s.LZMA.decompress(e,e,i,i.data.length)}}}class l{constructor(){}read(e,t){this.MG2Header=new o(e),this.readVertices(e,t.vertices),this.readIndices(e,t.indices),t.normals&&this.readNormals(e,t),t.uvMaps&&this.readUVMaps(e,t.uvMaps),t.attrMaps&&this.readAttrMaps(e,t.attrMaps)}readVertices(e,t){e.readInt32(),e.readInt32();let r=new i(t,3);s.LZMA.decompress(e,e,r,r.data.length);let a=this.readGridIndices(e,t);d.restoreVertices(t,this.MG2Header,a,this.MG2Header.vertexPrecision)}readGridIndices(e,t){e.readInt32(),e.readInt32();let r=new Uint32Array(t.length/3),a=new i(r,1);return s.LZMA.decompress(e,e,a,a.data.length),d.restoreGridIndices(r,r.length),r}readIndices(e,t){e.readInt32(),e.readInt32();let r=new i(t,3);s.LZMA.decompress(e,e,r,r.data.length),d.restoreIndices(t,t.length)}readNormals(e,t){e.readInt32(),e.readInt32();let r=new i(t.normals,3);s.LZMA.decompress(e,e,r,r.data.length);let a=d.calcSmoothNormals(t.indices,t.vertices);d.restoreNormals(t.normals,a,this.MG2Header.normalPrecision)}readUVMaps(e,t){let r=0;for(;r<t.length;++r){e.readInt32(),t[r].name=e.readString(),t[r].filename=e.readString();let a=e.readFloat32();e.readInt32();let o=new i(t[r].uv,2);s.LZMA.decompress(e,e,o,o.data.length),d.restoreMap(t[r].uv,2,a)}}readAttrMaps(e,t){let r=0;for(;r<t.length;++r){e.readInt32(),t[r].name=e.readString();let a=e.readFloat32();e.readInt32();let o=new i(t[r].attr,4);s.LZMA.decompress(e,e,o,o.data.length),d.restoreMap(t[r].attr,4,a)}}}class u{constructor(e){this.TWO_POW_MINUS23=Math.pow(2,-23),this.TWO_POW_MINUS126=Math.pow(2,-126),this.data=e,this.offset=0}decodeUint8Arr(e){return new TextDecoder("utf-8").decode(e)}readByte(){return 255&this.data[this.offset++]}readInt32(){let e=this.data[this.offset++];return e|=this.data[this.offset++]<<8,e|=this.data[this.offset++]<<16,e|this.data[this.offset++]<<24}readFloat32(){let e=this.data[this.offset++];e+=this.data[this.offset++]<<8;let t=this.data[this.offset++],r=this.data[this.offset++];e+=(127&t)<<16;let s=(127&r)<<1|(128&t)>>>7,i=128&r?-1:1;return 255===s?0!==e?NaN:i*(1/0):s>0?i*(1+e*this.TWO_POW_MINUS23)*Math.pow(2,s-127):0!==e?i*e*this.TWO_POW_MINUS126:0*i}readString(){let e=this.readInt32();this.offset+=e;let t=this.data.subarray(this.offset-e,this.offset);return this.decodeUint8Arr(t)}readArrayInt32(e){let t=0,r=e.length;while(t<r)e[t++]=this.readInt32();return e}readArrayFloat32(e){let t=0,r=e.length;while(t<r)e[t++]=this.readFloat32();return e}}t.CTMStream=u;class _{constructor(e){this.TWO_POW_MINUS23=Math.pow(2,-23),this.TWO_POW_MINUS126=Math.pow(2,-126),this.data=null,this.offset=0,this.data=e,this.offset=0}readByte(){return 255&this.data.charCodeAt(this.offset++)}readInt32(){let e=this.readByte();return e|=this.readByte()<<8,e|=this.readByte()<<16,e|this.readByte()<<24}readFloat32(){let e=this.readByte();e+=this.readByte()<<8;let t=this.readByte(),r=this.readByte();e+=(127&t)<<16;let s=(127&r)<<1|(128&t)>>>7,i=128&r?-1:1;return 255===s?0!==e?NaN:i*(1/0):s>0?i*(1+e*this.TWO_POW_MINUS23)*Math.pow(2,s-127):0!==e?i*e*this.TWO_POW_MINUS126:0*i}readString(){let e=this.readInt32();return this.offset+=e,this.data.slice(this.offset-e,this.offset)}readArrayInt32(e){let t=0,r=e.length;while(t<r)e[t++]=this.readInt32();return e}readArrayFloat32(e){let t=0,r=e.length;while(t<r)e[t++]=this.readFloat32();return e}}t.CTMStringStream=_;class f{constructor(e){this.getReader=function(){let e;switch(this.header.compressionMethod){case d.CompressionMethod.RAW:e=new h;break;case d.CompressionMethod.MG1:e=new c;break;case d.CompressionMethod.MG2:e=new l;break}return e},this.load(e)}load(e){this.header=new a(e),this.body=new n(this.header),this.getReader().read(e,this.body)}}t.CTMFile=f},fae3:function(e,t,r){"use strict";r.r(t);r("1eb2");var s=r("c37c");for(var i in s)["default"].indexOf(i)<0&&function(e){r.d(t,e,(function(){return s[e]}))}(i)}})}));