(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["ModuleDracoGeomParser"]=t():e["ModuleDracoGeomParser"]=t()})("undefined"!==typeof self?self:this,(function(){return function(e){var t={};function r(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(s,n,function(t){return e[t]}.bind(null,n));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="fae3")}({"1eb2":function(e,t,r){"use strict";if("undefined"!==typeof window){var s=window.document.currentScript,n=r("8875");s=n(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:n});var a=s&&s.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);a&&(r.p=a[1])}},"2e55":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{}s.PARSE="DRACO_PARSE",s.THREAD_ACQUIRE_DATA="DRACO_THREAD_ACQUIRE_DATA",s.THREAD_TRANSMIT_DATA="DRACO_THREAD_TRANSMIT_DATA",t.DracoTaskCMD=s},"56b4":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r("2e55");let n=s.DracoTaskCMD;const a=1;class i{constructor(){this.parser=null,this.attMap=null,this.attOpts=null,this.verbosity=1,this.drawMode=0,this.vsScale=1,this.attNSMap={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD",generic:"GENERIC"}}getAttributeOptions(e){return"undefined"===typeof this.attOpts[e]&&(this.attOpts[e]={}),this.attOpts[e]}addAttributeToGeometry(e,t,r,s,n,a){if(0===n.ptr){let e="DracoGeomParser: No attribute "+s;throw new Error(e)}let i=n.num_components(),o=new e.DracoFloat32Array;t.GetAttributeFloatForAllPoints(r,n,o);let d=r.num_points(),u=d*i,c=new Float32Array(u+1);c[0]=i;for(let l=0;l<u;l++)c[l+1]=o.GetValue(l);a[s]=c,e.destroy(o)}decodeGeomData(e,t,r,s){let n,i,o;if(!0===this.getAttributeOptions("position").skipDequantization&&t.SkipAttributeTransform(e.POSITION),r===e.TRIANGULAR_MESH?(n=new e.Mesh,i=t.DecodeBufferToMesh(s,n)):(n=new e.PointCloud,i=t.DecodeBufferToPointCloud(s,n)),!i.ok()||0==n.ptr){let r="DracoGeomParser: Decoding failed: ";throw r+=i.error_msg(),e.destroy(t),e.destroy(n),new Error(r)}e.destroy(s),o=r==e.TRIANGULAR_MESH?n.num_faces():0;let d=t.GetAttributeId(n,e.POSITION);if(-1==d){let r="DracoGeomParser: No position attribute found.";throw e.destroy(t),e.destroy(n),new Error(r)}let u={};for(let a in this.attNSMap)if(void 0===this.attMap[a]){let r=t.GetAttributeId(n,e[this.attNSMap[a]]);if(-1!==r){this.verbosity;let s=t.GetAttribute(n,r);this.addAttributeToGeometry(e,t,n,a,s,u)}}for(let a in this.attMap){let r=this.attMap[a],s=t.GetAttributeByUniqueId(n,r);this.addAttributeToGeometry(e,t,n,a,s,u)}if(r==e.TRIANGULAR_MESH)if(this.drawMode===a){let t=new e.DracoInt32Array;u.indices=new Uint32Array(t.size());for(let e=0;e<t.size();++e)u.indices[e]=t.GetValue(e);e.destroy(t)}else{let r=3*o;u.indices=new Uint32Array(r);let s=new e.DracoInt32Array;for(let e=0;e<o;++e){t.GetFaceFromMesh(n,e,s);let r=3*e;u.indices[r]=s.GetValue(0),u.indices[r+1]=s.GetValue(1),u.indices[r+2]=s.GetValue(2)}e.destroy(s)}return r!=e.TRIANGULAR_MESH&&(u.indices=null),e.destroy(t),e.destroy(n),u}parseData(e,t,r,s){let n=this.parser,a=new n.DecoderBuffer,i=r-t;s<1?a.Init(new Int8Array(e.buffer).subarray(0,i),i):a.Init(new Int8Array(e.buffer).subarray(t,r),i);let o=new n.Decoder,d=o.GetEncodedGeometryType(a);if(d==n.TRIANGULAR_MESH)this.verbosity;else{if(d!=n.POINT_CLOUD){let e="DracoGeomParser: Unknown geometry type.";throw new Error(e)}this.verbosity}return this.decodeGeomData(n,o,d,a)}transformVS(e,t,r,s){let n=0,a=0,i=0,o=0,d=e*t[12],u=e*t[13],c=e*t[14];while(n+3<=s)a=r[n],i=r[n+1],o=r[n+2],r[n]=a*t[0]+i*t[4]+o*t[8]+d,r[n+1]=a*t[1]+i*t[5]+o*t[9]+u,r[n+2]=a*t[2]+i*t[6]+o*t[10]+c,n+=3}getParseData(e,t){let r=null;if(null!=e){r=[];let t=null;for(let s in e)null!=e[s]&&r.push(e[s].buffer);if(null!=t){let r,s,n,a=t[0],i=t[1],o=t[2],d=t[3],u=i,c=o,l=d;for(let e=1,f=t.length;e<f;e+=a)r=t[e],s=t[e+1],n=t[e+2],r<i?i=r:r>u&&(u=r),s<o?o=s:s>c&&(c=s),n<d?d=n:n>l&&(l=n);e.min={x:i,y:o,z:d},e.max={x:u,y:c,z:l}}}let s={vertices:e.position,uvsList:null,normals:null,indices:null};return void 0!=e.indices&&(s.indices=e.indices),void 0!=e.normal&&(s.normals=e.normal),void 0!=e.uv&&(s.uvsList=[e.uv]),{data:s,transfers:r,errorFlag:t}}receiveCall(e){let t=e.streams;this.drawMode=0,this.vsScale=1,this.attMap={},this.attOpts={position:{}};let r=0,s=null;if(null!=t){let a=e.descriptor;if(a.endI>a.beginI){let e=t[0];try{s=this.parseData(e,a.beginI,a.endI,a.status)}catch(n){r=-1,s=null}}}else r=-2;return this.getParseData(s,r)}}class o{constructor(){this.m_dataIndex=0,this.m_srcuid=0,this.m_dependencyFinish=!1,this.m_wasmData=null,this.m_currTaskClass=-1,this.threadIndex=0,this.parser=null,this.decoder={wasmBinary:null},this.dracoParser=new i,this.m_currTaskClass=ThreadCore.getCurrTaskClass(),ThreadCore.setCurrTaskClass(this.m_currTaskClass),ThreadCore.acquireData(this,{},n.THREAD_ACQUIRE_DATA),ThreadCore.useDependency(this),ThreadCore.resetCurrTaskClass()}postDataMessage(e,t){let r={cmd:e.cmd,taskCmd:e.taskCmd,threadIndex:this.threadIndex,taskclass:this.getTaskClass(),srcuid:this.m_srcuid,dataIndex:this.m_dataIndex,streams:e.streams,data:e.data};ThreadCore.postMessageToThread(r,t)}initDecoder(e){let t=e.streams[0];this.decoder["wasmBinary"]=t,this.decoder["onModuleLoaded"]=r=>{this.parser=r,this.dracoParser.parser=r,ThreadCore.transmitData(this,e,n.THREAD_TRANSMIT_DATA,[t]),ThreadCore.setCurrTaskClass(this.m_currTaskClass),ThreadCore.initializeExternModule(this),ThreadCore.resetCurrTaskClass()},DracoDecoderModule(this.decoder)}receiveData(e){switch(this.m_srcuid=e.srcuid,this.m_dataIndex=e.dataIndex,e.taskCmd){case n.PARSE:let t=this.dracoParser.receiveCall(e);e.data={model:t.data,errorFlag:t.errorFlag},this.postDataMessage(e,t.transfers);break;case n.THREAD_ACQUIRE_DATA:this.threadIndex=e.threadIndex,this.m_wasmData=e.data,this.m_dependencyFinish&&null!=this.m_wasmData&&this.initDecoder(this.m_wasmData);break;default:break}}getTaskClass(){return 102}getUniqueName(){return"dracoGeomParser"}dependencyFinish(){this.m_dependencyFinish=!0,this.m_dependencyFinish&&null!=this.m_wasmData&&this.initDecoder(this.m_wasmData)}}t.DracoGeomParseTask=o;new o},8875:function(e,t,r){var s,n,a;(function(r,i){n=[],s=i,a="function"===typeof s?s.apply(t,n):s,void 0===a||(e.exports=a)})("undefined"!==typeof self&&self,(function(){function e(){var t=Object.getOwnPropertyDescriptor(document,"currentScript");if(!t&&"currentScript"in document&&document.currentScript)return document.currentScript;if(t&&t.get!==e&&document.currentScript)return document.currentScript;try{throw new Error}catch(h){var r,s,n,a=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,i=/@([^@]*):(\d+):(\d+)\s*$/gi,o=a.exec(h.stack)||i.exec(h.stack),d=o&&o[1]||!1,u=o&&o[2]||!1,c=document.location.href.replace(document.location.hash,""),l=document.getElementsByTagName("script");d===c&&(r=document.documentElement.outerHTML,s=new RegExp("(?:[^\\n]+?\\n){0,"+(u-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),n=r.replace(s,"$1").trim());for(var f=0;f<l.length;f++){if("interactive"===l[f].readyState)return l[f];if(l[f].src===d)return l[f];if(d===c&&l[f].innerHTML&&l[f].innerHTML.trim()===n)return l[f]}return null}}return e}))},fae3:function(e,t,r){"use strict";r.r(t);r("1eb2");var s=r("56b4");for(var n in s)["default"].indexOf(n)<0&&function(e){r.d(t,e,(function(){return s[e]}))}(n)}})}));