(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["AppBase"]=e():t["AppBase"]=e()})("undefined"!==typeof self?self:this,(function(){return function(t){var e={};function s(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}return s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(i,a,function(e){return t[e]}.bind(null,a));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s="fae3")}({"030e":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{static Initialize(t,e){let s=this;1==t?(s.OES_standard_derivatives=e.getExtension("OES_standard_derivatives"),s.OES_standard_derivatives,s.EXT_shader_texture_lod=e.getExtension("EXT_shader_texture_lod"),s.EXT_shader_texture_lod,s.WEBGL_draw_buffers=e.getExtension("WEBGL_draw_buffers"),s.WEBGL_draw_buffers,s.OES_vertex_array_object=e.getExtension("OES_vertex_array_object"),s.OES_vertex_array_object,s.ANGLE_instanced_arrays=e.getExtension("ANGLE_instanced_arrays"),s.ANGLE_instanced_arrays,s.EXT_color_buffer_float=e.getExtension("EXT_color_buffer_float"),s.EXT_color_buffer_float,s.EXT_color_buffer_half_float=e.getExtension("EXT_color_buffer_half_float"),s.EXT_color_buffer_half_float,s.OES_texture_half_float=e.getExtension("OES_texture_half_float"),s.OES_texture_half_float,s.OES_texture_half_float_linear=e.getExtension("OES_texture_half_float_linear"),s.OES_texture_half_float_linear,s.OES_texture_float=e.getExtension("OES_texture_float"),s.OES_texture_float,s.OES_element_index_uint=e.getExtension("OES_element_index_uint"),s.OES_element_index_uint,s.EXT_blend_minmax=e.getExtension("EXT_blend_minmax"),s.EXT_blend_minmax):(s.EXT_shader_texture_lod=e.getExtension("EXT_shader_texture_lod"),s.EXT_shader_texture_lod,s.EXT_color_buffer_half_float=e.getExtension("EXT_color_buffer_half_float"),s.EXT_color_buffer_half_float,s.OES_texture_half_float_linear=e.getExtension("OES_texture_half_float_linear"),s.OES_texture_half_float_linear,s.EXT_color_buffer_float=e.getExtension("EXT_color_buffer_float"),s.EXT_color_buffer_float),s.OES_texture_float_linear=e.getExtension("OES_texture_float_linear"),s.OES_texture_float_linear,s.WEBGL_depth_texture=e.getExtension("WEBGL_depth_texture"),s.WEBGL_depth_texture,s.WEBGL_debug_renderer_info=e.getExtension("WEBGL_debug_renderer_info"),s.WEBGL_debug_renderer_info}}i.OES_standard_derivatives=null,i.EXT_shader_texture_lod=null,i.WEBGL_draw_buffers=null,i.OES_vertex_array_object=null,i.ANGLE_instanced_arrays=null,i.EXT_color_buffer_float=null,i.EXT_color_buffer_half_float=null,i.OES_texture_float_linear=null,i.OES_texture_half_float_linear=null,i.OES_texture_half_float=null,i.OES_texture_float=null,i.OES_element_index_uint=null,i.EXT_blend_minmax=null,i.WEBGL_depth_texture=null,i.WEBGL_debug_renderer_info=null,e.default=i},"070b":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(t,e,s,a){this.A=-1,this.B=!0,this.C=!0,this.D=!0,this.E=!0,this.A=i.BF++,this.B=t,this.C=e,this.D=s,this.E=a}getUid(){return this.A}getR(){return this.B}getG(){return this.C}getB(){return this.D}getA(){return this.E}use(){i.BA!=this.A&&(i.Rstate.setColorMask(this.B,this.C,this.D,this.E),i.BA=this.A)}static Create(t,e,s,a,r){if(i.BB.has(t)){let e=i.BB.get(t);return e.getUid()}let l=(e?64:32)|(s?16:8)|(a?4:2)|(r?1:0);if(i.BC.has(l)){let t=i.BC.get(l);l=t.getUid()}else{let n=new i(e,s,a,r);l=n.getUid(),i.BC.set(l,n),i.BB.set(t,n),i.BD.push(n),++i.BG}return l}static GetColorMaskByName(t){if(i.BB.has(t)){let e=i.BB.get(t);return e.getUid()}return-1}static UseRenderState(t){i.BE&&i.Rstate.roColorMask!=t&&t>-1&&t<i.BG&&i.BD[t].use()}static UseColorMaskByName(t){let e=i.GetColorMaskByName(t);i.BE&&i.Rstate.roColorMask!=e&&e>-1&&e<i.BG&&i.BD[e].use()}static Lock(){i.BE=!1}static Unlock(){i.BE=!0}static Reset(){i.BA=-1}}i.BF=0,i.BA=-1,i.BD=[],i.BG=1,i.BC=new Map,i.BB=new Map,i.BE=!0,i.ALL_TRUE_COLOR_MASK=0,i.ALL_FALSE_COLOR_MASK=1,i.Rstate=null,e.RenderColorMask=i},"0714":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(t=null){this.A=i.BF++,this.F=null,this.G=!1,this.H=new Map,this.I=[],this.J=null,this.K=null,this.L=null,this.M="",this.uuid="",this.K=t}getUid(){return this.A}addShaderCodeWithUUID(t,e){null!=this.K&&this.addShaderCode(this.K.getShaderCodeObjectWithUUID(t),e)}addShaderCode(t,e=!1){this.G=null!=t,(null==this.F||null!=t&&e)&&(this.F=t)}hasShaderCode(){return null!=this.F}addPipe(t){let e=t.getPipeTypes();for(let s=0;s<e.length;++s)this.H.has(e[s])||this.H.set(e[s],t)}getPipeByType(t){return this.H.get(t)}hasPipeByType(t){return this.H.has(t)}createKeys(t){if(this.I=[],null!=t){let e,s,i=t;for(let t=0;t<i.length;++t)s=i[t],this.H.has(s)&&(e=this.H.get(s),this.I.push(e.getPipeKey(s)))}}buildSharedUniforms(t){if(this.J=[],this.L=t,null!=t){let e,s,i=t;for(let t=0;t<i.length;++t)s=i[t],this.H.has(s)&&(e=this.H.get(s),e.resetPipe(),this.J.push(e.getGlobalUinform()))}}build(t){if(this.G&&null!=this.F&&t.addShaderObject(this.F),null!=this.L){let e,s,i=this.L;for(let a=0;a<i.length;++a)s=i[a],this.H.has(s)&&(e=this.H.get(s),e.useShaderPipe(t,s))}}getTextures(t,e,s){if(null!=s){let i,a,r=s;for(let s=0;s<r.length;++s)a=r[s],this.H.has(a)&&(i=this.H.get(a),i.getTextures(t,e,a))}}getSharedUniforms(){return this.J}getSelfUniformData(){return null}appendKeyString(t){this.M+=t}getKeys(){return this.I}getKeysString(){let t="";for(let e=0;e<this.I.length;++e)t+=this.I[e];return t+this.M}reset(){this.M="",this.G=!1}clear(){this.H=new Map,this.I=[],this.J=null,this.F=null,this.K=null,this.L=null}}i.BF=0,e.MaterialPipeline=i},"0929":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("6e01")),r=i(s("2139")),l=i(s("9156"));class n{constructor(){this.A=0,this.N=new Float32Array(16),this.O=!1,this.P=!1,this.updatedStatus=n.UPDATE_POSITION,this.updateStatus=n.UPDATE_TRANSFORM,this.Q=null,this.R=null,this.S=null,this.T=null,this.U=!0,this.V=null,this.A=n.BF++}getUid(){return this.A}getRotationFlag(){return this.P}getX(){return this.N[12]}getY(){return this.N[13]}getZ(){return this.N[14]}setX(t){this.updateStatus|=1,this.updatedStatus|=1,this.N[12]=t}setY(t){this.updateStatus|=1,this.updatedStatus|=1,this.N[13]=t}setZ(t){this.updateStatus|=1,this.updatedStatus|=1,this.N[14]=t}setXYZ(t,e,s){this.N[12]=t,this.N[13]=e,this.N[14]=s,this.updateStatus|=1,this.updatedStatus|=1}offsetPosition(t){this.N[12]+=t.x,this.N[13]+=t.y,this.N[14]+=t.z,this.updateStatus|=1,this.updatedStatus|=1}setPosition(t){this.N[12]=t.x,this.N[13]=t.y,this.N[14]=t.z,this.updateStatus|=1,this.updatedStatus|=1}getPosition(t){t.x=this.N[12],t.y=this.N[13],t.z=this.N[14]}copyPositionFrom(t){null!=t&&(this.N[12]=t.N[12],this.N[13]=t.N[13],this.N[14]=t.N[14],this.updateStatus|=n.UPDATE_POSITION,this.updatedStatus|=n.UPDATE_POSITION)}getRotationX(){return this.N[1]}getRotationY(){return this.N[6]}getRotationZ(){return this.N[9]}setRotationX(t){this.N[1]=t,this.P=!0,this.updateStatus|=n.UPDATE_ROTATION,this.updatedStatus|=n.UPDATE_ROTATION}setRotationY(t){this.N[6]=t,this.P=!0,this.updateStatus|=n.UPDATE_ROTATION,this.updatedStatus|=n.UPDATE_ROTATION}setRotationZ(t){this.N[9]=t,this.P=!0,this.updateStatus|=n.UPDATE_ROTATION,this.updatedStatus|=n.UPDATE_ROTATION}setRotationXYZ(t,e,s){this.N[1]=t,this.N[6]=e,this.N[9]=s,this.updateStatus|=n.UPDATE_ROTATION,this.updatedStatus|=n.UPDATE_ROTATION,this.P=!0}getScaleX(){return this.N[0]}getScaleY(){return this.N[5]}getScaleZ(){return this.N[10]}setScaleX(t){this.N[0]=t,this.updateStatus|=n.UPDATE_SCALE,this.updatedStatus|=n.UPDATE_SCALE}setScaleY(t){this.N[5]=t,this.updateStatus|=n.UPDATE_SCALE,this.updatedStatus|=n.UPDATE_SCALE}setScaleZ(t){this.N[10]=t,this.updateStatus|=n.UPDATE_SCALE,this.updatedStatus|=n.UPDATE_SCALE}setScaleXYZ(t,e,s){this.N[0]=t,this.N[5]=e,this.N[10]=s,this.updateStatus|=n.UPDATE_SCALE,this.updatedStatus|=n.UPDATE_SCALE}setScale(t){this.N[0]=t,this.N[5]=t,this.N[10]=t,this.updateStatus|=n.UPDATE_SCALE,this.updatedStatus|=n.UPDATE_SCALE}getRotationXYZ(t){t.x=this.N[1],t.y=this.N[6],t.z=this.N[9]}getScaleXYZ(t){t.x=this.N[0],t.y=this.N[5],t.z=this.N[10]}localToGlobal(t){this.getMatrix().transformVectorSelf(t)}globalToLocal(t){this.getInvMatrix().transformVectorSelf(t)}getInvMatrix(){return null!=this.V?this.O&&(this.V.copyFrom(this.Q),this.V.invert()):(this.V=r.default.GetMatrix(),this.V.copyFrom(this.Q),this.V.invert()),this.O=!1,this.V}getLocalMatrix(){return this.updateStatus>0&&this.update(),this.R}getMatrix(t=!0){return this.updateStatus>0&&t&&this.update(),this.Q}getToParentMatrix(){return null!=this.T?this.T:this.Q}setParentMatrix(t){this.S=t,this.O=!0,null!=this.S&&(this.R==this.Q?(this.updateStatus=n.UPDATE_TRANSFORM,this.updatedStatus=this.updateStatus,this.R=r.default.GetMatrix()):(this.updateStatus|=n.UPDATE_PARENT_MAT,this.updatedStatus=this.updateStatus))}updateMatrixData(t){null!=t&&(this.updateStatus=n.UPDATE_NONE,this.O=!0,this.Q.copyFrom(t))}__$setMatrix(t){null!=t&&(this.updateStatus=n.UPDATE_NONE,this.O=!0,this.R==this.Q&&(this.R=t),null!=this.Q&&(l.default.RemoveTransUniform(this.Q),r.default.RetrieveMatrix(this.Q)),this.Q=t)}destroy(){null!=this.V&&r.default.RetrieveMatrix(this.V),null!=this.R&&(this.Q==this.R&&l.default.RemoveTransUniform(this.Q),r.default.RetrieveMatrix(this.R)),null!=this.Q&&this.Q!=this.R&&(l.default.RemoveTransUniform(this.Q),r.default.RetrieveMatrix(this.Q)),this.V=null,this.R=null,this.Q=null,this.S=null,this.updateStatus=n.UPDATE_TRANSFORM}copyFrom(t){this.N.set(t.N,0),this.updatedStatus|=1,this.updateStatus|=n.UPDATE_TRANSFORM,this.P=t.P}update(){this.updateStatus>0&&(this.O=!0,this.updateStatus=this.updateStatus|this.updatedStatus,(this.updateStatus&n.UPDATE_TRANSFORM)>0&&(this.R.getLocalFS32().set(this.N,0),this.P&&this.R.setRotationEulerAngle(this.N[1]*a.default.MATH_PI_OVER_180,this.N[6]*a.default.MATH_PI_OVER_180,this.N[9]*a.default.MATH_PI_OVER_180),null!=this.S&&(this.updateStatus=this.updateStatus|n.UPDATE_PARENT_MAT)),this.Q!=this.R&&this.Q.copyFrom(this.R),(this.updateStatus&n.UPDATE_PARENT_MAT)==n.UPDATE_PARENT_MAT&&(null!=this.T||(this.T=r.default.GetMatrix()),this.T.copyFrom(this.Q),this.U=!0,this.Q.append(this.S)),this.updateStatus=n.UPDATE_NONE)}getMatrixFS32(){return this.getMatrix().getLocalFS32()}toString(){return"[ROTransform(uid = "+this.A+")]"}static GetFreeId(){return n.W.length>0?n.W.pop():-1}static Create(t=null){let e=null,s=n.GetFreeId();return s>=0?(e=n.X[s],n.Y[s]=n.BI):(e=new n,n.X.push(e),n.Y.push(n.BI),n.Z++),e.Q=null==t?r.default.GetMatrix():t,e.R=e.Q,e.N.set(n.BH,0),e}static Restore(t){if(null!=t&&n.Y[t.getUid()]==n.BI){let e=t.getUid();n.W.push(e),n.Y[e]=n.BS,t.destroy()}}}n.BF=0,n.BH=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),n.UPDATE_NONE=0,n.UPDATE_POSITION=1,n.UPDATE_ROTATION=2,n.UPDATE_SCALE=4,n.UPDATE_TRANSFORM=7,n.UPDATE_PARENT_MAT=8,n.BI=1,n.BS=0,n.Y=[],n.Z=0,n.X=[],n.W=[],e.default=n},"0fc4":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("9666")),r=i(s("faa5"));class l{constructor(){this.a="",this.b=null,this.c=null,this.J=null,this.d=null,this.e=null,this.f="",this.__$troMid=-1,this.__$uniform=null,this.pipeTypes=null,this.g=null,this.h=0,this.i=!1,this.j=0}setPolygonOffset(t,e=0){null==this.c?this.c=[t,e]:(this.c[0]=t,this.c[1]=e)}getPolygonOffset(){return this.c}setDepthOffset(t){}setMaterialPipeline(t){this.e=t}getMaterialPipeline(){return this.e}getShdUniqueName(){return this.a}getCodeBuf(){throw Error("Illgel operation !!!")}hasShaderData(){return null!=this.b&&(!this.b.haveTexture()||this.texDataEnabled())}initializeByRenderer(t=!1){this.initializeByCodeBuf(t)}initializeByCodeBuf(t=!1){if(t=t||this.getTextureTotal()>0,null==this.b){let e=this.getCodeBuf();if(null!=e){let s;e.reset(),e.pipeline=this.e,e.pipeTypes=this.pipeTypes,null!=e.pipeline&&e.pipeline.reset(),this.buildBuf();let i=this.f;if(""!=i&&(s=a.default.FindData(i),this.a=i),null==s?(t=t||this.getTextureTotal()>0,e.initialize(t),i=e.getUniqueShaderName()+e.keysString+e.getShaderCodeBuilder().getUniqueNSKeyString(),this.a=i,this.__$initShd(this.a),s=a.default.FindData(i),this.f=this.a):(t=t||this.getTextureTotal()>0,e.initialize(t)),null==s){e.buildShader(),e.buildDefine(),null!=e.pipeline&&(null!=e.getShaderCodeObject()?e.pipeline.addShaderCode(e.getShaderCodeObject(),!1):e.pipeline.addShaderCodeWithUUID(e.getShaderCodeObjectUUID(),!1),e.pipeline.build(e.getShaderCodeBuilder()));let t=e.getFragShaderCode(),l=e.getVertShaderCode();s=a.default.CreateShdData(i,l,t,e.adaptationShaderVersion,r.default.GetPreCompileInfo())}null!=this.e&&(this.J=this.e.getSharedUniforms()),this.b=s}}}buildBuf(){}__$initShd(t){}getShaderData(){return this.b}setTextureList(t){if(this.g!=t){this.i=!1,this.h=null!=t?t.length:0;let e=0;if(null!=this.g)for(;e<this.g.length;++e)this.g[e].__$detachThis();if(this.i=!0,this.g=t,null!=this.g){let t=31;for(e=0;e<this.g.length;++e)t=131*t+this.g[e].getUid(),this.g[e].__$attachThis(),this.g[e].isDataEnough()||(this.i=!1);this.__$troMid=t}}}setTextureAt(t,e){if(t>=0&&null!=e){let s=this.g,i=s.length;if(null!=s&&s[t]!=e&&t<i&&i>0){s=s.slice(0),s[t].__$detachThis(),s[t]=e,this.i=e.isDataEnough(),e.__$attachThis();let a=31;for(let t=0;t<i;++t)a=131*a+s[t].getUid();this.__$troMid=a,this.g=s}}}getTextureList(){return this.g}getTextureAt(t){return this.g[t]}getTextureTotal(){return this.h}getShdTexTotal(){return null!=this.b?this.b.getTexTotal():0}texDataEnabled(){if(null!=this.g){if(this.i)return!0;let t=!0,e=this.g;for(let s=0;s<this.h;++s)if(!e[s].isDataEnough()){t=!1;break}return this.i=t,t}return null!=this.b&&this.b.getTexTotal(),!1}createSharedUniforms(){return this.J}createSharedUniformsData(){return null}createSelfUniformData(){return this.d}updateSelfData(t){}hasTexture(){return this.b.haveTexture()}getBufSortFormat(){return null!=this.b?this.b.getLayoutBit():0}getBufTypeList(){return null!=this.b?this.b.getLocationTypes():null}getBufSizeList(){return null!=this.b?this.b.getAttriSizeList():null}__$attachThis(){++this.j}__$detachThis(){--this.j,this.j<1&&(this.j=0)}getAttachCount(){return this.j}destroy(){if(this.J=null,this.d=null,this.pipeTypes=null,this.getAttachCount()<1){if(null!=this.g)for(let t=0;t<this.g.length;++t)this.g[t].__$detachThis();this.b=null,this.g=null,this.i=!1,this.__$troMid=0,null!=this.__$uniform&&(this.__$uniform.destroy(),this.__$uniform=null)}}toString(){return"[MaterialBase()]"}}e.default=l},"11e6":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{static AddContainerFlag(t){return 2147483648|t}static RemoveContainerFlag(t){return-2147483649&t}static AddSpaceUid(t,e){return-1048576&t|e}static RemoveSpaceUid(t){return-1048576&t}static GetSpaceUid(t){return 1048575&t}static AddRendererUid(t,e){return-133169153&t|e<<20}static RemoveRendererUid(t){return 133169152|t}static GetRendererUid(t){return t=(133169152&t)>>20,t<127?t:-1}static TestRendererUid(t){return t=(133169152&t)>>20,t<127}static AddSortEnabled(t){return 1073741824|t}static RemoveSortEnabled(t){return-1073741825&t}static TestSortEnabled(t){return 1073741824==(1073741824&t)}static AddRendererLoad(t){return 805306368|t}static RemoveRendererLoad(t){return-805306369&t}static TestSpaceContains(t){return(1048575&t)>0}static TestSpaceEnabled(t){return(1048575&t)<1}static TestSpaceEnabled2(t){return(1048575&t)<1&&2147483648!=(2147483648&t)}static TestContainerEnabled(t){return 133169152==(133169152&t)&&2147483648!=(2147483648&t)}static TestRendererEnabled(t){return 133169152==(938475520&t)&&2147483648!=(2147483648&t)}}i.DEFAULT=133169152,i.CONTAINER_FLAG=2147483648,i.CONTAINER_NOT_FLAG=-2147483649,i.SPACE_FLAG=1048575,i.SPACE_NOT_FLAG=-1048576,i.RENDERER_UID_FLAG=133169152,i.RENDERER_UID_NOT_FLAG=-133169153,i.RENDERER_UID_INVALID=127,i.SORT_FLAG=1073741824,i.SORT_NOT_FLAG=-1073741825,i.RENDERER_LOAD_FLAG=805306368,i.RENDERER_LOAD_NOT_FLAG=-805306369,i.RENDERER_ADN_LOAD_FLAG=938475520,e.default=i},"12e2":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},"18c7":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("6e01")),r=i(s("8e17")),l=i(s("abdb"));class n{constructor(t=null,e=0){this.A=-1,this.k=0,this.N=null,this.l=null,this.k=e,null!=t?(this.A=n.BF++,this.N=t,this.l=this.N.subarray(e,e+16)):(this.A=n.BL++,this.N=new Float32Array(16),this.N.set(n.BK,0),this.l=this.N)}setData(t){16==t.length&&this.l.set(t)}getCapacity(){return 16}GetMaxUid(){return n.BF}getUid(){return this.A}getLocalFS32(){return this.l}getFS32(){return this.N}getFSIndex(){return this.k}identity(){this.l.set(n.BK,0)}determinant(){return(this.l[0]*this.l[5]-this.l[4]*this.l[1])*(this.l[10]*this.l[15]-this.l[14]*this.l[11])-(this.l[0]*this.l[9]-this.l[8]*this.l[1])*(this.l[6]*this.l[15]-this.l[14]*this.l[7])+(this.l[0]*this.l[13]-this.l[12]*this.l[1])*(this.l[6]*this.l[11]-this.l[10]*this.l[7])+(this.l[4]*this.l[9]-this.l[8]*this.l[5])*(this.l[2]*this.l[15]-this.l[14]*this.l[3])-(this.l[4]*this.l[13]-this.l[12]*this.l[5])*(this.l[2]*this.l[11]-this.l[10]*this.l[3])+(this.l[8]*this.l[13]-this.l[12]*this.l[9])*(this.l[2]*this.l[7]-this.l[6]*this.l[3])}append(t){let e=t.getLocalFS32(),s=this.l,i=s[0],a=s[4],r=s[8],l=s[12],n=s[1],_=s[5],h=s[9],o=s[13],u=s[2],m=s[6],d=s[10],c=s[14],f=s[3],p=s[7],S=s[11],g=s[15],M=e[0],E=e[4],T=e[8],y=e[12],A=e[1],b=e[5],x=e[9],v=e[13],L=e[2],F=e[6],R=e[10],N=e[14],D=e[3],B=e[7],P=e[11],C=e[15];s[0]=i*M+n*E+u*T+f*y,s[1]=i*A+n*b+u*x+f*v,s[2]=i*L+n*F+u*R+f*N,s[3]=i*D+n*B+u*P+f*C,s[4]=a*M+_*E+m*T+p*y,s[5]=a*A+_*b+m*x+p*v,s[6]=a*L+_*F+m*R+p*N,s[7]=a*D+_*B+m*P+p*C,s[8]=r*M+h*E+d*T+S*y,s[9]=r*A+h*b+d*x+S*v,s[10]=r*L+h*F+d*R+S*N,s[11]=r*D+h*B+d*P+S*C,s[12]=l*M+o*E+c*T+g*y,s[13]=l*A+o*b+c*x+g*v,s[14]=l*L+o*F+c*R+g*N,s[15]=l*D+o*B+c*P+g*C}append3x3(t){let e=t.getLocalFS32(),s=this.l,i=s[0],a=s[4],r=s[8],l=s[1],n=s[5],_=s[9],h=s[2],o=s[6],u=s[10],m=e[0],d=e[4],c=e[8],f=e[1],p=e[5],S=e[9],g=e[2],M=e[6],E=e[10];s[0]=i*m+l*d+h*c,s[1]=i*f+l*p+h*S,s[2]=i*g+l*M+h*E,s[4]=a*m+n*d+o*c,s[5]=a*f+n*p+o*S,s[6]=a*g+n*M+o*E,s[8]=r*m+_*d+u*c,s[9]=r*f+_*p+u*S,s[10]=r*g+_*M+u*E}appendRotationPivot(t,e,s=null){null==s&&(s=r.default.Z_AXIS),n.BJ.identity(),n.BJ.getAxisRotation(e.x,e.y,e.z,t),n.BJ.appendTranslationXYZ(s.x,s.y,s.z),this.append(n.BJ)}appendRotation(t,e){n.BJ.identity(),n.BJ.getAxisRotation(e.x,e.y,e.z,t),this.append(n.BJ)}appendRotationX(t){n.BJ.rotationX(t),this.append3x3(n.BJ)}appendRotationY(t){n.BJ.rotationY(t),this.append3x3(n.BJ)}appendRotationZ(t){n.BJ.rotationZ(t),this.append3x3(n.BJ)}appendRotationEulerAngle(t,e,s){n.BJ.rotationY(e),this.append3x3(n.BJ),n.BJ.rotationX(t),this.append3x3(n.BJ),n.BJ.rotationZ(s),this.append3x3(n.BJ)}setScaleXYZ(t,e,s){let i=this.l;i[0]=t,i[5]=e,i[10]=s}setRotationEulerAngle(t,e,s){let i=this.l,a=Math.cos(t),r=Math.sin(t),l=Math.cos(e),n=Math.sin(e),_=Math.cos(s),h=Math.sin(s),o=_*n,u=h*n,m=l*i[0],d=r*i[5],c=a*i[5],f=a*i[10],p=r*i[10];i[1]=h*m,i[2]=-n*i[0],i[0]=_*m,i[4]=o*d-h*c,i[8]=o*f+h*p,i[5]=u*d+_*c,i[9]=u*f-_*p,i[6]=l*d,i[10]=l*f}setRotationEulerAngle2(t,e,s,i,a,r){let l=this.l,n=a*i,_=r*i,h=s*l[0],o=e*l[5],u=t*l[5],m=t*l[10],d=e*l[10];l[1]=r*h,l[2]=-i*l[0],l[0]=a*h,l[4]=n*o-r*u,l[8]=n*m+r*d,l[5]=_*o+a*u,l[9]=_*m-a*d,l[6]=s*o,l[10]=s*m}setTranslationXYZ(t,e,s){this.l[12]=t,this.l[13]=e,this.l[14]=s}setTranslation(t){this.l[12]=t.x,this.l[13]=t.y,this.l[14]=t.z}appendScaleXYZ(t,e,s){let i=this.l;i[0]*=t,i[1]*=t,i[2]*=t,i[3]*=t,i[4]*=e,i[5]*=e,i[6]*=e,i[7]*=e,i[8]*=s,i[9]*=s,i[10]*=s,i[11]*=s}appendScaleXY(t,e){this.l[0]*=t,this.l[1]*=t,this.l[2]*=t,this.l[3]*=t,this.l[4]*=e,this.l[5]*=e,this.l[6]*=e,this.l[7]*=e}appendTranslationXYZ(t,e,s){this.l[12]+=t,this.l[13]+=e,this.l[14]+=s}appendTranslation(t){this.l[12]+=t.x,this.l[13]+=t.y,this.l[14]+=t.z}copyColumnFrom(t,e){switch(t){case 0:this.l[0]=e.x,this.l[1]=e.y,this.l[2]=e.z,this.l[3]=e.w;break;case 1:this.l[4]=e.x,this.l[5]=e.y,this.l[6]=e.z,this.l[7]=e.w;break;case 2:this.l[8]=e.x,this.l[9]=e.y,this.l[10]=e.z,this.l[11]=e.w;break;case 3:this.l[12]=e.x,this.l[13]=e.y,this.l[14]=e.z,this.l[15]=e.w;break;default:break}}copyColumnTo(t,e){t<<=2,e.x=this.l[t],e.y=this.l[1+t],e.z=this.l[2+t],e.w=this.l[3+t]}setF32ArrAndIndex(t,e=0){null!=t&&e>=0&&(this.N=t,this.k=e,this.l=this.N.subarray(e,e+16))}setF32ArrIndex(t=0){t>=0&&(this.k=t,this.l=this.N.subarray(t,t+16))}setF32Arr(t){null!=t&&(this.N=t)}copyFromF32Arr(t,e=0){let s=0;for(let i=e+16;e<i;e++)this.l[s]=t[e],++s}copyToF32Arr(t,e=0){t.set(this.l,e)}copyFrom(t){this.l.set(t.l,0)}copyTo(t){t.l.set(this.l,0)}copyRawDataFrom(t,e=16,s=0,i=!1){i&&this.transpose(),e-=s;let a=0;while(a<e)this.N[this.k+a]=t[a+s],++a;i&&this.transpose()}copyRawDataTo(t,e=16,s=0,i=!1){i&&this.transpose();let a=0;while(a<e)t[a+s]=this.N[this.k+a],++a;i&&this.transpose()}copyRowFrom(t,e){switch(t){case 0:this.l[0]=e.x,this.l[4]=e.y,this.l[8]=e.z,this.l[12]=e.w;break;case 1:this.l[1]=e.x,this.l[5]=e.y,this.l[9]=e.z,this.l[13]=e.w;break;case 2:this.l[2]=e.x,this.l[6]=e.y,this.l[10]=e.z,this.l[14]=e.w;break;case 3:this.l[3]=e.x,this.l[7]=e.y,this.l[11]=e.z,this.l[15]=e.w;break;default:break}}copyRowTo(t,e){e.x=this.l[t],e.y=this.l[4+t],e.z=this.l[8+t],e.w=this.l[12+t]}decompose(t){let e=[],s=n.BJ,i=s.getFS32();s.copyFrom(this);let _=new r.default(i[12],i[13],i[14]),h=new r.default;h.x=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]),h.y=Math.sqrt(i[4]*i[4]+i[5]*i[5]+i[6]*i[6]),h.z=Math.sqrt(i[8]*i[8]+i[9]*i[9]+i[10]*i[10]),i[0]*(i[5]*i[10]-i[6]*i[9])-i[1]*(i[4]*i[10]-i[6]*i[8])+i[2]*(i[4]*i[9]-i[5]*i[8])<0&&(h.z=-h.z),i[0]/=h.x,i[1]/=h.x,i[2]/=h.x,i[4]/=h.y,i[5]/=h.y,i[6]/=h.y,i[8]/=h.z,i[9]/=h.z,i[10]/=h.z;let o=new r.default;switch(t){case l.default.AXIS_ANGLE:{o.w=a.default.SafeACos((i[0]+i[5]+i[10]-1)/2);let t=Math.sqrt((i[6]-i[9])*(i[6]-i[9])+(i[8]-i[2])*(i[8]-i[2])+(i[1]-i[4])*(i[1]-i[4]));t>a.default.MATH_MIN_POSITIVE?(o.x=(i[6]-i[9])/t,o.y=(i[8]-i[2])/t,o.z=(i[1]-i[4])/t):o.x=o.y=o.z=0}break;case l.default.QUATERNION:{let t=i[0]+i[5]+i[10];t>0?(o.w=Math.sqrt(1+t)/2,o.x=(i[6]-i[9])/(4*o.w),o.y=(i[8]-i[2])/(4*o.w),o.z=(i[1]-i[4])/(4*o.w)):i[0]>i[5]&&i[0]>i[10]?(o.x=Math.sqrt(1+i[0]-i[5]-i[10])/2,o.w=(i[6]-i[9])/(4*o.x),o.y=(i[1]+i[4])/(4*o.x),o.z=(i[8]+i[2])/(4*o.x)):i[5]>i[10]?(o.y=Math.sqrt(1+i[5]-i[0]-i[10])/2,o.x=(i[1]+i[4])/(4*o.y),o.w=(i[8]-i[2])/(4*o.y),o.z=(i[6]+i[9])/(4*o.y)):(o.z=Math.sqrt(1+i[10]-i[0]-i[5])/2,o.x=(i[8]+i[2])/(4*o.z),o.y=(i[6]+i[9])/(4*o.z),o.w=(i[1]-i[4])/(4*o.z))}break;case l.default.EULER_ANGLES:o.y=Math.asin(-i[2]),1!=i[2]&&-1!=i[2]?(o.x=Math.atan2(i[6],i[10]),o.z=Math.atan2(i[1],i[0])):(o.z=0,o.x=Math.atan2(i[4],i[5]));break;default:break}return e.push(_),e.push(o),e.push(h),s=null,e}invert(){let t=this.determinant(),e=Math.abs(t)>a.default.MATH_MIN_POSITIVE;if(e){let e=this.l;t=1/t;let s=e[0],i=e[4],a=e[8],r=e[12],l=e[1],n=e[5],_=e[9],h=e[13],o=e[2],u=e[6],m=e[10],d=e[14],c=e[3],f=e[7],p=e[11],S=e[15];e[0]=t*(n*(m*S-d*p)-_*(u*S-d*f)+h*(u*p-m*f)),e[1]=-t*(l*(m*S-d*p)-_*(o*S-d*c)+h*(o*p-m*c)),e[2]=t*(l*(u*S-d*f)-n*(o*S-d*c)+h*(o*f-u*c)),e[3]=-t*(l*(u*p-m*f)-n*(o*p-m*c)+_*(o*f-u*c)),e[4]=-t*(i*(m*S-d*p)-a*(u*S-d*f)+r*(u*p-m*f)),e[5]=t*(s*(m*S-d*p)-a*(o*S-d*c)+r*(o*p-m*c)),e[6]=-t*(s*(u*S-d*f)-i*(o*S-d*c)+r*(o*f-u*c)),e[7]=t*(s*(u*p-m*f)-i*(o*p-m*c)+a*(o*f-u*c)),e[8]=t*(i*(_*S-h*p)-a*(n*S-h*f)+r*(n*p-_*f)),e[9]=-t*(s*(_*S-h*p)-a*(l*S-h*c)+r*(l*p-_*c)),e[10]=t*(s*(n*S-h*f)-i*(l*S-h*c)+r*(l*f-n*c)),e[11]=-t*(s*(n*p-_*f)-i*(l*p-_*c)+a*(l*f-n*c)),e[12]=-t*(i*(_*d-h*m)-a*(n*d-h*u)+r*(n*m-_*u)),e[13]=t*(s*(_*d-h*m)-a*(l*d-h*o)+r*(l*m-_*o)),e[14]=-t*(s*(n*d-h*u)-i*(l*d-h*o)+r*(l*u-n*o)),e[15]=t*(s*(n*m-_*u)-i*(l*m-_*o)+a*(l*u-n*o))}return e}pointAt(t,e,s){null!=e&&void 0!=e||(e=new r.default(0,0,-1)),null!=s&&void 0!=s||(s=new r.default(0,-1,0));let i=e.subtract(t),l=new r.default(s.x,s.y,s.z);i.normalize(),l.normalize();let n=new r.default(i.x,i.y,i.z);n.scaleBy(l.dot(i)),l.subtractBy(n),l.getLength()>a.default.MATH_MIN_POSITIVE?l.normalize():0!=i.x?l.setTo(-i.y,i.x,0):l.setTo(1,0,0);let _=l.crossProduct(i);_.normalize();let h=this.l;h[0]=_.x,h[4]=_.y,h[8]=_.z,h[12]=0,h[1]=l.x,h[5]=l.y,h[9]=l.z,h[13]=0,h[2]=i.x,h[6]=i.y,h[10]=i.z,h[14]=0,h[3]=t.x,h[7]=t.y,h[11]=t.z,h[15]=1}prepend(t){let e=t.getLocalFS32(),s=this.l,i=e[0],a=e[4],r=e[8],l=e[12],n=e[1],_=e[5],h=e[9],o=e[13],u=e[2],m=e[6],d=e[10],c=e[14],f=e[3],p=e[7],S=e[11],g=e[15],M=s[0],E=s[4],T=s[8],y=s[12],A=s[1],b=s[5],x=s[9],v=s[13],L=s[2],F=s[6],R=s[10],N=s[14],D=s[3],B=s[7],P=s[11],C=s[15];s[0]=i*M+n*E+u*T+f*y,s[1]=i*A+n*b+u*x+f*v,s[2]=i*L+n*F+u*R+f*N,s[3]=i*D+n*B+u*P+f*C,s[4]=a*M+_*E+m*T+p*y,s[5]=a*A+_*b+m*x+p*v,s[6]=a*L+_*F+m*R+p*N,s[7]=a*D+_*B+m*P+p*C,s[8]=r*M+h*E+d*T+S*y,s[9]=r*A+h*b+d*x+S*v,s[10]=r*L+h*F+d*R+S*N,s[11]=r*D+h*B+d*P+S*C,s[12]=l*M+o*E+c*T+g*y,s[13]=l*A+o*b+c*x+g*v,s[14]=l*L+o*F+c*R+g*N,s[15]=l*D+o*B+c*P+g*C}prepend3x3(t){let e=t.getLocalFS32(),s=this.l,i=e[0],a=e[4],r=e[8],l=e[1],n=e[5],_=e[9],h=e[2],o=e[6],u=e[10],m=s[0],d=s[4],c=s[8],f=s[1],p=s[5],S=s[9],g=s[2],M=s[6],E=s[10];s[0]=i*m+l*d+h*c,s[1]=i*f+l*p+h*S,s[2]=i*g+l*M+h*E,s[4]=a*m+n*d+o*c,s[5]=a*f+n*p+o*S,s[6]=a*g+n*M+o*E,s[8]=r*m+_*d+u*c,s[9]=r*f+_*p+u*S,s[10]=r*g+_*M+u*E}prependRotationPivot(t,e,s){n.BJ.identity(),n.BJ.getAxisRotation(e.x,e.y,e.z,t),n.BJ.appendTranslationXYZ(s.x,s.y,s.z),this.prepend(n.BJ)}prependRotation(t,e){n.BJ.identity(),n.BJ.getAxisRotation(e.x,e.y,e.z,t),this.prepend(n.BJ)}prependRotationX(t){n.BJ.rotationX(t),this.prepend3x3(n.BJ)}prependRotationY(t){n.BJ.rotationY(t),this.prepend3x3(n.BJ)}prependRotationZ(t){n.BJ.rotationZ(t),this.prepend3x3(n.BJ)}prependRotationEulerAngle(t,e,s){n.BJ.rotationY(e),this.prepend3x3(n.BJ),n.BJ.rotationX(t),this.prepend3x3(n.BJ),n.BJ.rotationZ(s),this.prepend3x3(n.BJ)}prependScale(t,e,s){let i=this.l;i[0]*=t,i[1]*=e,i[2]*=s,i[4]*=t,i[5]*=e,i[6]*=s,i[8]*=t,i[9]*=e,i[10]*=s,i[12]*=t,i[13]*=e,i[14]*=s}prependScaleXY(t,e){this.l[0]*=t,this.l[1]*=e,this.l[4]*=t,this.l[5]*=e,this.l[8]*=t,this.l[9]*=e,this.l[12]*=t,this.l[13]*=e}prependTranslationXYZ(t,e,s){n.BJ.identity(),this.prepend(n.BJ)}prependTranslation(t){n.BJ.identity(),this.prepend(n.BJ)}recompose(t,e){if(t.length<3||0==t[2].x||0==t[2].y||0==t[2].z)return!1;this.identity();let s=n.BJ.getFS32();s[0]=s[1]=s[2]=t[2].x,s[4]=s[5]=s[6]=t[2].y,s[8]=s[9]=s[10]=t[2].z;let i=this.l;switch(e){case l.default.EULER_ANGLES:{let e=Math.cos(t[1].x),a=Math.cos(t[1].y),r=Math.cos(t[1].z),l=Math.sin(t[1].x),n=Math.sin(t[1].y),_=Math.sin(t[1].z);i[0]=a*r*s[0],i[1]=a*_*s[1],i[2]=-n*s[2],i[3]=0,i[4]=(l*n*r-e*_)*s[4],i[5]=(l*n*_+e*r)*s[5],i[6]=l*a*s[6],i[7]=0,i[8]=(e*n*r+l*_)*s[8],i[9]=(e*n*_-l*r)*s[9],i[10]=e*a*s[10],i[11]=0,i[12]=t[0].x,i[13]=t[0].y,i[14]=t[0].z,i[15]=1}break;default:{let a=t[1].x,r=t[1].y,n=t[1].z,_=t[1].w;if(e==l.default.AXIS_ANGLE){let t=.5*_;a*=Math.sin(t),r*=Math.sin(t),n*=Math.sin(t),_=Math.cos(t)}i[0]=(1-2*r*r-2*n*n)*s[0],i[1]=(2*a*r+2*_*n)*s[1],i[2]=(2*a*n-2*_*r)*s[2],i[3]=0,i[4]=(2*a*r-2*_*n)*s[4],i[5]=(1-2*a*a-2*n*n)*s[5],i[6]=(2*r*n+2*_*a)*s[6],i[7]=0,i[8]=(2*a*n+2*_*r)*s[8],i[9]=(2*r*n-2*_*a)*s[9],i[10]=(1-2*a*a-2*r*r)*s[10],i[11]=0,i[12]=t[0].x,i[13]=t[0].y,i[14]=t[0].z,i[15]=1}break}return 0==t[2].x&&(this.l[0]=0),0==t[2].y&&(this.l[5]=0),0==t[2].z&&(this.l[10]=0),s=null,!0}setThreeAxes(t,e,s){let i=this.l;i[0]=t.x,i[1]=t.y,i[2]=t.z,i[4]=e.x,i[5]=e.y,i[6]=e.z,i[8]=s.x,i[9]=s.y,i[10]=s.z}deltaTransformVector(t){let e=t.x,s=t.y,i=t.z;return new r.default(e*this.l[0]+s*this.l[4]+i*this.l[8],e*this.l[1]+s*this.l[5]+i*this.l[9],e*this.l[2]+s*this.l[6]+i*this.l[10],0)}deltaTransformVectorSelf(t){let e=this.l,s=t.x,i=t.y,a=t.z;t.x=s*e[0]+i*e[4]+a*e[8],t.y=s*e[1]+i*e[5]+a*e[9],t.z=s*e[2]+i*e[6]+a*e[10]}deltaTransformOutVector(t,e){let s=this.l;e.x=t.x*s[0]+t.y*s[4]+t.z*s[8],e.y=t.x*s[1]+t.y*s[5]+t.z*s[9],e.z=t.x*s[2]+t.y*s[6]+t.z*s[10]}transformVector(t){let e=this.l,s=t.x,i=t.y,a=t.z;return new r.default(s*e[0]+i*e[4]+a*e[8]+e[12],s*e[1]+i*e[5]+a*e[9]+e[13],s*e[2]+i*e[6]+a*e[10]+e[14],s*e[3]+i*e[7]+a*e[11]+e[15])}transformOutVector(t,e){let s=t.x,i=t.y,a=t.z,r=this.l;e.setTo(s*r[0]+i*r[4]+a*r[8]+r[12],s*r[1]+i*r[5]+a*r[9]+r[13],s*r[2]+i*r[6]+a*r[10]+r[14],s*r[3]+i*r[7]+a*r[11]+r[15])}transformOutVector3(t,e){let s=this.l;e.x=t.x*s[0]+t.y*s[4]+t.z*s[8]+s[12],e.y=t.x*s[1]+t.y*s[5]+t.z*s[9]+s[13],e.z=t.x*s[2]+t.y*s[6]+t.z*s[10]+s[14]}transformVector3Self(t){let e=t.x,s=t.y,i=t.z,a=this.l;t.x=e*a[0]+s*a[4]+i*a[8]+a[12],t.y=e*a[1]+s*a[5]+i*a[9]+a[13],t.z=e*a[2]+s*a[6]+i*a[10]+a[14]}transformVectorSelf(t){let e=t.x,s=t.y,i=t.z,a=this.l;t.setTo(e*a[0]+s*a[4]+i*a[8]+a[12],e*a[1]+s*a[5]+i*a[9]+a[13],e*a[2]+s*a[6]+i*a[10]+a[14],e*a[3]+s*a[7]+i*a[11]+a[15])}transformVectors(t,e,s){let i,a,r,l=0,n=this.l;e-=3;while(l<=e)i=t[l],a=t[l+1],r=t[l+2],s[l]=i*n[0]+a*n[4]+r*n[8]+n[12],s[l+1]=i*n[1]+a*n[5]+r*n[9]+n[13],s[l+2]=i*n[2]+a*n[6]+r*n[10]+n[14],l+=3}transformVectorsSelf(t,e){let s,i,a,r=0,l=this.l;e-=3;while(r<=e)s=t[r],i=t[r+1],a=t[r+2],t[r]=s*l[0]+i*l[4]+a*l[8]+l[12],t[r+1]=s*l[1]+i*l[5]+a*l[9]+l[13],t[r+2]=s*l[2]+i*l[6]+a*l[10]+l[14],r+=3}transformVectorsRangeSelf(t,e,s){let i,a,r,l=e,n=this.l;s-=3;while(l<=s)i=t[l],a=t[l+1],r=t[l+2],t[l]=i*n[0]+a*n[4]+r*n[8]+n[12],t[l+1]=i*n[1]+a*n[5]+r*n[9]+n[13],t[l+2]=i*n[2]+a*n[6]+r*n[10]+n[14],l+=3}transpose(){n.BJ.copyFrom(this);let t=n.BJ.getFS32(),e=this.l;e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11]}interpolateTo(t,e){let s=t.getFS32(),i=t.getFSIndex(),a=0,r=this.k;while(a<16)this.N[r]+=(s[i+a]-this.N[r])*e,++r,++a}getAxisRotation(t,e,s,i){i=-i;let a=this.l,r=Math.sin(i),l=Math.cos(i),n=1-l;a[0]=l+t*t*n,a[5]=l+e*e*n,a[10]=l+s*s*n;let _=t*e*n,h=s*r;a[4]=_+h,a[1]=_-h,_=t*s*n,h=e*r,a[8]=_-h,a[2]=_+h,_=e*s*n,h=t*r,a[9]=_+h,a[6]=_-h}rotationX(t){let e=Math.sin(t),s=Math.cos(t);this.l[0]=1,this.l[1]=0,this.l[2]=0,this.l[4]=0,this.l[5]=s,this.l[6]=e,this.l[8]=0,this.l[9]=-e,this.l[10]=s}rotationY(t){let e=Math.sin(t),s=Math.cos(t);this.l[0]=s,this.l[1]=0,this.l[2]=-e,this.l[4]=0,this.l[5]=1,this.l[6]=0,this.l[8]=e,this.l[9]=0,this.l[10]=s}rotationZ(t){let e=Math.sin(t),s=Math.cos(t);this.l[0]=s,this.l[1]=e,this.l[2]=0,this.l[4]=-e,this.l[5]=s,this.l[6]=0,this.l[8]=0,this.l[9]=0,this.l[10]=1}toString(){let t="\n"+this.l[0]+","+this.l[1]+","+this.l[2]+","+this.l[3]+"\n";return t+=this.l[4]+","+this.l[5]+","+this.l[6]+","+this.l[7]+"\n",t+=this.l[8]+","+this.l[9]+","+this.l[10]+","+this.l[11]+"\n",t+=this.l[12]+","+this.l[13]+","+this.l[14]+","+this.l[15]+"\n",t}transformPerspV4Self(t){t.w=t.z,t.x*=this.l[0],t.y*=this.l[5],t.z*=this.l[10],t.z+=this.l[14],t.w*=this.l[11],t.w+=this.l[15]}perspectiveRH(t,e,s,i){let a=Math.tan(.5*t);this.identity(),this.l[0]=1/(e*a),this.l[5]=1/a,this.l[10]=-(i+s)/(i-s),this.l[11]=-1,this.l[14]=-2*i*s/(i-s)}perspectiveRH2(t,e,s,i,a){let r=e/Math.tan(.5*t),l=r/e,n=r/s,_=-a/(a-i),h=-i*_;this.identity(),this.l[0]=l,this.l[5]=n,this.l[10]=_,this.l[11]=-1,this.l[14]=h}orthoRH(t,e,s,i,a,r){this.identity(),this.l[0]=2/(i-s),this.l[5]=2/(e-t),this.l[10]=-2/(r-a),this.l[12]=-(i+s)/(i-s),this.l[13]=-(e+t)/(e-t),this.l[14]=-(r+a)/(r-a),this.l[15]=1}perspectiveLH(t,e,s,i){let a=Math.tan(.5*t);this.identity(),this.l[0]=1/(e*a),this.l[5]=1/a,this.l[10]=(i+s)/(i-s),this.l[11]=1,this.l[14]=2*i*s/(i-s)}orthoLH(t,e,s,i,a,r){this.identity(),this.l[0]=2/(i-s),this.l[5]=2/(e-t),this.l[10]=2/(r-a),this.l[12]=-(i+s)/(i-s),this.l[13]=-(e+t)/(e-t),this.l[14]=-(r+a)/(r-a),this.l[15]=1}lookAtRH(t,e,s){this.identity();let i=e.subtract(t);i.normalize();let a=i.crossProduct(s);a.normalize();let r=a.crossProduct(i);a.w=-a.dot(t),r.w=-r.dot(t),i.w=i.dot(t),i.negate(),this.copyRowFrom(0,a),this.copyRowFrom(1,r),this.copyRowFrom(2,i)}lookAtLH(t,e,s){this.identity();let i=e.subtract(t);i.normalize();let a=i.crossProduct(s);a.normalize();let r=a.crossProduct(i);a.w=-a.dot(t),r.w=-r.dot(t),i.w=-i.dot(t),this.copyRowFrom(0,a),this.copyRowFrom(1,r),this.copyRowFrom(2,i)}destroy(){this.l=null,this.N=null,this.k=-1}}n.BK=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),n.BF=0,n.BL=327679,n.BJ=new n,e.default=n},"1b95":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s("0714"),a=s("ee6e"),r=s("6c6b");class l{constructor(){this.m=!0}initialize(){this.m&&(this.m=!1)}createMaterial(t){let e=new r.Material;return e.setDecorator(t),e}createSimpleMaterial(t){let e=new a.SimpleMaterial;return e.setDecorator(t),e}createMaterialPipeline(t){return new i.MaterialPipeline(t)}}e.RenderableMaterialBlock=l},"1eb2":function(t,e,s){"use strict";if("undefined"!==typeof window){var i=window.document.currentScript,a=s("8875");i=a(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:a});var r=i&&i.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(s.p=r[1])}},2139:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("18c7"));class r{static GetMatTotal(){return r.BO}static GetFS32Arr(){return r.BM}static SetFS32Arr(t){r.BM=t;let e=r.BO,s=r.BN;for(let i=0;i<e;++i)s[i].setF32Arr(t)}static GetFreeId(){return r.W.length>0?r.W.pop():-1}static Allocate(t){if(t<1024&&(t=1024),r.BO<1){r.BO=t,r.BM=new Float32Array(16*t);let e=0,s=new a.default(r.BM,16*e),i=s.getUid();for(r.BP=i,r.BQ=i+t;e<i;++e)r.BN.push(null),r.BR.push(r.BS);for(r.BN.push(s),r.BR.push(r.BS),r.W.push(s.getUid()),e=1;e<t;++e)s=new a.default(r.BM,16*e),r.BN.push(s),r.BR.push(r.BS),r.W.push(s.getUid())}}static GetMatrix(){let t=null,e=r.GetFreeId()-r.BP;return e>=0?(t=r.BN[e],t.identity(),r.BR[e]=r.BI):t=new a.default,t}static RetrieveMatrix(t){if(null!=t){let e=t.getUid();e>=r.BP&&e<r.BQ&&r.BR[e-r.BP]==r.BI&&(r.W.push(e),r.BR[e-r.BP]=r.BS)}}}r.BI=1,r.BS=0,r.BN=[],r.BR=[],r.W=[],r.BM=null,r.BP=0,r.BQ=0,r.BO=0,e.default=r},"251a":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("402a")),r=i(s("8e17")),l=i(s("3bfb")),n=i(s("76b0")),_=s("d08b"),h=i(s("519e"));class o{constructor(){this.m=!0,this.screenPlane=new a.default,this.unitXOYPlane=new a.default,this.unitXOZPlane=new a.default,this.unitBox=new a.default}initialize(){if(this.m){this.m=!1;let t=new _.VtxBufRenderData,e=new n.default;e.axisFlag=0,e.setVtxBufRenderData(t),e.initialize(-1,-1,2,2),this.screenPlane.setMesh(e),e=new n.default,e.axisFlag=0,e.setVtxBufRenderData(t),e.initialize(-.5,-.5,1,1),this.unitXOYPlane.setMesh(e),e=new n.default,e.axisFlag=1,e.setVtxBufRenderData(t),e.initialize(-.5,-.5,1,1),this.unitXOZPlane.setMesh(e);let s=new l.default;s.setVtxBufRenderData(t),s.initialize(new r.default(-.5,-.5,-.5),new r.default(.5,.5,.5)),this.unitBox.setMesh(s)}}createEntity(){return new a.default}createMesh(){return new h.default}}e.RenderableEntityBlock=o},"28a9":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s("f3a2"),a=s("69ed");class r{constructor(){this.types=[a.ShaderCodeType.VertHead,a.ShaderCodeType.VertBody,a.ShaderCodeType.FragHead,a.ShaderCodeType.FragBody],this.urls=null,this.uuid=i.ShaderCodeUUID.Default,this.binary=!1,this.buildBinaryFile=!1}}e.ShaderCodeConfigure=r},"29ef":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s("070b"),a=s("a5ba"),r=s("e08e");class l{static Initialize(t,e){if(l.BT){l.BT=!1;let s=l;s.Rstate=t,s.VRO=e,i.RenderColorMask.Rstate=t,a.RenderStateObject.Rstate=t,s.COLOR_MASK_ALL_TRUE=i.RenderColorMask.Create("all_true",!0,!0,!0,!0),s.COLOR_MASK_ALL_FALSE=i.RenderColorMask.Create("all_false",!1,!1,!1,!1),s.COLOR_MASK_RED_TRUE=i.RenderColorMask.Create("red_true",!0,!1,!1,!1),s.COLOR_MASK_GREEN_TRUE=i.RenderColorMask.Create("green_true",!1,!0,!1,!1),s.COLOR_MASK_BLUE_TRUE=i.RenderColorMask.Create("blue_true",!1,!1,!0,!1),s.COLOR_MASK_ALPHA_TRUE=i.RenderColorMask.Create("alpha_true",!1,!1,!1,!0),s.COLOR_MASK_RED_FALSE=i.RenderColorMask.Create("red_false",!1,!0,!0,!0),s.COLOR_MASK_GREEN_FALSE=i.RenderColorMask.Create("green_false",!0,!1,!0,!0),s.COLOR_MASK_BLUE_FALSE=i.RenderColorMask.Create("blue_false",!0,!0,!1,!0),s.COLOR_MASK_ALPHA_FALSE=i.RenderColorMask.Create("alpha_false",!0,!0,!0,!1);let n=a.RenderStateObject,_=r.RenderBlendMode;_.NORMAL=n.CreateBlendMode("NORMAL",r.GLBlendMode.ONE,r.GLBlendMode.ZERO,r.GLBlendEquation.FUNC_ADD),_.OPAQUE=n.CreateBlendMode("OPAQUE",r.GLBlendMode.ONE,r.GLBlendMode.ZERO,r.GLBlendEquation.FUNC_ADD),_.TRANSPARENT=n.CreateBlendMode("TRANSPARENT",r.GLBlendMode.SRC_ALPHA,r.GLBlendMode.ONE_MINUS_SRC_ALPHA,r.GLBlendEquation.FUNC_ADD),_.ALPHA_ADD=n.CreateBlendMode("ALPHA_ADD",r.GLBlendMode.ONE,r.GLBlendMode.ONE_MINUS_SRC_ALPHA,r.GLBlendEquation.FUNC_ADD),_.ADD=n.CreateBlendMode("ADD",r.GLBlendMode.SRC_ALPHA,r.GLBlendMode.ONE,r.GLBlendEquation.FUNC_ADD),_.ADD_LINEAR=n.CreateBlendMode("ADD_LINEAR",r.GLBlendMode.ONE,r.GLBlendMode.ONE,r.GLBlendEquation.FUNC_ADD),_.INVERSE_ALPHA=n.CreateBlendMode("INVERSE_ALPHA",r.GLBlendMode.ONE,r.GLBlendMode.SRC_ALPHA,r.GLBlendEquation.FUNC_ADD),_.BLAZE=n.CreateBlendMode("BLAZE",r.GLBlendMode.SRC_COLOR,r.GLBlendMode.ONE,r.GLBlendEquation.FUNC_ADD),_.OVERLAY=n.CreateBlendMode("OVERLAY",r.GLBlendMode.DST_COLOR,r.GLBlendMode.DST_ALPHA,r.GLBlendEquation.FUNC_ADD),_.OVERLAY2=n.CreateBlendMode("OVERLAY2",r.GLBlendMode.DST_COLOR,r.GLBlendMode.SRC_ALPHA,r.GLBlendEquation.FUNC_ADD),s.NORMAL_STATE=n.Create("normal",r.CullFaceMode.BACK,r.RenderBlendMode.NORMAL,r.DepthTestMode.OPAQUE),s.BACK_CULLFACE_NORMAL_STATE=s.NORMAL_STATE,s.FRONT_CULLFACE_NORMAL_STATE=n.Create("front_normal",r.CullFaceMode.FRONT,r.RenderBlendMode.NORMAL,r.DepthTestMode.OPAQUE),s.NONE_CULLFACE_NORMAL_STATE=n.Create("none_normal",r.CullFaceMode.NONE,r.RenderBlendMode.NORMAL,r.DepthTestMode.OPAQUE),s.ALL_CULLFACE_NORMAL_STATE=n.Create("all_cull_normal",r.CullFaceMode.FRONT_AND_BACK,r.RenderBlendMode.NORMAL,r.DepthTestMode.OPAQUE),s.BACK_NORMAL_ALWAYS_STATE=n.Create("back_normal_always",r.CullFaceMode.BACK,r.RenderBlendMode.NORMAL,r.DepthTestMode.ALWAYS),s.BACK_TRANSPARENT_STATE=n.Create("back_transparent",r.CullFaceMode.BACK,r.RenderBlendMode.TRANSPARENT,r.DepthTestMode.TRANSPARENT_SORT),s.BACK_TRANSPARENT_ALWAYS_STATE=n.Create("back_transparent_always",r.CullFaceMode.BACK,r.RenderBlendMode.TRANSPARENT,r.DepthTestMode.ALWAYS),s.NONE_TRANSPARENT_STATE=n.Create("none_transparent",r.CullFaceMode.NONE,r.RenderBlendMode.TRANSPARENT,r.DepthTestMode.TRANSPARENT_SORT),s.NONE_TRANSPARENT_ALWAYS_STATE=n.Create("none_transparent_always",r.CullFaceMode.NONE,r.RenderBlendMode.TRANSPARENT,r.DepthTestMode.ALWAYS),s.FRONT_CULLFACE_GREATER_STATE=n.Create("front_greater",r.CullFaceMode.FRONT,r.RenderBlendMode.NORMAL,r.DepthTestMode.TRUE_GREATER),s.BACK_ADD_BLENDSORT_STATE=n.Create("back_add_blendSort",r.CullFaceMode.BACK,r.RenderBlendMode.ADD,r.DepthTestMode.TRANSPARENT_SORT),s.BACK_ADD_ALWAYS_STATE=n.Create("back_add_always",r.CullFaceMode.BACK,r.RenderBlendMode.ADD,r.DepthTestMode.ALWAYS),s.BACK_ALPHA_ADD_ALWAYS_STATE=n.Create("back_alpha_add_always",r.CullFaceMode.BACK,r.RenderBlendMode.ALPHA_ADD,r.DepthTestMode.ALWAYS),s.NONE_ADD_ALWAYS_STATE=n.Create("none_add_always",r.CullFaceMode.NONE,r.RenderBlendMode.ADD,r.DepthTestMode.ALWAYS),s.NONE_ADD_BLENDSORT_STATE=n.Create("none_add_blendSort",r.CullFaceMode.NONE,r.RenderBlendMode.ADD,r.DepthTestMode.TRANSPARENT_SORT),s.NONE_ALPHA_ADD_ALWAYS_STATE=n.Create("none_alpha_add_always",r.CullFaceMode.NONE,r.RenderBlendMode.ALPHA_ADD,r.DepthTestMode.ALWAYS),s.FRONT_ADD_ALWAYS_STATE=n.Create("front_add_always",r.CullFaceMode.FRONT,r.RenderBlendMode.ADD,r.DepthTestMode.ALWAYS),s.FRONT_TRANSPARENT_STATE=n.Create("front_transparent",r.CullFaceMode.FRONT,r.RenderBlendMode.TRANSPARENT,r.DepthTestMode.TRANSPARENT_SORT),s.FRONT_TRANSPARENT_ALWAYS_STATE=n.Create("front_transparent_always",r.CullFaceMode.FRONT,r.RenderBlendMode.TRANSPARENT,r.DepthTestMode.ALWAYS),s.NONE_CULLFACE_NORMAL_ALWAYS_STATE=n.Create("none_normal_always",r.CullFaceMode.NONE,r.RenderBlendMode.NORMAL,r.DepthTestMode.ALWAYS),s.BACK_ALPHA_ADD_BLENDSORT_STATE=n.Create("back_alpha_add_blendSort",r.CullFaceMode.BACK,r.RenderBlendMode.ALPHA_ADD,r.DepthTestMode.TRANSPARENT_SORT)}}static CreateBlendMode(t,e,s,i=0){return a.RenderStateObject.CreateBlendMode(t,e,s,i)}static CreateBlendModeSeparate(t,e,s,i=0,r=0,l=0){return a.RenderStateObject.CreateBlendModeSeparate(t,e,s,i,r,l)}static CreateRenderState(t,e,s,i){return a.RenderStateObject.Create(t,e,s,i)}static CreateRenderColorMask(t,e,s,a,r){return i.RenderColorMask.Create(t,e,s,a,r)}static GetRenderStateByName(t){return a.RenderStateObject.GetRenderStateByName(t)}static GetRenderColorMaskByName(t){return i.RenderColorMask.GetColorMaskByName(t)}static UnlockBlendMode(){a.RenderStateObject.UnlockBlendMode()}static LockBlendMode(t){a.RenderStateObject.LockBlendMode(t)}static UnlockDepthTestMode(){a.RenderStateObject.UnlockDepthTestMode()}static LockDepthTestMode(t){a.RenderStateObject.LockDepthTestMode(t)}static ResetState(){i.RenderColorMask.Reset(),a.RenderStateObject.Reset(),l.Rstate.reset(),l.VRO.__$resetVRO()}static Reset(t){i.RenderColorMask.Reset(),a.RenderStateObject.Reset(),l.Rstate.setRenderContext(t),l.Rstate.reset()}static ResetInfo(){l.DrawCallTimes=0,l.DrawTrisNumber=0,l.POVNumber=0}static SetDepthTestEnable(t){l.Rstate.setDepthTestEnable(t)}static SetBlendEnable(t){l.Rstate.setBlendEnable(t)}}l.BT=!0,l.VRO=null,l.Rstate=null,l.DrawCallTimes=0,l.DrawTrisNumber=0,l.POVNumber=0,l.COLOR_MASK_ALL_TRUE=0,l.COLOR_MASK_ALL_FALSE=1,l.COLOR_MASK_RED_TRUE=2,l.COLOR_MASK_GREEN_TRUE=3,l.COLOR_MASK_BLUE_TRUE=4,l.COLOR_MASK_ALPHA_TRUE=5,l.COLOR_MASK_RED_FALSE=6,l.COLOR_MASK_GREEN_FALSE=7,l.COLOR_MASK_BLUE_FALSE=8,l.COLOR_MASK_ALPHA_FALSE=9,l.NORMAL_STATE=0,l.BACK_CULLFACE_NORMAL_STATE=0,l.FRONT_CULLFACE_NORMAL_STATE=1,l.NONE_CULLFACE_NORMAL_STATE=2,l.ALL_CULLFACE_NORMAL_STATE=3,l.BACK_NORMAL_ALWAYS_STATE=4,l.BACK_TRANSPARENT_STATE=5,l.BACK_TRANSPARENT_ALWAYS_STATE=6,l.NONE_TRANSPARENT_STATE=7,l.NONE_TRANSPARENT_ALWAYS_STATE=8,l.FRONT_CULLFACE_GREATER_STATE=9,l.BACK_ADD_BLENDSORT_STATE=10,l.BACK_ADD_ALWAYS_STATE=11,l.BACK_ALPHA_ADD_ALWAYS_STATE=12,l.NONE_ADD_ALWAYS_STATE=13,l.NONE_ADD_BLENDSORT_STATE=14,l.NONE_ALPHA_ADD_ALWAYS_STATE=15,l.FRONT_ADD_ALWAYS_STATE=16,l.FRONT_TRANSPARENT_STATE=17,l.FRONT_TRANSPARENT_ALWAYS_STATE=18,l.NONE_CULLFACE_NORMAL_ALWAYS_STATE=19,l.BACK_ALPHA_ADD_BLENDSORT_STATE=20,e.default=l},"2e8a":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("8a0a")),r=i(s("644c"));class l{constructor(){this.type=-1,this.attriType=-1,this.typeSize=3,this.typeName="",this.name="",this.layoutEnabled=!0}parseCode(t){const e=";",s=" ";t=t.replace(/^\s*|\s*$/g,"");let i=t.indexOf(e);i>0&&(t=t.slice(0,i));let l=t.split(s);this.typeName=l[l.length-2],this.name=l[l.length-1],this.type=r.default.GetTypeByTypeNS(this.typeName),this.typeSize=parseInt(this.typeName.slice(this.typeName.length-1)),this.attriType=a.default.GetVBufAttributeTypeByNS(this.name)}}e.default=l},"2fe4":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("b3bd")),r=i(s("6e01")),l=s("f3a2");class n{constructor(){this.n="PBR",this.o=128,this.p=128,this.q=new Float32Array([0,0,1,.02,1,.1,1,1,.1,.1,.1,1,1,1,1,.07]),this.r=null,this.s=null,this.t=new Float32Array([0,0,-1,1,1,.3,0,0]),this.vertColorEnabled=!1,this.premultiplyAlpha=!1,this.shadowReceiveEnabled=!1,this.lightEnabled=!0,this.fogEnabled=!1,this.envAmbientLightEnabled=!1,this.brightnessOverlayEnabeld=!1,this.glossinessEnabeld=!0,this.specularEnvMap=null,this.diffuseMap=null,this.normalMap=null,this.mirrorMap=null,this.indirectEnvMap=null,this.parallaxMap=null,this.aoMap=null,this.roughnessMap=null,this.metalhnessMap=null,this.armMap=null,this.woolEnabled=!0,this.toneMappingEnabled=!0,this.scatterEnabled=!0,this.specularBleedEnabled=!0,this.metallicCorrection=!0,this.gammaCorrection=!0,this.absorbEnabled=!1,this.normalNoiseEnabled=!1,this.pixelNormalNoiseEnabled=!1,this.mirrorMapLodEnabled=!1,this.hdrBrnEnabled=!1,this.vtxFlatNormal=!1,this.texturesTotal=1,this.fragLocalParamsTotal=2,this.parallaxParamIndex=2,this.vertUniform=null}initialize(){this.fragLocalParamsTotal=2,this.parallaxParamIndex=2,null!=this.parallaxMap&&(this.fragLocalParamsTotal+=1),this.r=new Float32Array(4*this.fragLocalParamsTotal),this.r.set([0,0,0,1,.2,.2,.2,0],0),null!=this.parallaxMap&&(this.s=this.r.subarray(4*this.parallaxParamIndex,4*(this.parallaxParamIndex+1)),this.s.set([1,10,2,.1]))}seNormalMapIntensity(t){t=Math.min(Math.max(t,0),1),this.r[4]=t}setPixelNormalNoiseIntensity(t){t=Math.min(Math.max(t,0),2),this.q[3]=t}getPixelNormalNoiseIntensity(){return this.q[3]}setMirrorViewNV(t){this.t[0]=t.x,this.t[1]=t.y,this.t[2]=t.z}setMirrorPlaneNV(t){}setMirrorMapLodLevel(t){this.t[3]=t}setMirrorIntensity(t){this.t[4]=Math.min(Math.max(t,.01),2)}setMirrorMixFactor(t){this.t[5]=Math.min(Math.max(t,.01),2)}setEnvMapLodMipMapLevel(t,e=0){t=Math.min(Math.max(t,0),14),e=Math.min(Math.max(e,-7),12),this.q[15]=.01*Math.round(t)+e}setEnvMapLodMipMapLevelWithSize(t,e,s=0){this.o=t,this.p=e,s=Math.min(Math.max(s,-7),12),this.q[15]=.01*r.default.GetMaxMipMapLevel(t,e)+s}setScatterIntensity(t){this.q[11]=Math.min(Math.max(t,.01),512)}getScatterIntensity(){return this.q[11]}setToneMapingExposure(t){this.q[4]=Math.min(Math.max(t,.1),128)}getToneMapingExposure(){return this.q[4]}setReflectionIntensity(t){this.q[5]=Math.min(Math.max(t,.001),1)}getReflectionIntensity(){return this.q[5]}setSurfaceIntensity(t){this.q[6]=Math.min(Math.max(t,.001),32)}getSurfaceIntensity(){return this.q[6]}setSideIntensity(t){this.q[7]=Math.min(Math.max(t,.001),32)}getSideIntensity(){return this.q[7]}setEnvSpecularColorFactor(t,e,s){this.q[12]=t,this.q[13]=e,this.q[14]=s}getEnvSpecularColorFactor(t){t.r=this.q[12],t.g=this.q[13],t.b=this.q[14]}setAmbientFactor(t,e,s){this.q[8]=t,this.q[9]=e,this.q[10]=s}getAmbientFactor(t){t.r=this.q[8],t.g=this.q[9],t.b=this.q[10]}setMetallic(t){this.q[0]=Math.min(Math.max(t,.05),1)}getMetallic(){return this.q[0]}setRoughness(t){this.q[1]=Math.min(Math.max(t,.05),1)}getRoughness(){return this.q[1]}setAO(t){this.q[2]=t}getAO(){return this.q[2]}setF0(t,e,s){this.r[0]=t,this.r[1]=e,this.r[2]=s}getF0(t){t.r=this.r[0],t.g=this.r[1],t.b=this.r[2]}setAlbedoColor(t,e,s){this.r[4]=t,this.r[5]=e,this.r[6]=s}getAlbedoColor(t){t.r=this.r[4],t.g=this.r[5],t.b=this.r[6]}setParallaxParams(t=1,e=10,s=2,i=.1){null!=this.s&&(this.s[0]=t,this.s[1]=e,this.s[2]=s,this.s[3]=i)}buildBufParams(){}buildTextureList(t){t.addSpecularEnvMap(this.specularEnvMap,!0),t.addDiffuseMap(this.diffuseMap),t.addNormalMap(this.normalMap),t.addParallaxMap(this.parallaxMap,this.parallaxParamIndex),t.addAOMap(this.aoMap),t.addRoughnessMap(this.roughnessMap),t.addMetalnessMap(this.metalhnessMap),t.addARMMap(this.armMap),t.add2DMap(this.mirrorMap,"VOX_MIRROR_PROJ_MAP",!0,!0,!1),t.addCubeMap(this.indirectEnvMap,"VOX_INDIRECT_ENV_MAP",!0,!1)}buildShader(t){t.normalMapEnabled=null!=this.normalMap,t.mapLodEnabled=!0,t.useHighPrecious();let e=null!=this.mirrorMap&&this.texturesTotal>0;this.normalNoiseEnabled&&t.addDefine("VOX_NORMAL_NOISE","1"),this.woolEnabled&&t.addDefine("VOX_WOOL","1"),this.toneMappingEnabled&&t.addDefine("VOX_TONE_MAPPING","1"),this.scatterEnabled&&t.addDefine("VOX_SCATTER","1"),this.specularBleedEnabled&&t.addDefine("VOX_SPECULAR_BLEED","1"),this.metallicCorrection&&t.addDefine("VOX_METALLIC_CORRECTION","1"),this.gammaCorrection&&t.addDefine("VOX_GAMMA_CORRECTION","1"),this.absorbEnabled&&t.addDefine("VOX_ABSORB","1"),this.pixelNormalNoiseEnabled&&t.addDefine("VOX_PIXEL_NORMAL_NOISE","1"),this.mirrorMapLodEnabled&&t.addDefine("VOX_MIRROR_MAP_LOD","1"),this.hdrBrnEnabled&&t.addDefine("VOX_HDR_BRN","1"),this.vtxFlatNormal&&t.addDefine("VOX_VTX_FLAT_NORMAL","1"),t.addFragUniform("vec4","u_fragLocalParams",this.fragLocalParamsTotal),t.addFragUniform("vec4","u_pbrParams",4),e&&(t.uniform.useStage(!1,!0),t.addFragUniform("vec4","u_mirrorParams",2)),t.vertMatrixInverseEnabled=!0}createUniformData(){let t=new a.default;return t.uniformNameList=["u_pbrParams","u_fragLocalParams","u_mirrorParams"],t.dataList=[this.q,this.r,this.t],t}getShaderCodeObjectUUID(){return l.ShaderCodeUUID.PBR}getShaderCodeObject(){return null}getUniqueName(){let t=this.n;return this.woolEnabled&&(t+="_wl"),this.toneMappingEnabled&&(t+="TM"),this.scatterEnabled&&(t+="Sct"),this.specularBleedEnabled&&(t+="SpecBl"),this.metallicCorrection&&(t+="MetCorr"),this.gammaCorrection&&(t+="GmaCorr"),this.absorbEnabled&&(t+="Absorb"),this.pixelNormalNoiseEnabled&&(t+="PNNoise"),this.normalNoiseEnabled&&(t+="NNoise"),null!=this.indirectEnvMap&&(t+="IndirEnv"),this.shadowReceiveEnabled&&(t+="Shadow"),this.fogEnabled&&(t+="Fog"),this.hdrBrnEnabled&&(t+="HdrBrn"),this.vtxFlatNormal&&(t+="vtxFlagN"),this.mirrorMapLodEnabled&&(t+="MirLod"),this.n=t,this.n}destroy(){this.q=null,this.r=null,this.t=null}}e.PBRDecorator=n},3113:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=s("839a"),r=s("a9f4"),l=i(s("ab73"));class n{constructor(){this.u=null,this.v="",this.w=new Uint16Array(128),this.x=16,this.y=!1}__$setCodeBuilder(t){this.u=t}getUniqueNSKeyID(){if(this.y){let t=31;for(let e=0;e<this.x;++e)t=131*t+this.w[e];return t}return 0}getUniqueNSKeyString(){if(this.y){this.v="["+this.w[0];for(let t=1;t<this.x;++t)this.v+=""+this.w[t];return this.v+="]",this.v}return""}reset(){if(this.y){for(let t=0;t<this.x;++t)this.w[t]=0;this.y=!1}}useCameraPosition(t=!1,e=!0){t&&this.u.addVertUniformParam(l.default.CameraPosParam),e&&this.u.addFragUniformParam(l.default.CameraPosParam)}useViewPort(t=!1,e=!0){t&&this.u.addVertUniformParam(l.default.ViewportParam),e&&this.u.addFragUniformParam(l.default.ViewportParam)}useFrustum(t=!1,e=!0){t&&this.u.addVertUniformParam(l.default.FrustumParam),e&&this.u.addFragUniformParam(l.default.FrustumParam)}useStage(t,e){t&&this.u.addVertUniformParam(l.default.StageParam),e&&this.u.addFragUniformParam(l.default.StageParam)}addDiffuseMap(){this.u.addTextureSample2D("VOX_DIFFUSE_MAP",!0,!0,!1),this.w[0]=1,this.y=!0}addNormalMap(){this.u.addTextureSample2D("VOX_NORMAL_MAP",!0,!0,!1),this.u.normalMapEnabled=!0,this.w[1]=1,this.y=!0}addParallaxMap(t){this.u.addTextureSample2D("VOX_PARALLAX_MAP",!0,!0,!1),t>=0?(this.u.addDefine("VOX_PARALLAX_PARAMS_INDEX",""+t),this.w[2]=1+(t<<1)):this.w[2]=1,this.y=!0}addDisplacementMap(t){this.u.addTextureSample2D("VOX_DISPLACEMENT_MAP",!0,!1,!0),t>=0?(this.u.addDefine("VOX_DISPLACEMENT_PARAMS_INDEX",""+t),this.w[3]=1+(t<<1)):this.w[3]=1,this.y=!0}addSpecularMap(t=a.SpecularMode.Default){this.u.addTextureSample2D("VOX_SPECULAR_MAP",!0,!0,!1),this.u.addDefine("VOX_SPECULAR_MODE",""+t),this.w[5]=1+(t<<1),this.y=!0}addShadowMap(t=r.ShadowMode.VSM){this.u.addTextureSample2D("VOX_VSM_SHADOW_MAP",!1,!0,!1),this.w[6]=1+(t<<1),this.y=!0}addFogColorMap(){this.u.addTextureSample2D("VOX_FOG_COLOR_MAP",!0,!0,!1),this.w[7]=1,this.y=!0}addSpecularEnvMap(t=!0){t?this.u.addTextureSampleCube("VOX_ENV_MAP",!0,!1):this.u.addTextureSample2D("VOX_ENV_MAP",!0,!0,!1),this.w[8]=1,this.y=!0}addAOMap(){this.u.addTextureSample2D("VOX_AO_MAP",!0,!0,!1),this.w[4]=1,this.y=!0}addRoughnessMap(){this.u.addTextureSample2D("VOX_ROUGHNESS_MAP",!0,!0,!1),this.w[9]=1,this.y=!0}addMetalnessMap(){this.u.addTextureSample2D("VOX_METALNESS_MAP",!0,!0,!1),this.w[10]=1,this.y=!0}addARMMap(){this.u.addTextureSample2D("VOX_ARM_MAP",!0,!0,!1),this.w[11]=1,this.y=!0}add2DMap(t="",e=!0,s=!0,i=!1){this.u.addTextureSample2D(t,e,s,i)}addCubeMap(t="",e=!0,s=!1){this.u.addTextureSampleCube(t,e,s)}add3DMap(t="",e=!0,s=!1){this.u.addTextureSample3D(t,e,s)}}e.ShaderCodeUniform=n},3221:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(){this.z=null,this.v=""}initialize(){}use(t){}getTextures(t,e=null){return null}reset(){}destroy(){}getUniqueNSKeyString(){return this.v}clone(){return null}getParams(){return this.z}getParamsTotal(){return null!=this.z?this.z.length>>2:0}buildShaderUniformData(t){}}e.UniformComp=i},"35fa":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("8e17"));class r{static ClacTriNormal(t,e,s,i){let l=r;a.default.Subtract(e,t,l.BW),a.default.Subtract(s,e,l.BV),a.default.Cross(l.BW,l.BV,i),i.normalize()}static ClacTriNormalByVS(t,e,s){let i=r,a=9*e;i.BU.setTo(t[a],t[a+1],t[a+2]),s.setTo(t[a+3],t[a+4],t[a+5]),i.BV.setTo(t[a+6],t[a+7],t[a+8]),s.subtractBy(i.BU),i.BV.subtractBy(i.BU),s.crossBy(i.BV),s.normalize()}static ClacTriNormalByIVS(t,e,s,i){let a=r,l=3*e,n=3*s[l];a.BU.setTo(t[n],t[n+1],t[n+2]),n=3*s[l+1],i.setTo(t[n],t[n+1],t[n+2]),n=3*s[l+2],a.BV.setTo(t[n],t[n+1],t[n+2]),i.subtractBy(a.BU),a.BV.subtractBy(a.BU),i.crossBy(a.BV),i.normalize()}static ClacTrisNormal(t,e,s,i,l){let n=r,_=new a.default,h=0,o=0,u=0;for(u=0;u<e;++u)l[u]=0;for(u=0;u<s;++u)n.ClacTriNormalByIVS(t,u,i,_),h=3*u,o=3*i[h],l[o]+=_.x,l[o+1]+=_.y,l[o+2]+=_.z,o=3*i[h+1],l[o]+=_.x,l[o+1]+=_.y,l[o+2]+=_.z,o=3*i[h+2],l[o]+=_.x,l[o+1]+=_.y,l[o+2]+=_.z;for(u=0;u<e;u+=3)n.BU.setTo(l[u],l[u+1],l[u+2]),n.BU.normalize(),l[u]=n.BU.x,l[u+1]=n.BU.y,l[u+2]=n.BU.z}static ClacTriTangent(t,e,s,i,a,l,n){let _=r,h=3*i,o=3*a[h];_.BU.setTo(s[o],s[o+1],s[o+2]),_.BU.setTo(t[o],t[o+1],t[o+2]),o=3*a[h+1],_.BW.setTo(t[o],t[o+1],t[o+2]),o=3*a[h+2],_.BV.setTo(t[o],t[o+1],t[o+2]),o=2*a[h],_.BX.setTo(e[o],e[o+1],0),o=2*a[h+1],_.BY.setTo(e[o],e[o+1],0),o=2*a[h+2],_.BZ.setTo(e[o],e[o+1],0),_.BW.subtractBy(_.BU),_.BV.subtractBy(_.BU),_.BY.subtractBy(_.BX),_.BZ.subtractBy(_.BX);let u=1/(_.BY.x*_.BZ.y-_.BY.y*_.BZ.x);l.copyFrom(_.BW),l.scaleBy(_.BZ.y),_.BU.copyFrom(_.BV),_.BU.scaleBy(_.BY.y),l.subtractBy(_.BU),l.scaleBy(u),l.normalize(),n.copyFrom(_.BV),n.scaleBy(_.BY.x),_.BU.copyFrom(_.BW),_.BU.scaleBy(_.BZ.x),n.subtractBy(_.BU),n.scaleBy(u),n.normalize()}static ClacTrisTangent(t,e,s,i,l,n,_,h){let o=r,u=new a.default,m=new a.default,d=0,c=0,f=0;for(f=0;f<e;++f)_[f]=0,h[f]=0;for(f=0;f<l;++f)o.ClacTriTangent(t,s,i,f,n,u,m),d=3*f,c=3*n[d],_[c]=u.x,_[c+1]=u.y,_[c+2]=u.z,h[c]=m.x,h[c+1]=m.y,h[c+2]=m.z,c=3*n[d+1],_[c]=u.x,_[c+1]=u.y,_[c+2]=u.z,h[c]=m.x,h[c+1]=m.y,h[c+2]=m.z,c=3*n[d+2],_[c]=u.x,_[c+1]=u.y,_[c+2]=u.z,h[c]=m.x,h[c+1]=m.y,h[c+2]=m.z;for(f=0;f<e;f+=3)o.BX.setTo(_[f],_[f+1],_[f+2]),o.BX.normalize(),o.BW.setTo(h[f],h[f+1],h[f+2]),o.BW.normalize(),o.BV.setTo(i[f],i[f+1],i[f+2]),o.BU.copyFrom(o.BV),o.BV.scaleBy(o.BV.dot(o.BX)),o.BX.subtractBy(o.BV),o.BX.normalize(),o.BV.setTo(i[f],i[f+1],i[f+2]),o.BV.scaleBy(o.BW.dot(o.BV)),o.BW.subtractBy(o.BV),o.BW.normalize(),o.BU.crossBy(o.BX),o.BU.dot(o.BW)<0&&o.BX.scaleBy(-1),_[f]=o.BX.x,_[f+1]=o.BX.y,_[f+2]=o.BX.z,o.BW.setTo(i[f],i[f+1],i[f+2]),o.BW.crossBy(o.BX),o.BW.normalize(),h[f]=o.BW.x,h[f+1]=o.BW.y,h[f+2]=o.BW.z}}r.BU=new a.default,r.BW=new a.default,r.BV=new a.default,r.BX=new a.default,r.BY=new a.default,r.BZ=new a.default,r.Ba=new a.default,e.default=r},3930:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("6e01"));class r{constructor(t=1,e=1,s=1,i=1){this.r=1,this.g=1,this.b=1,this.a=1,this.r=t,this.g=e,this.b=s,this.a=i}setRGB3Bytes(t,e,s){this.r=t/255,this.g=e/255,this.b=s/255}setRGB3f(t,e,s){this.r=t,this.g=e,this.b=s}setRGBUint24(t){this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255}setRGBA4f(t,e,s,i){this.r=t,this.g=e,this.b=s,this.a=i}copyFrom(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a}copyFromRGB(t){this.r=t.r,this.g=t.g,this.b=t.b}scaleBy(t){this.r*=t,this.g*=t,this.b*=t}inverseRGB(){this.r=1-this.r,this.g=1-this.g,this.b=1-this.b}randomRGB(t=1,e=0){this.r=Math.random()*t,this.g=Math.random()*t,this.b=Math.random()*t,this.r+=e,this.g+=e,this.b+=e}normalizeRandom(t=1,e=0){this.r=Math.random(),this.g=Math.random(),this.b=Math.random();let s=Math.sqrt(this.r*this.r+this.g*this.g+this.b*this.b);s>a.default.MATH_MIN_POSITIVE&&(this.r=t*this.r/s,this.g=t*this.g/s,this.b=t*this.b/s),this.r+=e,this.g+=e,this.b+=e}normalize(t){void 0==t&&(t=1);let e=Math.sqrt(this.r*this.r+this.g*this.g+this.b*this.b);e>a.default.MATH_MIN_POSITIVE&&(this.r=t*this.r/e,this.g=t*this.g/e,this.b=t*this.b/e)}getCSSDecRGBAColor(){let t=Math.floor(255*this.r),e=Math.floor(255*this.g),s=Math.floor(255*this.b),i=this.a;return"rgba("+t+","+e+","+s+","+i+")"}getCSSHeXRGBColor(){let t="#",e=Math.floor(255*this.r);return t+=e<15?"0"+e.toString(16):""+e.toString(16),e=Math.floor(255*this.g),t+=e<15?"0"+e.toString(16):""+e.toString(16),e=Math.floor(255*this.b),t+=e<15?"0"+e.toString(16):""+e.toString(16),t}toString(){return"[Color4(r="+this.r+", g="+this.g+",b="+this.b+",a="+this.a+")]"}}e.default=r},"3b73":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{static SetWebBodyColor(t="white"){const e=document.body;e.style.background=t}static SetLanguage(t){i.Bb=t}static GetLanguage(){return""!=i.Bb||(i.Bb=navigator.language),i.Bb}static SetThreadEnabled(t){i.Bc=t}static GetThreadEnabled(){return i.Bc}static GetDebugEnabled(){return i.Bd}static SetDebugEnabled(t){i.Bd=t}static SetDevicePixelRatio(t){i.Be=t}static GetDevicePixelRatio(){return i.Be}static Initialize(t){i.Bf&&(i.Bf=!1,i.Bg=t[0],i.TestMobileWeb(),i.Bb=navigator.language+"")}static IsWindowsPCOS(){return!(i.IsSafariWeb()||i.IsMobileWeb())}static IsWinExternalVideoCard(){if(i.Bh>0)return 2==i.Bh;let t=i.IsSafariWeb()||i.IsMobileWeb();return t||(t=i.GPU_RENDERER.indexOf("Intel(R)")<0),i.Bh=t?2:1,2==i.Bh}static TestSafariWeb(){return/Safari/.test(navigator.userAgent)&&/Mac OS/.test(navigator.userAgent)}static IsWebGL1(){return 1==i.Bg}static IsWebGL2(){return 2==i.Bg}static IsMobileWeb(){return i.Bm>0?2==i.Bm:i.TestMobileWeb()}static IsSafariWeb(){return i.Bi>0||(i.Bi=i.TestSafariWeb()?2:1),2==i.Bi}static IsIOS(){if(i.Bj>0)return 2==i.Bj;let t=!1;return t=!!/iPad|iPhone|iPod/.test(navigator.platform)||void 0!=navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform),i.Bj=t?2:1,t}static IsIpadOS(){if(i.Bk>0)return 2==i.Bk;let t=navigator.maxTouchPoints>0&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform);return!t&&/iPod|iPad|iPadPro|iPodPro/i.test(navigator.userAgent)&&(t=!0),i.Bk=t?2:1,t}static IsAndroidOS(){if(i.Bl>0)return 2==i.Bl;let t=i.TestMobileWeb();return t=!(!t||!/Android|Linux/i.test(navigator.userAgent)),i.Bl=t?2:1,t}static TestMobileWeb(){return i.Bm>0?2==i.Bm:/mobile/.test(location.href)?(i.Bm=2,2==i.Bm):/Android/i.test(navigator.userAgent)?/Mobile/i.test(navigator.userAgent)?(i.Bm=2,2==i.Bm):(i.Bm=1,2==i.Bm):/webOS|iPhone|iPod|iPad|iPodPro|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?(i.Bm=2,2==i.Bm):(i.Bm=1,2==i.Bm)}}i.Bf=!0,i.Bg=2,i.Be=1,i.Bm=0,i.Bi=0,i.Bl=0,i.Bj=0,i.Bk=0,i.Bh=0,i.Bb="",i.Bd=!0,i.GPU_VENDOR="unknown",i.GPU_RENDERER="unknown",i.MAX_TEXTURE_SIZE=4096,i.MAX_RENDERBUFFER_SIZE=4096,i.MAX_VIEWPORT_WIDTH=4096,i.MAX_VIEWPORT_HEIGHT=4096,i.SHOWLOG_ENABLED=!1,i.SHADERCODE_TRACE_ENABLED=!1,i.VERT_SHADER_PRECISION_GLOBAL_HIGHP_ENABLED=!0,i.FRAG_SHADER_PRECISION_GLOBAL_HIGHP_ENABLED=!0,i.Bc=!0,e.default=i},"3bfb":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("6e01")),r=i(s("35fa")),l=i(s("8a0a")),n=i(s("e7d2")),_=s("8a0a"),h=i(s("fecb")),o=i(s("cb29")),u=s("e160");class m extends o.default{constructor(t=l.default.VTX_STATIC_DRAW){super(t),this.A_=[null,null,null,null,null,null,null,null],this.normalType=_.VtxNormalType.FLAT,this.B_=null,this.C_=null,this.D_=null,this.E_=null,this.vtxColor=null,this.flipVerticalUV=!1,this.uvPartsNumber=0,this.uScale=1,this.vScale=1}getVS(){return this.B_}getUVS(){return this.C_}getNVS(){return this.D_}getCVS(){return this.E_}setPositionAt(t,e){if(t>=0&&t<8&&null!=this.B_){let s=this.A_[t];s[0]=e.x,s[1]=e.y,s[2]=e.z}}getPositionAt(t,e){if(t>=0&&t<8&&null!=this.B_){let s=this.A_[t];e.x=s[0],e.y=s[1],e.z=s[2]}}setEdgeAt(t,e,s){if(t>=0&&t<8&&null!=this.B_){let i=this.A_[t];t++,3==t?t=0:7==t&&(t=4);let a=this.A_[t];i[0]=e.x,i[1]=e.y,i[2]=e.z,a[0]=s.x,a[1]=s.y,a[2]=s.z}}getEdgeAt(t,e,s){if(t>=0&&t<8&&null!=this.B_){let i=this.A_[t];t++,3==t?t=0:7==t&&(t=4);let a=this.A_[t];e.x=i[0],e.y=i[1],e.z=i[2],s.x=a[0],s.y=a[1],s.z=a[2]}}setFaceAt(t,e,s,i,a){if(t>=0&&t<8&&null!=this.B_){t*=4;let r,l,n=[e,s,i,a],_=m.Bn,h=this.A_;for(let e=t+4,s=0;t<e;++t)r=h[_[t]],l=n[s++],r[0]=l.x,r[1]=l.y,r[2]=l.z}}getFaceAt(t,e,s,i,a){if(t>=0&&t<8&&null!=this.B_){t*=4;let r,l,n=[e,s,i,a],_=m.Bn,h=this.A_;for(let e=t+4,s=0;t<e;++t)r=h[_[t]],l=n[s++],l.x=r[0],l.y=r[1],l.z=r[2]}}getFaceCenterAt(t,e){if(t>=0&&t<8&&null!=this.B_){t*=4;let s,i=m.Bn,a=this.A_;e.setXYZ(0,0,0);for(let r=t+4;t<r;++t)s=a[i[t]],e.x+=s[0],e.y+=s[1],e.z+=s[2];e.scaleBy(.33333)}}transformFaceAt(t,e){if(t>=0&&t<8&&null!=this.B_){t*=4;let s=m.Bn,i=this.A_;for(let a=t+4;t<a;++t)e.transformVectorsSelf(i[s[t]],3)}}initializeWithYFace(t,e,s,i){let a=t,r=e,l=.5*(a.y+r.y);this.A_[0]=[r.x,l,r.z],this.A_[1]=[r.x,l,a.z],this.A_[2]=[a.x,l,a.z],this.A_[3]=[a.x,l,r.z],a=s,r=i;let n=.5*(a.y+r.y);this.A_[4]=[r.x,n,r.z],this.A_[5]=[r.x,n,a.z],this.A_[6]=[a.x,n,a.z],this.A_[7]=[a.x,n,r.z],this.initData()}initialize(t,e){this.A_[0]=[e.x,t.y,e.z],this.A_[1]=[e.x,t.y,t.z],this.A_[2]=[t.x,t.y,t.z],this.A_[3]=[t.x,t.y,e.z],this.A_[4]=[e.x,e.y,e.z],this.A_[5]=[e.x,e.y,t.z],this.A_[6]=[t.x,e.y,t.z],this.A_[7]=[t.x,e.y,e.z],this.initData()}scaleUVFaceAt(t,e,s,i,a){if(null!=this.C_&&t>=0&&t<6){let r=8*t,l=r+8,n=this.C_;for(;r<l;r+=2)n[r]=e+n[r]*i,n[r+1]=s+n[r+1]*a}}reinitialize(){this.initData()}initData(){this.vtxTotal=24;let t=0,e=0,s=0,i=null==this.F_;if(i){this.B_=new Float32Array(72),this.F_=new Uint16Array(36);let i=[3,2,3,3,2,2];for(t=0;t<6;++t)3==i[t]?(this.F_[s]=e+3,this.F_[s+1]=e+2,this.F_[s+2]=e+1,this.F_[s+3]=e+3,this.F_[s+4]=e+1,this.F_[s+5]=e):(this.F_[s]=e+2,this.F_[s+1]=e+3,this.F_[s+2]=e,this.F_[s+3]=e+2,this.F_[s+4]=e,this.F_[s+5]=e+1),s+=6,e+=4}let o,u=m.Bn,d=this.A_,c=this.B_;for(e=0,t=0;t<this.vtxTotal;++t)o=d[u[t]],c.set(o,e),e+=3;null==this.bounds?this.bounds=new h.default:this.bounds.reset(),null!=this.G_?(this.G_.transformVectorsSelf(this.B_,this.B_.length),this.bounds.addXYZFloat32Arr(this.B_)):this.bounds.addXYZFloat32Arr(this.B_),this.bounds.updateFast(),n.default.Reset(),n.default.AddFloat32Data(this.B_,3);let f=6;if(this.isVBufEnabledAt(l.default.VBUF_UVS_INDEX)){if(null==this.C_&&(this.C_=new Float32Array(48),this.initUVData(2*this.vtxTotal),4==this.uvPartsNumber?(this.scaleUVFaceAt(0,.5,.5,.5,.5),this.scaleUVFaceAt(1,0,0,.5,.5),this.scaleUVFaceAt(2,.5,0,.5,.5),this.scaleUVFaceAt(3,0,.5,.5,.5),this.scaleUVFaceAt(4,.5,0,.5,.5),this.scaleUVFaceAt(5,0,.5,.5,.5)):6==this.uvPartsNumber&&(this.scaleUVFaceAt(0,0,0,.25,.5),this.scaleUVFaceAt(1,.25,0,.25,.5),this.scaleUVFaceAt(2,.5,0,.25,.5),this.scaleUVFaceAt(3,.75,0,.25,.5),this.scaleUVFaceAt(4,0,.5,.25,.5),this.scaleUVFaceAt(5,.25,.5,.25,.5)),this.isVBufEnabledAt(l.default.VBUF_TVS_INDEX))){s=0;while(s<6){switch(s){case 0:t=0,this.C_[t]=0,this.C_[t+1]=1,this.C_[t+2]=1,this.C_[t+3]=1,this.C_[t+4]=1,this.C_[t+5]=0,this.C_[t+6]=0,this.C_[t+7]=0;break;case 3:t=24,this.C_[t]=0,this.C_[t+1]=1,this.C_[t+2]=1,this.C_[t+3]=1,this.C_[t+4]=1,this.C_[t+5]=0,this.C_[t+6]=0,this.C_[t+7]=0;break;case 5:t=32,this.C_[t]=0,this.C_[t+1]=1,this.C_[t+2]=1,this.C_[t+3]=1,this.C_[t+4]=1,this.C_[t+5]=0,this.C_[t+6]=0,this.C_[t+7]=0;break;default:break}++s}}n.default.AddFloat32Data(this.C_,2)}if(this.isVBufEnabledAt(l.default.VBUF_NVS_INDEX)){this.D_=new Float32Array(72),s=0;let e=0,i=0,r=0;if(this.normalType==_.VtxNormalType.FLAT)while(s<f){switch(e=0,i=0,r=0,s){case 0:i=-1;break;case 1:i=1;break;case 2:e=1;break;case 3:r=-1;break;case 4:e=-1;break;case 5:r=1;break;default:break}t=12*s,e*=this.normalScale,i*=this.normalScale,r*=this.normalScale,this.D_[t]=e,this.D_[t+1]=i,this.D_[t+2]=r,this.D_[t+3]=e,this.D_[t+4]=i,this.D_[t+5]=r,this.D_[t+6]=e,this.D_[t+7]=i,this.D_[t+8]=r,this.D_[t+9]=e,this.D_[t+10]=i,this.D_[t+11]=r,++s}else{let l=this.bounds.center,n=0;while(s<this.vtxTotal)t=3*s,e=this.B_[t]-l.x,i=this.B_[t+1]-l.y,r=this.B_[t+2]-l.z,n=Math.sqrt(e*e+i*i+r*r),n>a.default.MATH_MIN_POSITIVE&&(this.D_[t]=e/n,this.D_[t+1]=i/n,this.D_[t+2]=r/n),++s}n.default.AddFloat32Data(this.D_,3)}if(this.isVBufEnabledAt(l.default.VBUF_CVS_INDEX)){this.E_=new Float32Array(72),s=0;let e=1,i=1,a=1;null!=this.vtxColor&&(e=this.vtxColor.r,i=this.vtxColor.g,a=this.vtxColor.b);while(s<f)t=12*s,this.E_[t]=e,this.E_[t+1]=i,this.E_[t+2]=a,this.E_[t+3]=e,this.E_[t+4]=i,this.E_[t+5]=a,this.E_[t+6]=e,this.E_[t+7]=i,this.E_[t+8]=a,this.E_[t+9]=e,this.E_[t+10]=i,this.E_[t+11]=a,++s;n.default.AddFloat32Data(this.E_,3)}if(this.isVBufEnabledAt(l.default.VBUF_TVS_INDEX)){let t=12,e=new Float32Array(this.D_.length),s=new Float32Array(this.D_.length);r.default.ClacTrisTangent(this.B_,this.B_.length,this.C_,this.D_,t,this.F_,e,s),n.default.AddFloat32Data(e,3),n.default.AddFloat32Data(s,3)}n.default.vbWholeDataEnabled=this.vbWholeDataEnabled,this.updateWireframeIvs(),null==this.H_?(this.H_=n.default.CreateBySaveData(this.getBufDataUsage()),this.H_.setUintIVSData(this.F_),this.vtCount=this.F_.length,this.trisNumber=12,this.buildEnd()):(this.forceUpdateIVS&&this.H_.setUintIVSData(this.F_),n.default.UpdateBufData(this.H_))}setFaceUVSAt(t,e,s=0){if(null!=this.C_)if(s<1)this.C_.set(e,8*t);else{t*=8,s<0&&(s=0);for(let i=0;i<4;++i)this.C_[t++]=e[2*s],this.C_[t++]=e[2*s+1],s++,s%=4}}initUVData(t){let e=this.uScale,s=this.vScale,i=0;if(this.flipVerticalUV)while(i<t)this.C_[i]=1*e,this.C_[i+1]=1*s,this.C_[i+2]=0*e,this.C_[i+3]=1*s,this.C_[i+4]=0*e,this.C_[i+5]=0*s,this.C_[i+6]=1*e,this.C_[i+7]=0*s,i+=8;else while(i<t)this.C_[i]=0*e,this.C_[i+1]=0*s,this.C_[i+2]=1*e,this.C_[i+3]=0*s,this.C_[i+4]=1*e,this.C_[i+5]=1*s,this.C_[i+6]=0*e,this.C_[i+7]=1*s,i+=8}testRay(t,e,s,i){let a=u.AABBCalc.IntersectionRL2(e,t,this.bounds,s);return a?1:-1}toString(){return"Box3DMesh()"}__$destroy(){this.isResFree()&&(this.bounds=null,this.B_=null,this.C_=null,this.D_=null,this.E_=null,this.vtxColor=null,super.__$destroy())}}m.Bn=[0,1,2,3,4,5,6,7,4,5,1,0,5,6,2,1,7,6,2,3,4,7,3,0],e.default=m},"402a":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("11e6")),r=i(s("8e17")),l=i(s("fecb")),n=i(s("29ef")),_=i(s("0929")),h=s("cc48"),o=i(s("dc2b"));class u{constructor(t=null){this.A=0,this.I_=null,this.J_=null,this.K_=!0,this.L_=!0,this.M_=n.default.COLOR_MASK_ALL_TRUE,this.N_=n.default.BACK_CULLFACE_NORMAL_STATE,this.O_=null,this.P_=null,this.Q_=null,this.R_=null,this.S_=-1,this.T_=null,this.U_=null,this.e=null,this.__$rseFlag=a.default.DEFAULT,this.name="DisplayEntity",this.spaceCullMask=h.SpaceCullingMask.CAMERA,this.drawEnabled=!1,this.mouseEnabled=!1,this.vbWholeDataEnabled=!0,this.pipeTypes=null,this.V_=!1,this.W_=!1,this.X_=null,this.Y_=_.default.UPDATE_TRANSFORM,this.A=u.BF++,this.I_=null==t?_.default.Create():t,this.createBounds()}createBounds(){this.R_=new l.default}__$setRenderProxy(t){this.U_=t}__$setParent(t){this.T_,this.T_=t}__$getParent(){return this.T_}__$testSpaceEnabled(){return a.default.TestSpaceEnabled2(this.__$rseFlag)}__$testContainerEnabled(){return a.default.TestContainerEnabled(this.__$rseFlag)}__$testRendererEnabled(){return a.default.TestRendererEnabled(this.__$rseFlag)}getRendererUid(){return a.default.GetRendererUid(this.__$rseFlag)}setMaterialPipeline(t){this.e=t}getMaterialPipeline(){return this.e}isFree(){return this.__$rseFlag==a.default.DEFAULT}dispatchEvt(t){return null!=this.J_?this.J_.dispatchEvt(t):0}getEvtDispatcher(t){return this.J_}setEvtDispatcher(t){this.J_=t}getGlobalBounds(){return this.R_}getLocalBounds(){return this.P_.bounds}getGlobalBoundsVer(){return null!=this.R_?this.R_.version:-1}__$setDrawEnabled(t){this.L_!=t&&(this.L_=t,null!=this.O_&&(this.O_.visible=this.K_&&t,null!=this.O_.__$$runit&&this.O_.__$$runit.setVisible(this.O_.visible)))}isDrawEnabled(){return this.L_}updateMeshToGpu(t=null,e=!0){null!=t&&(this.U_=t),null!=this.U_&&null!=this.O_&&this.O_.__$ruid>-1&&(this.W_?(this.W_=!1,this.U_.VtxBufUpdater.updateDispVbuf(this.O_,e)):this.U_.VtxBufUpdater.updateVtxDataToGpuByUid(this.O_.vbuf.getUid(),e))}updateMaterialToGpu(t=null,e=!0){null!=t&&(this.U_=t),null!=this.U_&&null!=this.O_&&this.O_.__$ruid>-1&&this.V_&&(this.V_=!1,this.U_.MaterialUpdater.updateDispTRO(this.O_,e))}setTextureList(t){if(null!=this.O_&&this.O_.__$ruid>-1){let e=this.O_.getMaterial();null!=e&&(e.setTextureList(t),this.V_=!0)}}setTextureAt(t,e){if(null!=this.O_&&this.O_.__$ruid>-1){let s=this.O_.getMaterial();null!=s&&(s.setTextureAt(t,e),this.V_=!0)}}setSortValue(t){null!=this.O_&&null!=this.O_.__$$runit&&(this.O_.__$$runit.value=t)}setVisible(t){this.K_!=t&&(this.K_=t,null!=this.O_&&(this.O_.visible=t&&this.L_,null!=this.O_.__$$runit&&this.O_.__$$runit.setVisible(this.O_.visible)))}getVisible(){return this.K_}getTransform(){return this.I_}copyPositionFrom(t){null!=t&&this.I_.copyPositionFrom(t.getTransform())}copyMeshFrom(t){null!=t&&this.setMesh(t.getMesh())}copyMaterialFrom(t){null!=t&&this.setMaterial(t.getMaterial())}copyTransformFrom(t){let e=t;null!=e&&this.I_.copyFrom(e.I_)}initDisplay(t){this.O_.vbuf=t.__$attachVBuf(),this.O_.ivsIndex=0,this.O_.ivsCount=t.vtCount,this.O_.drawMode=t.drawMode,this.O_.trisNumber=t.trisNumber,this.O_.visible=this.K_&&this.L_}setMesh(t){null==this.P_?null!=t&&(t.isEnabled()||t.rebuild(),t.isEnabled()&&(this.P_=t,t.__$attachThis(),null==this.O_&&this.createDisplay(),null!=this.O_&&(this.O_.setTransform(this.I_.getMatrix()),this.initDisplay(t)),null==this.Q_?this.Q_=t.bounds:this.Q_.copyFrom(t.bounds),this.updateMesh())):null!=this.O_&&this.O_.__$ruid>-1&&this.P_!=t&&null!=t&&(this.I_.updatedStatus|=2,this.P_.__$detachVBuf(this.O_.vbuf),this.P_.__$detachThis(),t.__$attachThis(),this.P_=t,this.initDisplay(t),this.updateMesh(),this.W_=!0)}updateMesh(){}getIvsIndex(){return this.O_.ivsIndex}getIvsCount(){return this.O_.ivsCount}setIvsParam(t,e,s=!1){if(null!=this.O_&&(this.O_.ivsIndex=t,this.O_.ivsCount=e,this.O_.__$ruid>-1&&(this.O_.__$$runit.trisNumber=Math.floor((e-t)/3),this.O_.__$$runit.setIvsParam(t,e),this.O_.__$$runit.drawMode=this.P_.drawMode,s&&this.isPolyhedral()))){this.Q_==this.P_.bounds&&(this.Q_=new l.default,this.Q_.copyFrom(this.P_.bounds)),this.Y_=_.default.UPDATE_TRANSFORM,this.Q_.reset();let s=this.P_.getIVS();this.Q_.addXYZFloat32AndIndicesArr(this.P_.getVS(),s.subarray(t,t+e)),this.Q_.update()}}getMesh(){return this.P_}hasMesh(){return null!=this.P_}isPolyhedral(){return null==this.P_||this.P_.isPolyhedral()}testRay(t,e,s,i){return this.P_.testRay(t,e,s,i)}setMaterial(t){null!=t&&(null==this.O_&&(this.O_=o.default.Create(),this.O_.setTransform(this.I_.getMatrix()),this.O_.visible=this.K_&&this.L_),this.O_.getMaterial()!=t&&(a.default.RENDERER_UID_FLAG&this.__$rseFlag)==a.default.RENDERER_UID_FLAG&&this.O_.__$ruid<0&&(this.O_.renderState=this.N_,this.O_.rcolorMask=this.M_,this.O_.setMaterial(t)))}getMaterial(){return null!=this.O_?this.O_.getMaterial():null}getDisplay(){return this.O_}getInvMatrix(){return this.I_.getInvMatrix()}getMatrix(t=!0){return this.I_.getMatrix(t)}getToParentMatrix(){return this.I_.getToParentMatrix()}setRenderColorMask(t){this.M_=t,null!=this.O_&&(this.O_.rcolorMask=this.M_,null!=this.O_.__$$runit&&this.O_.__$$runit.setDrawFlag(this.N_,this.M_))}setRenderColorMaskByName(t){this.M_=n.default.GetRenderColorMaskByName(t),null!=this.O_&&(this.O_.rcolorMask=this.M_,null!=this.O_.__$$runit&&this.O_.__$$runit.setDrawFlag(this.N_,this.M_))}setRenderState(t){this.N_=t,null!=this.O_&&(this.O_.renderState=this.N_,null!=this.O_.__$$runit&&this.O_.__$$runit.setDrawFlag(this.N_,this.M_))}setRenderStateByName(t){this.N_=n.default.GetRenderStateByName(t),null!=this.O_&&(this.O_.renderState=this.N_,null!=this.O_.__$$runit&&this.O_.__$$runit.setDrawFlag(this.N_,this.M_))}createDisplay(){this.O_=o.default.Create()}activeDisplay(){if(null!=this.O_){let t=this.O_.getMaterial();if(null!=t){if(null==t.getShaderData()&&null!=t.getCodeBuf()&&null==t.getShaderData()){let e=t.getTextureList(),s=null!=e&&e.length>0;null==t.getMaterialPipeline()&&null!=this.getMaterialPipeline()&&t.setMaterialPipeline(this.getMaterialPipeline()),null==t.pipeTypes&&(t.pipeTypes=this.pipeTypes),t.initializeByCodeBuf(s)}null==this.getMesh()&&(this.__activeMesh(t),this.O_.name=this.name)}}}__activeMesh(t){}getUid(){return this.A}setXYZ(t,e,s){this.I_.setXYZ(t,e,s)}offsetPosition(t){this.I_.offsetPosition(t)}setPosition(t){this.I_.setPosition(t)}getPosition(t){this.I_.getPosition(t)}setRotation3(t){this.I_.setRotationXYZ(t.x,t.y,t.z)}setRotationXYZ(t,e,s){this.I_.setRotationXYZ(t,e,s)}setScale3(t){this.I_.setScaleXYZ(t.x,t.y,t.z)}setScaleXYZ(t,e,s){this.I_.setScaleXYZ(t,e,s)}getRotationXYZ(t){this.I_.getRotationXYZ(t)}getScaleXYZ(t){this.I_.getScaleXYZ(t)}localToGlobal(t){null!=this.I_&&this.I_.localToGlobal(t)}globalToLocal(t){null!=this.I_&&this.I_.globalToLocal(t)}isInRenderer(){return(this.__$rseFlag&a.default.RENDERER_UID_FLAG)!=a.default.RENDERER_UID_FLAG}isInRendererProcess(){return null!=this.O_&&this.O_.__$ruid>-1}isRenderEnabled(){return this.drawEnabled&&this.K_&&null!=this.O_&&this.O_.__$ruid>-1}updateBounds(){if(null!=this.I_){if(this.Y_=_.default.UPDATE_TRANSFORM,null!=this.P_&&this.Q_!=this.P_.bounds){this.Q_.reset();let t=this.P_.getIVS();this.Q_.addXYZFloat32AndIndicesArr(this.P_.getVS(),t.subarray(this.O_.ivsIndex,this.O_.ivsIndex+this.O_.ivsCount)),this.Q_.update()}this.update()}}updateLocalBoundsVS(t){let e=t.min,s=t.max;null==this.X_&&(this.X_=new Float32Array(24));let i=this.X_;i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=s.x,i[4]=e.y,i[5]=e.z,i[6]=e.x,i[7]=e.y,i[8]=s.z,i[9]=s.x,i[10]=e.y,i[11]=s.z,i[12]=e.x,i[13]=s.y,i[14]=e.z,i[15]=s.x,i[16]=s.y,i[17]=e.z,i[18]=e.x,i[19]=s.y,i[20]=s.z,i[21]=s.x,i[22]=s.y,i[23]=s.z}updateGlobalBounds(){let t=u,e=this.Q_;if(this.Y_>_.default.UPDATE_POSITION||this.S_!=e.version){let s=this.I_.updateStatus;if(this.I_.update(),this.S_!=e.version||s!=this.I_.updateStatus){this.S_=e.version,this.updateLocalBoundsVS(e);let s=this.X_,i=t.Bo;this.I_.getMatrix().transformVectors(s,24,i),this.R_.reset(),this.R_.addXYZFloat32Arr(i),this.R_.update()}}else{t.Bp.setXYZ(0,0,0),t.Bq.setXYZ(0,0,0);let e=this.I_.getMatrix(!1);e.transformVector3Self(t.Bp),this.I_.update(),e=this.I_.getMatrix(!1),e.transformVector3Self(t.Bq),t.Bq.subtractBy(t.Bp);let s=this.R_;s.min.addBy(t.Bq),s.max.addBy(t.Bq),s.center.addBy(t.Bq),++this.R_.version}}update(){this.I_.updatedStatus>this.Y_&&(this.Y_=this.I_.updatedStatus),this.Y_!=_.default.UPDATE_NONE&&(null!=this.P_&&null!=this.R_?this.updateGlobalBounds():this.I_.update(),this.Y_=_.default.UPDATE_NONE,this.I_.updatedStatus=this.Y_)}destroy(){null!=this.J_&&(this.J_.destroy(),this.J_=null),null!=this.I_&&this.isFree()&&(null!=this.O_&&(this.P_.__$detachVBuf(this.O_.vbuf),o.default.Restore(this.O_),this.O_=null),_.default.Restore(this.I_),this.I_=null,null!=this.P_&&(this.P_.__$detachThis(),this.P_=null),this.__$setParent(null),this.K_=!0,this.L_=!0,this.U_=null,this.__$rseFlag=a.default.DEFAULT),this.R_=null,this.Q_=null,this.e=null}toString(){return"DisplayEntity(name="+this.name+",uid = "+this.A+", rseFlag = "+this.__$rseFlag+")"}}u.BF=0,u.Bo=new Float32Array(24),u.Bq=new r.default,u.Bp=new r.default,e.default=u},4301:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(){this.pointLightsTotal=1,this.directionLightsTotal=1,this.spotLightsTotal=0,this.vsmFboIndex=0,this.vsmEnabled=!0,this.loadAllShaderCode=!1,this.shaderCodeBinary=!1,this.shaderLibVersion="",this.shaderFileRename=!1,this.lambertMaterialEnabled=!0,this.pbrMaterialEnabled=!0,this.buildBinaryFile=!1}}e.MaterialContextParam=i},"4a54":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("3b73")),r=i(s("81ce")),l=i(s("f208")),n=s("c164");class _{constructor(t){this.Z_="#version 300 es\n",this.a_="precision mediump float;\n",this.b_=[],this.c_=[],this.d_=[],this.e_=[],this.f_=[],this.g_=[],this.h_=[],this.i_=[],this.j_=[],this.k_=[],this.l_=[],this.AJ=[],this.n_=[],this.o_=[],this.p_=[],this.q_=[],this.r_=[],this.Br=[],this.t_=[],this.u_=[],this.v_="",this.w_=[],this.x_=!1,this.y_=!1,this.z_=!1,this.AA=!1,this.AB=!1,this.AC=!1,this.AD="",this.AE="",this.AF="",this.AG="",this.v="",this.x=10,this.AH=!1,this.AI=null,this.fragHeadCodeUnlock=!0,this.fragMainCodeUnlock=!0,this.vertHeadCodeUnlock=!0,this.vertMainCodeUnlock=!0,this.autoBuildHeadCodeEnabled=!0,this.mathDefineEanbled=!0,this.normalEnabled=!1,this.normalMapEnabled=!1,this.mapLodEnabled=!1,this.derivatives=!1,this.vertMatrixInverseEnabled=!1,this.vtxUVTransfromEnabled=!1,this.fragMatrixInverseEnabled=!1;let e=this;e.uniform=t}getUniqueNSKeyID(){throw Error("can not use this function !!!")}getUniqueNSKeyString(){let t=this.v;return this.vtxUVTransfromEnabled&&(t+="VtxUVT"),this.normalEnabled&&(t+="Nor"),this.uniform.getUniqueNSKeyString()+t}reset(){this.x_=!0,this.y_=!0,this.z_=!0,this.AA=!1,this.AB=!1,this.AC=!1,this.fragHeadCodeUnlock=!0,this.fragMainCodeUnlock=!0,this.vertHeadCodeUnlock=!0,this.vertMainCodeUnlock=!0,this.autoBuildHeadCodeEnabled=!0,this.AH=!1,this.AD="",this.AE="",this.AF="",this.AG="",this.v="",this.c_=[],this.b_=[],this.f_=[],this.g_=[],this.h_=[],this.i_=[],this.j_=[],this.o_=[],this.p_=[],this.k_=[],this.l_=[],this.AJ=[],this.n_=[],this.q_=[],this.r_=[],this.d_=[],this.e_=[],this.Br=[],this.t_=[],this.u_=[],this.w_=[],this.v_="",this.mathDefineEanbled=!0,this.normalEnabled=!1,this.normalMapEnabled=!1,this.mapLodEnabled=!1,this.vertMatrixInverseEnabled=!1,this.fragMatrixInverseEnabled=!1,this.vtxUVTransfromEnabled=!1,this.AI=null,this.uniform.reset()}addUniqueNSKeyString(t){this.v+=t}getPreCompileInfo(){let t=this.AI;return this.AI=null,t}useHighPrecious(){this.a_="precision highp float;"}useMediumPrecious(){this.a_="precision mediump float;"}useLowPrecious(){this.a_="precision lowp float;"}addDefine(t,e="1"){return!this.d_.includes(t)&&(this.d_.push(t),this.e_.push(e),!0)}addVertLayout(t,e){this.f_.includes(e)||(this.f_.push(e),this.g_.push(t))}addFragOutputHighp(t,e){this.i_.includes(e)||(this.h_.push("highp"),this.i_.push(e),this.j_.push(t))}addFragOutput(t,e){this.i_.includes(e)||(this.h_.push(""),this.i_.push(e),this.j_.push(t))}addVarying(t,e){this.o_.includes(e)||(this.o_.push(e),this.p_.push(t))}addVertUniform(t,e,s=0){this.k_.includes(e)||(s>0?this.k_.push(e+"["+s+"]"):this.k_.push(e),this.l_.push(t))}addVertUniformParam(t){this.addVertUniform(t.type,t.name,t.arrayLength)}addFragUniform(t,e,s=0){this.AJ.includes(e)||(s>0?this.AJ.push(e+"["+s+"]"):this.AJ.push(e),this.n_.push(t))}addFragUniformParam(t){this.addFragUniform(t.type,t.name,t.arrayLength)}addVertAndFragUniform(t,e,s=0){this.addVertUniform(t,e,s),this.addFragUniform(t,e,s)}addFragFunction(t){this.q_.push(t)}addVertFunction(t){this.r_.push(t)}useTexturePreciseHighp(){this.v_="highp"}addTextureSample2D(t="",e=!0,s=!0,i=!1){if(""==t||!this.u_.includes(t)){this.Br.push("sampler2D"),this.u_.push(t),this.t_.push(this.v_);let a=0;s&&(a|=2),i&&(a|=4),this.w_.push(a),this.v_="",e&&(this.AH=!0)}}addTextureSampleCube(t="",e=!0,s=!1){if(""==t||!this.u_.includes(t)){this.Br.push("samplerCube"),this.u_.push(t),this.t_.push(this.v_);let i=0;e&&(i|=2),s&&(i|=4),this.w_.push(i),this.v_=""}}addTextureSample3D(t="",e=!0,s=!1){if(""==t||!this.u_.includes(t)){this.Br.push("sampler3D"),this.u_.push(t),this.t_.push(this.v_);let i=0;e&&(i|=2),s&&(i|=4),this.w_.push(i),this.v_=""}}isHaveTexture(){return this.Br.length>0}isHaveTexture2D(){return this.AH}useVertSpaceMats(t=!0,e=!0,s=!0){this.x_=t,this.y_=e,this.z_=s}useFragSpaceMats(t=!0,e=!0,s=!0){this.AA=t,this.AB=e,this.AC=s}addVertExtend(t){this.c_.push(t)}addFragExtend(t){this.b_.push(t)}addVertHeadCode(t){""!=t&&(this.AD+="\n"+t)}addVertMainCode(t){""!=t&&(this.AE+="\n"+t)}addFragHeadCode(t){""!=t&&(this.AF+="\n"+t)}addFragMainCode(t){""!=t&&(this.AG+="\n"+t)}addShaderObject(t){this.fragHeadCodeUnlock&&this.addFragHeadCode(t.frag_head),this.fragMainCodeUnlock&&this.addFragMainCode(t.frag_body),this.vertHeadCodeUnlock&&this.addVertHeadCode(t.vert_head),this.vertMainCodeUnlock&&this.addVertMainCode(t.vert_body)}addShaderObjectHead(t){this.fragHeadCodeUnlock&&this.addFragHeadCode(t.frag_head),this.vertHeadCodeUnlock&&this.addVertMainCode(t.vert_head)}autoBuildHeadCode(){this.addVertLayout("vec3","a_vs"),(this.AH||this.f_.includes("a_uvs"))&&(this.addVertLayout("vec2","a_uvs"),this.addVarying("vec2","v_uv")),(this.normalEnabled||this.normalMapEnabled||this.f_.includes("a_nvs"))&&(this.addVertLayout("vec3","a_nvs"),this.addVarying("vec3","v_worldNormal"),this.addVarying("vec3","v_worldPosition"),this.addDefine("VOX_USE_NORMAL"),this.vertMatrixInverseEnabled=!0);let t=["a_vs","a_uvs","a_nvs"],e=[],s=[];for(;t.length>0;){let i=this.f_.indexOf(t[0]);i>=0&&(e.push(this.f_[i]),s.push(this.g_[i]),this.f_.splice(i,1),this.g_.splice(i,1)),t.shift()}this.f_=e.concat(this.f_),this.g_=s.concat(this.g_),this.vtxUVTransfromEnabled&&this.addDefine("VOX_VTX_TRANSFORM_PARAM_INDEX","0")}buildFragCode(){this.autoBuildHeadCodeEnabled&&this.autoBuildHeadCode(),this.i_.length<1&&this.addFragOutput("vec4","FragColor0");let t=0,e=0,s="";for((a.default.FRAG_SHADER_PRECISION_GLOBAL_HIGHP_ENABLED||a.default.IsMobileWeb())&&this.useHighPrecious(),a.default.IsWebGL2()&&(s+=this.Z_),this.AI=new l.default,this.AI.info="\n//##COMPILE_INFO_BEGIN",this.AI.info+="\n//##COMPILE_INFO_END",t=0,e=this.b_.length;t<e;t++)s+="\n"+this.b_[t];for(a.default.IsWebGL1()&&(this.i_.length>1&&(s+="\n#extension GL_EXT_draw_buffers: require"),(this.normalMapEnabled||this.derivatives)&&(s+="\n#extension GL_OES_standard_derivatives : enable"),this.mapLodEnabled&&(s+="\n#extension GL_EXT_shader_texture_lod : enable")),a.default.IsMobileWeb()?s+="\nprecision highp float;":s+="\n"+this.a_,a.default.IsWebGL2()?(s+="\n#define VOX_GLSL_ES3 1",s+="\n#define VOX_IN in",this.mapLodEnabled&&(s+="\n#define VOX_TextureCubeLod textureLod",s+="\n#define VOX_Texture2DLod textureLod"),s+="\n#define VOX_Texture2D texture",s+="\n#define VOX_TextureCube texture"):(s+="\n#define VOX_GLSL_ES2 1",s+="\n#define VOX_IN varying",this.mapLodEnabled&&(s+="\n#define VOX_TextureCubeLod textureCubeLodEXT",s+="\n#define VOX_Texture2DLod texture2DLodEXT"),s+="\n#define VOX_TextureCube textureCube",s+="\n#define VOX_Texture2D texture2D"),this.mathDefineEanbled&&(s+=n.MathShaderCode.BasePredefined),e=this.d_.length,t=0;t<e;t++)""!=this.e_[t]?s+="\n#define "+this.d_[t]+" "+this.e_[t]:s+="\n#define "+this.d_[t]+" 1";for(t=0,e=this.u_.length;t<e;t++)""!=this.u_[t]&&0!=(2&this.w_[t])&&(s+="\n#define "+this.u_[t]+" u_sampler"+t);for(this.AH&&(s+="\n#define VOX_USE_2D_MAP 1"),t=0,e=this.Br.length;t<e;t++)0!=(2&this.w_[t])&&(""==this.t_[t]?s+="\nuniform "+this.Br[t]+" u_sampler"+t+";":s+="\nuniform "+this.t_[t]+" "+this.Br[t]+" u_sampler"+t+";");for(t=0,e=this.n_.length;t<e;t++)s+="\nuniform "+this.n_[t]+" "+this.AJ[t]+";";if(this.AA&&(s+="\nuniform mat4 u_objMat;"),this.AB&&(s+="\nuniform mat4 u_viewMat;"),this.AC&&(s+="\nuniform mat4 u_projMat;"),e=this.o_.length,a.default.IsWebGL2())for(t=0;t<e;t++)s+="\nin "+this.p_[t]+" "+this.o_[t]+";";else for(t=0;t<e;t++)s+="\nvarying "+this.p_[t]+" "+this.o_[t]+";";for(s+=n.ShaderCode.BasePredefined,this.fragMatrixInverseEnabled&&a.default.IsWebGL1()&&(this.addVertFunction(r.default.__glslInverseMat3),this.addVertFunction(r.default.__glslInverseMat4)),s+=this.AF,t=0,e=this.q_.length;t<e;t++)s+="\n"+this.q_[t];if(t=0,e=this.i_.length,a.default.IsWebGL2())for(;t<e;t++)""!=this.h_[t]?s+="\nlayout(location = "+t+") out "+this.h_[t]+" "+this.j_[t]+" "+this.i_[t]+";":s+="\nlayout(location = "+t+") out "+this.j_[t]+" "+this.i_[t]+";";else 1==e&&(s+="\n#define "+this.i_[t]+" gl_FragColor");let i=!1,_=this.AG.indexOf("{");if(_>0){let t=this.AG.slice(0,_);i=t.indexOf(" main")>0,i||(i=this.AG.indexOf(" main")>0)}if(i?s+=this.AG:(s+="\nvoid main() {\n",s+=this.AG,s+="\n}\n"),e=this.i_.length,a.default.IsWebGL1()&&e>1)for(t=0;t<e;t++){let e=new RegExp(this.i_[t],"g");s=s.replace(e,"gl_FragData["+t+"]")}return s}buildVertCode(){let t=0,e=0,s="";for(a.default.VERT_SHADER_PRECISION_GLOBAL_HIGHP_ENABLED&&this.useHighPrecious(),a.default.IsWebGL2()&&(s+=this.Z_),t=0,e=this.c_.length;t<e;t++)s+="\n"+this.c_[t];for(a.default.IsMobileWeb()?s+="\nprecision highp float;":s+="\n"+this.a_,a.default.IsWebGL2()?(s+="\n#define VOX_GLSL_ES3 1",s+="\n#define VOX_IN in",this.mapLodEnabled&&(s+="\n#define VOX_TextureCubeLod textureLod",s+="\n#define VOX_Texture2DLod textureLod"),s+="\n#define VOX_Texture2D texture",s+="\n#define VOX_TextureCube texture"):(s+="\n#define VOX_GLSL_ES2 1",s+="\n#define VOX_IN varying",this.mapLodEnabled&&(s+="\n#define VOX_TextureCubeLod textureCubeLodEXT",s+="\n#define VOX_Texture2DLod texture2DLodEXT"),s+="\n#define VOX_TextureCube textureCube",s+="\n#define VOX_Texture2D texture2D"),a.default.IsWebGL2()?s+="\n#define VOX_OUT out":s+="\n#define VOX_OUT varying",this.mathDefineEanbled&&(s+=n.MathShaderCode.BasePredefined),e=this.d_.length,t=0;t<e;t++)""!=this.e_[t]?s+="\n#define "+this.d_[t]+" "+this.e_[t]:s+="\n#define "+this.d_[t];for(t=0,e=this.u_.length;t<e;t++)""!=this.u_[t]&&0!=(4&this.w_[t])&&(s+="\n#define "+this.u_[t]+" u_sampler"+t);for(this.AH&&(s+="\n#define VOX_USE_2D_MAP 1"),t=0,e=this.Br.length;t<e;t++)0!=(4&this.w_[t])&&(""==this.t_[t]?s+="\nuniform "+this.Br[t]+" u_sampler"+t+";":s+="\nuniform "+this.t_[t]+" "+this.Br[t]+" u_sampler"+t+";");if(e=this.f_.length,a.default.IsWebGL2())for(t=0;t<e;t++)s+="\nlayout(location = "+t+") in "+this.g_[t]+" "+this.f_[t]+";";else for(t=0;t<e;t++)s+="\nattribute "+this.g_[t]+" "+this.f_[t]+";";for(e=this.l_.length,t=0;t<e;t++)s+="\nuniform "+this.l_[t]+" "+this.k_[t]+";";if(this.x_&&(s+="\nuniform mat4 u_objMat;"),this.y_&&(s+="\nuniform mat4 u_viewMat;"),this.z_&&(s+="\nuniform mat4 u_projMat;"),e=this.o_.length,a.default.IsWebGL2())for(t=0;t<e;t++)s+="\nout "+this.p_[t]+" "+this.o_[t]+";";else for(t=0;t<e;t++)s+="\nvarying "+this.p_[t]+" "+this.o_[t]+";";for(s+=n.ShaderCode.BasePredefined,s+=n.ShaderCode.VertPredefined,this.vertMatrixInverseEnabled&&a.default.IsWebGL1()&&(this.addVertFunction(r.default.__glslInverseMat3),this.addVertFunction(r.default.__glslInverseMat4)),s+=this.AD,t=0,e=this.r_.length;t<e;t++)s+="\n"+this.r_[t];let i=!1,l=this.AE.indexOf("{");if(l>0){let t=this.AE.slice(0,l);i=t.indexOf(" main")>0,i||(i=this.AE.indexOf(" main")>0)}return i?s+=this.AE:(s+="\nvoid main() {\n",s+=this.AE,s+="\n}\n"),s}}e.default=_},"4efa":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s("839a"),a=s("a9f4");class r{constructor(t){this.AK=null,this.AL=null,this.g=[],this.AK=t,this.AL=t.uniform}getCodeBuilder(){return this.AK}reset(){this.g=[]}getTextures(){return this.g}getTexturesTotal(){return this.g.length}addDiffuseMap(t){null!=t&&(this.AL.addDiffuseMap(),this.g.push(t))}addNormalMap(t){null!=t&&(this.AL.addNormalMap(),this.g.push(t))}addParallaxMap(t,e){null!=t&&(this.AL.addParallaxMap(e),this.g.push(t))}addDisplacementMap(t,e){null!=t&&(this.AL.addDisplacementMap(e),this.g.push(t))}addSpecularMap(t,e=i.SpecularMode.Default){null!=t&&(this.AL.addSpecularMap(e),this.g.push(t))}addShadowMap(t,e=a.ShadowMode.VSM){null!=t&&(this.AL.addShadowMap(e),this.g.push(t))}addSpecularEnvMap(t,e=!0){null!=t&&(this.AL.addSpecularEnvMap(e),this.g.push(t))}addAOMap(t){null!=t&&(this.AL.addAOMap(),this.g.push(t))}addRoughnessMap(t){null!=t&&(this.AL.addRoughnessMap(),this.g.push(t))}addMetalnessMap(t){null!=t&&(this.AL.addMetalnessMap(),this.g.push(t))}addARMMap(t){null!=t&&(this.AL.addARMMap(),this.g.push(t))}add2DMap(t,e="",s=!0,i=!0,a=!1){null!=t&&(this.AL.add2DMap(e,s,i,a),this.g.push(t))}addCubeMap(t,e="",s=!0,i=!1){null!=t&&(this.AL.addCubeMap(e,s,i),this.g.push(t))}add3DMap(t,e="",s=!0,i=!1){null!=t&&(this.AL.add3DMap(e,s,i),this.g.push(t))}}e.ShaderTextureBuilder=r},"519e":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("8a0a")),r=i(s("cb29")),l=i(s("e7d2")),n=i(s("fecb")),_=i(s("35fa"));class h extends r.default{constructor(t=a.default.VTX_STATIC_DRAW){super(t),this.AM=null,this.AN=!0,this.B_=null,this.C_=null,this.D_=null,this.E_=null,this.AO=null,this.AP=null,this.AQ=-2,this.vsStride=3,this.uvsStride=2,this.nvsStride=3,this.cvsStride=3}setVS(t){this.B_=t,this.AN=!0}getVS(){return this.B_}setUVS(t){this.C_=t}getUVS(){return this.C_}setNVS(t){this.D_=t}getNVS(){return this.D_}setTVS(t){this.AO=t}getTVS(){return this.AO}setBTVS(t){this.AP=t}setCVS(t){this.E_=t}getBTVS(){return this.AP}setIVS(t){this.AM=t,this.F_=t,this.AN=!0}initializeFromGeometry(t){this.B_=t.getVS(),this.C_=t.getUVS(),this.D_=t.getNVS(),this.AO=t.getTVS(),this.AP=t.getBTVS(),this.E_=t.getCVS(),this.F_=t.getIVS(),this.AM=this.F_,this.AN=!0,this.initialize()}initialize(){null!=this.B_&&(null==this.bounds?(this.bounds=new n.default,this.bounds.addXYZFloat32Arr(this.B_),this.bounds.update(),this.AQ=this.bounds.version):(this.AN||this.AQ==this.bounds.version)&&(this.bounds.reset(),this.bounds.addXYZFloat32Arr(this.B_),this.bounds.update(),this.AQ=this.bounds.version),this.AN=!1,this.F_=this.AM,l.default.Reset(),l.default.AddFloat32Data(this.B_,this.vsStride),this.isVBufEnabledAt(a.default.VBUF_UVS_INDEX)&&l.default.AddFloat32Data(this.C_,this.uvsStride),this.isVBufEnabledAt(a.default.VBUF_NVS_INDEX)&&(null==this.D_&&(this.vtCount=this.F_.length,this.trisNumber=this.vtCount/3,this.D_=new Float32Array(this.B_.length),_.default.ClacTrisNormal(this.B_,this.B_.length,this.trisNumber,this.F_,this.D_)),l.default.AddFloat32Data(this.D_,this.nvsStride)),this.isVBufEnabledAt(a.default.VBUF_CVS_INDEX)&&l.default.AddFloat32Data(this.E_,this.cvsStride),this.isVBufEnabledAt(a.default.VBUF_TVS_INDEX)&&(l.default.AddFloat32Data(this.AO,3),l.default.AddFloat32Data(this.AP,3)),l.default.vbWholeDataEnabled=this.vbWholeDataEnabled,this.updateWireframeIvs(),this.vtCount=this.F_.length,null!=this.H_?l.default.UpdateBufData(this.H_):this.H_=l.default.CreateBySaveData(this.getBufDataUsage(),this.getBufSortFormat()),this.H_.setUintIVSData(this.F_),this.trisNumber=this.vtCount/3,this.buildEnd())}testRay(t,e,s,i){return-1}toString(){return"[DataMesh()]"}__$destroy(){this.isResFree()&&(this.bounds=null,this.B_=null,this.C_=null,this.D_=null,this.E_=null,this.AO=null,this.AP=null,this.AM=null,super.__$destroy())}}e.default=h},5216:function(t,e,s){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t["ENV_LIGHT_PARAM"]=0]="ENV_LIGHT_PARAM",t[t["ENV_AMBIENT_LIGHT"]=1]="ENV_AMBIENT_LIGHT",t[t["FOG"]=2]="FOG",t[t["FOG_EXP2"]=3]="FOG_EXP2",t[t["VSM_SHADOW"]=4]="VSM_SHADOW",t[t["GLOBAL_LIGHT"]=5]="GLOBAL_LIGHT"}(i||(i={})),e.MaterialPipeType=i},"644c":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(){}static GetTypeByTypeNS(t){switch(t){case"mat4":return i.SHADER_MAT4;case"mat3":return i.SHADER_MAT3;case"mat2":return i.SHADER_MAT2;case"float":return i.SHADER_FLOAT;case"int":return i.SHADER_INT;case"vec4":return i.SHADER_VEC4;case"vec3":return i.SHADER_VEC3;case"vec2":return i.SHADER_VEC2;case"vec4[]":return i.SHADER_VEC4FV;case"vec3[]":return i.SHADER_VEC3FV;case"vec2[]":return i.SHADER_VEC2FV;case"sampler2D":return i.SHADER_SAMPLER2D;case"sampler3D":return i.SHADER_SAMPLER3D;case"samplerCube":return i.SHADER_SAMPLERCUBE;default:break}return i.SHADER_UNDEFINED}static GetTypeNSByType(t){switch(t){case i.SHADER_MAT4:return"mat4";case i.SHADER_MAT3:return"mat3";case i.SHADER_MAT2:return"mat2";case i.SHADER_FLOAT:return"float";case i.SHADER_VEC4:return"vec4";case i.SHADER_VEC3:return"vec3";case i.SHADER_VEC2:return"vec2";case i.SHADER_SAMPLER2D:return"sampler2D";case i.SHADER_SAMPLER3D:return"sampler3D";case i.SHADER_SAMPLERCUBE:return"samplerCube";case i.SHADER_UNDEFINED:return"undefined";default:break}return""}}i.ATTRINS_VTX_VS="a_vs",i.ATTRINS_VTX_UVS="a_uvs",i.ATTRINS_VTX_NVS="a_nvs",i.ATTRINS_VTX_CVS="a_cvs",i.UNIFORMNS_OBJ_MAT_NS="u_objMat",i.UNIFORMNS_VIEW_MAT_NS="u_viewMat",i.UNIFORMNS_PROJ_MAT_NS="u_projMat",i.SHADER_UNDEFINED=3010,i.SHADER_VEC2=3011,i.SHADER_VEC3=3012,i.SHADER_VEC4=3013,i.SHADER_VEC2FV=3014,i.SHADER_VEC3FV=3015,i.SHADER_VEC4FV=3016,i.SHADER_MAT2=3017,i.SHADER_MAT3=3018,i.SHADER_MAT4=3019,i.SHADER_FLOAT=3020,i.SHADER_INT=3021,i.SHADER_MAT2FV=3022,i.SHADER_MAT3FV=3023,i.SHADER_MAT4FV=3024,i.SHADER_SAMPLER2D=3031,i.SHADER_SAMPLERCUBE=3032,i.SHADER_SAMPLER3D=3033,i.SHADER_PRECISION_LOWP=3101,i.SHADER_PRECISION_MEDIUMP=3111,i.SHADER_PRECISION_HIGHP=3121,i.UNIFORM_TEX_SAMPLER2D="sampler2D",i.UNIFORM_TEX_SAMPLERCUBE="samplerCube",i.UNIFORM_TEX_SAMPLER3D="sampler3D",i.UNIFORMNS_TEX_SAMPLER_0="u_sampler0",i.UNIFORMNS_TEX_SAMPLER_1="u_sampler1",i.UNIFORMNS_TEX_SAMPLER_2="u_sampler2",i.UNIFORMNS_TEX_SAMPLER_3="u_sampler3",i.UNIFORMNS_TEX_SAMPLER_4="u_sampler4",i.UNIFORMNS_TEX_SAMPLER_5="u_sampler5",i.UNIFORMNS_TEX_SAMPLER_6="u_sampler6",i.UNIFORMNS_TEX_SAMPLER_7="u_sampler7",i.UNIFORMNS_TEX_SAMPLER_LIST=[i.UNIFORMNS_TEX_SAMPLER_0,i.UNIFORMNS_TEX_SAMPLER_1,i.UNIFORMNS_TEX_SAMPLER_2,i.UNIFORMNS_TEX_SAMPLER_3,i.UNIFORMNS_TEX_SAMPLER_4,i.UNIFORMNS_TEX_SAMPLER_5,i.UNIFORMNS_TEX_SAMPLER_6,i.UNIFORMNS_TEX_SAMPLER_7],e.default=i},"69ed":function(t,e,s){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t["VertHead"]="vertHead",t["VertBody"]="vertBody",t["FragHead"]="fragHead",t["FragBody"]="fragBody"}(i||(i={})),e.ShaderCodeType=i},"6c6b":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("0fc4")),r=i(s("faa5"));class l extends r.default{constructor(){super(),this.n="",this.decorator=null}initialize(t){super.initialize(t),this.n="MS_",t&&(this.n+="Tex")}createTextureList(){return this.AR.reset(),this.decorator.buildTextureList(this.AR),this.AR.getTextures()}buildShader(){null!=this.decorator.vertUniform&&this.decorator.vertUniform.use(this.A_y),this.decorator.buildShader(this.A_y)}getShaderCodeObjectUUID(){return this.decorator.getShaderCodeObjectUUID()}getShaderCodeObject(){return this.decorator.getShaderCodeObject()}getUniqueShaderName(){let t=this.n+this.decorator.getUniqueName();return null!=this.decorator.vertUniform&&(t+=this.decorator.vertUniform.getUniqueNSKeyString()),t}}class n extends a.default{constructor(){super(),this.AS=null,null==n.Bs&&(n.Bs=new l)}buildBuf(){let t=n.Bs,e=this.AS;t.decorator=e,e.buildBufParams(),t.vertColorEnabled=e.vertColorEnabled,t.premultiplyAlpha=e.premultiplyAlpha,t.shadowReceiveEnabled=e.shadowReceiveEnabled,t.lightEnabled=e.lightEnabled,t.fogEnabled=e.fogEnabled,t.envAmbientLightEnabled=e.envAmbientLightEnabled,t.brightnessOverlayEnabeld=e.brightnessOverlayEnabeld,t.glossinessEnabeld=e.glossinessEnabeld,t.buildPipelineParams();let s=t.createTextureList(),i=e.vertUniform;null!=i&&i.getTextures(t.getShaderCodeBuilder(),s),t.getTexturesFromPipeline(s),super.setTextureList(s)}getCodeBuf(){return n.Bs}setTextureList(t){}setDecorator(t){this.AS=t}getDecorator(){return this.AS}createSelfUniformData(){let t=this.AS.createUniformData();return t}destroy(){super.destroy(),this.AS=null}}n.Bs=null,e.Material=n},"6e01":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{static Clamp(t,e,s){return Math.max(Math.min(t,s),e)}static IsPowerOf2(t){return 0==(t&t-1)}static CalcCeilPowerOfTwo(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}static CalcNearestCeilPow2(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))}static CalcFloorCeilPow2(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}static DegreeToRadian(t){return i.MATH_PI_OVER_180*t}static Log2(t){return Math.log(t)/Math.LN2}static GetMaxMipMapLevel(t,e){return Math.round(i.Log2(Math.max(t,e))+1)}static SafeACos(t){return t<=-1?i.MATH_PI:t>=1?0:Math.acos(t)}static GetNearestCeilPow2(t){let e=1;while(e<t)e<<=1;return e}static GetMinRadian(t,e){return e%=i.MATH_2PI,t%=i.MATH_2PI,e<t?(e=i.MATH_2PI-t+e,e>i.MATH_PI?e-i.MATH_2PI:e):e>t?(t=i.MATH_2PI-e+t,t>i.MATH_PI?i.MATH_2PI-t:-t):0}static GetMinDegree(t,e){let s=0;return e>=270&&t<90?s=(e-(t+360))%180:e<=90&&t>=270?s=(e+360-t)%180:(s=e-t,s>180?(s-=360,s%=360):s<-180&&(s+=360,s%=360)),s}static GetDegreeByXY(t,e){if(Math.abs(t)<1e-5)return e>=0?270:90;let s=180*Math.atan(e/t)/Math.PI;return t>=0?s:180+s}static GetRadianByXY(t,e){if(Math.abs(t)<i.MATH_MIN_POSITIVE)return e>=0?i.MATH_1PER2PI:i.MATH_3PER2PI;let s=Math.atan(e/t);return t>=0?s:i.MATH_PI+s}static GetRadianByCos(t,e,s){var a=Math.acos(t);return e>=0?a:i.MATH_PI+a}}i.MATH_MIN_POSITIVE=1e-5,i.MATH_MAX_NEGATIVE=-1e-5,i.MATH_MAX_POSITIVE=268435454,i.MATH_MIN_NEGATIVE=-268435454,i.MATH_1_OVER_255=1/255,i.MATH_PI=Math.PI,i.MATH_2PI=2*i.MATH_PI,i.MATH_3PER2PI=1.5*i.MATH_PI,i.MATH_1PER2PI=.5*i.MATH_PI,i.MATH_1_OVER_PI=1/i.MATH_PI,i.MATH_1_OVER_360=1/360,i.MATH_1_OVER_180=1/180,i.MATH_180_OVER_PI=180/i.MATH_PI,i.MATH_PI_OVER_180=i.MATH_PI/180,i.MATH_LN2=.6931471805599453,e.default=i},"710f":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(){if(this.AT=[],this.AU=[],null!=i.Bt)throw Error("ROVtxBufUidStore is a singleton class!!");i.Bt=this}static GetInstance(){return i.Bt}__$getRemovedListLen(){return this.AU.length}__$getRemovedList(){return this.AU}__$attachAt(t){if(t<this.AT.length)++this.AT[t];else{let e=this.AT.length;for(;e<=t;++e)this.AT.push(0);++this.AT[t]}}__$detachAt(t){--this.AT[t],this.AT[t]<1&&(this.AT[t]=0,this.AU.push(t))}getAttachCountAt(t){return t<this.AT.length?this.AT[t]:0}getAttachAllCount(){let t=0,e=0,s=this.AT.length;for(;e<s;++e)this.AT[e]>0&&(t+=this.AT[e]);return t}}i.Bt=null,e.default=i},"76b0":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("35fa")),r=i(s("8a0a")),l=i(s("fecb")),n=i(s("cb29")),_=i(s("e7d2")),h=s("e08e"),o=i(s("3930")),u=s("e160");class m extends n.default{constructor(t=r.default.VTX_STATIC_DRAW){super(t),this.color0=new o.default,this.color1=new o.default,this.color2=new o.default,this.color3=new o.default,this.offsetU=0,this.offsetV=0,this.uScale=1,this.vScale=1,this.flipVerticalUV=!1,this.axisFlag=0,this.AV=!0,this.B_=null,this.C_=null,this.D_=null,this.E_=null,this.AO=null,this.AP=null,this.vsFloat32=null,this.dataStepList=null}getVS(){return this.B_}getUVS(){return this.C_}setUVS(t){null!=t&&8==t.length&&(null==this.C_?this.C_=t.slice(0):this.C_.set(t))}getNVS(){return this.D_}getCVS(){return this.E_}initialize(t,e,s,i){if(null!=this.B_)return;let n=t,o=e,u=t+s,m=e+i,d=0;switch(this.F_=new Uint16Array([0,1,2,0,2,3]),this.axisFlag){case 0:this.B_=new Float32Array([n,o,d,u,o,d,u,m,d,n,m,d]);break;case 1:this.B_=new Float32Array([u,d,o,n,d,o,n,d,m,u,d,m]);break;case 2:this.B_=new Float32Array([d,n,o,d,u,o,d,u,m,d,n,m]);break;default:break}if(null==this.bounds&&(this.bounds=new l.default),this.bounds.addXYZFloat32Arr(this.B_),this.bounds.updateFast(),_.default.Reset(),_.default.AddFloat32Data(this.B_,3),null==this.C_&&this.isVBufEnabledAt(r.default.VBUF_UVS_INDEX)&&(this.flipVerticalUV?this.C_=new Float32Array([this.offsetU+0*this.uScale,this.offsetV+1*this.vScale,this.offsetU+1*this.uScale,this.offsetV+1*this.vScale,this.offsetU+1*this.uScale,this.offsetV+0*this.vScale,this.offsetU+0*this.uScale,this.offsetV+0*this.vScale]):this.C_=new Float32Array([this.offsetU+0*this.uScale,this.offsetV+0*this.vScale,this.offsetU+1*this.uScale,this.offsetV+0*this.vScale,this.offsetU+1*this.uScale,this.offsetV+1*this.vScale,this.offsetU+0*this.uScale,this.offsetV+1*this.vScale])),this.isVBufEnabledAt(r.default.VBUF_NVS_INDEX))switch(this.axisFlag){case 0:this.D_=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1]);break;case 1:this.D_=new Float32Array([0,1,0,0,1,0,0,1,0,0,1,0]);break;case 2:this.D_=new Float32Array([1,0,0,1,0,0,1,0,0,1,0,0]);break;default:break}if(this.isVBufEnabledAt(r.default.VBUF_CVS_INDEX)&&(this.E_=new Float32Array([this.color0.r,this.color0.g,this.color0.b,this.color1.r,this.color1.g,this.color1.b,this.color2.r,this.color2.g,this.color2.b,this.color3.r,this.color3.g,this.color3.b])),this.isVBufEnabledAt(r.default.VBUF_TVS_INDEX)){let t=2;this.AO=new Float32Array(12),this.AP=new Float32Array(12),a.default.ClacTrisTangent(this.B_,this.B_.length,this.C_,this.D_,t,this.F_,this.AO,this.AP)}this.drawMode=h.RenderDrawMode.ELEMENTS_TRIANGLES,this.buildVbuf(),this.vtxTotal=4,this.trisNumber=2,this.buildEnd()}reinitialize(){this.buildVbuf()}buildVbuf(){_.default.Reset(),_.default.AddFloat32Data(this.B_,3),this.isVBufEnabledAt(r.default.VBUF_UVS_INDEX)&&_.default.AddFloat32Data(this.C_,2),this.isVBufEnabledAt(r.default.VBUF_NVS_INDEX)&&_.default.AddFloat32Data(this.D_,3),this.isVBufEnabledAt(r.default.VBUF_CVS_INDEX)&&_.default.AddFloat32Data(this.E_,3),this.isVBufEnabledAt(r.default.VBUF_TVS_INDEX)&&(_.default.AddFloat32Data(this.AO,3),_.default.AddFloat32Data(this.AP,3)),_.default.vbWholeDataEnabled=this.vbWholeDataEnabled,this.updateWireframeIvs(),this.vtCount=this.F_.length,null!=this.H_?(this.forceUpdateIVS&&this.H_.setUintIVSData(this.F_),_.default.UpdateBufData(this.H_)):this.H_=_.default.CreateBySaveData(this.getBufDataUsage(),this.getBufSortFormat()),this.H_.setUintIVSData(this.F_),this.buildEnd()}isPolyhedral(){return this.AV}setPolyhedral(t){this.AV=t}testRay(t,e,s,i){if(this.AV)return-1;if(i){let i=u.AABBCalc.IntersectionRL2(e,t,this.bounds,s);return i?1:-1}return-1}toString(){return"[RectPlaneMesh()]"}__$destroy(){this.isResFree()&&(this.bounds=null,this.B_=null,this.C_=null,this.D_=null,this.E_=null,super.__$destroy())}}e.default=m},"78e9":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("644c"));class r{constructor(){this.type=-1,this.typeName="",this.name="",this.isArray=!1,this.arrLength=0,this.isTex=!1,this.location=null}parseCode(t){const e=";";let s=t.indexOf(e);if(s<0)return!1;const i=" ";t=t.replace(/^\s*|\s*$/g,""),s>0&&(t=t.slice(0,s));let r=t.split(i);return this.typeName=r[r.length-2],this.name=r[r.length-1],s=this.name.indexOf("["),this.isArray=s>0,this.arrLength=0,this.isArray&&(this.arrLength=parseInt(this.name.slice(s+1,this.name.indexOf("]",s+1))),this.name=this.name.slice(0,s),this.typeName+="[]"),this.type=a.default.GetTypeByTypeNS(this.typeName),!(this.type<0)&&(this.isTex=this.type==a.default.SHADER_SAMPLER2D||this.type==a.default.SHADER_SAMPLERCUBE||this.type==a.default.SHADER_SAMPLER3D,!0)}}e.default=r},"7a04":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("f044"));class r{constructor(){this.A=-1,this.AW=0,this.layoutBit=0,this.AX=null,this.AY=null,this.AZ=null,this.Aa=null,this.Ab=null,this.Ac=0,this.A=a.default.CreateNewID()}getUid(){return this.A}getType(){return 1}getBuffersTotal(){return this.Ac}getAttribsTotal(){return this.Ac}getF32DataAt(t){return this.AY[t]}setF32DataAt(t,e,s,i){this.Ac=t<1?1:t+1,null==this.AY&&(this.AY=[null,null,null,null,null,null,null,null],this.Aa=[!1,!1,!1,!1,!1,!1,!1,!1],this.AZ=[0,0,0,0,0,0,0,0]),this.AY[t]=e,null!=this.Ab&&null!=e&&(this.Aa[t]=!0),null!=i&&(this.AX=i),null!=e&&(this.AZ[t]=e.length)}setData4fAt(t,e,s,i,a,r){t*=this.AX[e],this.AY[e][t++]=s,this.AY[e][t++]=i,this.AY[e][t++]=a,this.AY[e][t++]=r}setData3fAt(t,e,s,i,a){t*=this.AX[e],this.AY[e][t++]=s,this.AY[e][t++]=i,this.AY[e][t++]=a}setData2fAt(t,e,s,i){t*=this.AX[e],this.AY[e][t++]=s,this.AY[e][t++]=i}destroy(){this.AY=null,this.Aa=null,this.AZ=null,this.AY=null}toString(){return"VtxSeparatedBuf(uid = "+this.A+")"}}e.default=r},"81ce":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{static Es2VtxShderToES3(t){let e=t;const s="attribute",i="varying ";let a=e.indexOf(s),r=0;while(a>=0)e=e.slice(0,a)+"layout(location="+r+") in"+e.slice(a+9),a=e.indexOf(s),r++;let l=new RegExp(i,"g");return e=e.replace(l,"out "),"#version 300 es\n"+e}static Es2FragShderToES3(t){let e=t;const s="gl_FragColor",i="varying ";let a=e.indexOf(s),r=0,l="FragColorOut_"+r;a>=0&&(e=e.slice(0,a)+l+e.slice(a+12)),a=e.indexOf("void "),e=e.slice(0,a)+"out vec4 "+l+";\n"+e.slice(a);let n=new RegExp(i,"g");return e=e.replace(n,"in "),n=new RegExp(" texture2D","g"),e=e.replace(n," texture"),n=new RegExp(" textureCube","g"),e=e.replace(n," texture"),"#version 300 es\n"+e}static Es3VtxShaderToES2(t){const e=/^#.+(\bes|core\b)/;t=t.replace(e,"");const s=/\blayout\b.+\bin\b/g;t=t.replace(s,"attribute");const a=/\bout\b/g;t=t.replace(a,"varying");const r=/\btexture\b/g;t=t.replace(r,"texture2D"),t.indexOf("#version")>=0&&(t=t.replace("#version","//#version"));let l=0,n=0,_=t.indexOf("inverse(");_<0&&(_=t.indexOf("inverse ("));let h="",o=!1,u=!1;while(_>3){if(l=t.indexOf(")",_+2),h=t.slice(_+2,l),h.indexOf("mat3")>0)o=!0;else if(h=h.replace(/\s+/g,""),l=h.indexOf("("),h=h.slice(l+1),l=t.indexOf(h,1),n=t.lastIndexOf("mat",l),n>0)switch(h=t.slice(n,l),h=h.replace(/\s+/g,""),h){case"mat3":o=!0;break;case"mat4":u=!0;break}if(_=t.indexOf("inverse(",_+5),_<0&&(_=t.indexOf("inverse (",_+5)),o&&u)break}l=0,_=t.indexOf("transpose("),_<0&&(_=t.indexOf("transpose (")),h="";let m=!1,d=!1;while(_>3){if(l=t.indexOf(")",_+2),h=t.slice(_+2,l+1),h.indexOf("mat3")>0)m=!0;else if(h=h.replace(/\s+/g,""),l=h.indexOf("("),h=h.slice(l+1),l=t.indexOf(h,1),n=t.lastIndexOf("mat",l),n>0)switch(h=t.slice(n,l),h=h.replace(/\s+/g,""),h){case"mat3":m=!0;break;case"mat4":d=!0;break}if(_=t.indexOf("transpose(",_+5),_<0&&(_=t.indexOf("transpose (",_+5)),m&&d)break}return(o||u)&&(_=t.indexOf("void "),_>10&&(o&&u?t=t.slice(0,_)+i.__glslInverseMat3+i.__glslInverseMat4+t.slice(_):o?t=t.slice(0,_)+i.__glslInverseMat3+t.slice(_):u&&(t=t.slice(0,_)+i.__glslInverseMat4+t.slice(_)))),(m||d)&&(_=t.indexOf("void "),_>10&&(m&&d?t=t.slice(0,_)+i.__glslTransposeMat3+i.__glslTransposeMat4+t.slice(_):m?t=t.slice(0,_)+i.__glslTransposeMat3+t.slice(_):d&&(t=t.slice(0,_)+i.__glslTransposeMat4+t.slice(_)))),t}static Es3FragShaderToES2(t){const e=/^#.+(\bes|core\b)/;t=t.replace(e,"");const s=new RegExp(" in ","g");t=t.replace(s,"_fref_");const i=/\bin\b/g;t=t.replace(i,"varying");const a=new RegExp("_fref_","g");t=t.replace(a," in ");const r=/\btexture\b/g;t=t.replace(r,"texture2D");const l=/" "/g;let n=t;const _=";",h="layout";let o=n.indexOf(h),u=0,m=0,d="",c="",f=0,p=null,S=[],g=[];while(o>=0)u=n.indexOf(_,o+1),d=n.slice(o+1,u),c=d.slice(d.lastIndexOf(" ")+1),f=d.indexOf(")"),o=d.lastIndexOf("=",f)+1,d=d.slice(o+1,f),f=parseInt(d.replace(l,"")),S.push(c),g.push(f),o=n.indexOf(h,u);let M=S.length;if(M>0)if(p=/layout/g,t=t.replace(p,"//layout"),M>1){o=0;while(o<M)p=new RegExp(S[o],"g"),t=t.replace(p,"gl_FragData["+g[o]+"]"),++o}else p=new RegExp(c,"g"),t=t.replace(p,"gl_FragColor");else o=n.indexOf("out "),o>0&&(u=n.indexOf(_,o+1),d=n.slice(o+1,u),c=d.slice(d.lastIndexOf(" ")+1),p=new RegExp(c,"g"),t=t.replace(p,"gl_FragColor"),p=/\bout\b/g,t=t.replace(p,"//out"));M>1&&(t="#extension GL_EXT_draw_buffers: require\n"+t),t.indexOf("#version")>=0&&(t=t.replace("#version","//#version")),o=0;for(let E=0;E<16;++E){if(o=t.indexOf("samplerCube ",o),!(o>0))break;{u=t.indexOf(";",o),d=n.slice(o+12,u),c="";let e=d.split(" ");for(let t=0;t<16;++t)if(""!=e[t]){c=e[t];break}for(M=0;M<16;++M){if(u=t.indexOf(c,u+1),!(u>0))break;if(m=t.lastIndexOf("texture2D",u-1),m<0)break;d=t.slice(m,u),t=t.slice(0,m)+"textureCube("+t.slice(u),u+=2}}o+=4}return t}}i.__glslTransposeMat3="\n    mat3 transpose(mat3 m) {\n        return mat3(m[0][0],m[1][0],m[2][0],\n            m[0][1],m[1][1],m[2][1],\n            m[0][2],m[1][2],m[2][2]);\n    }\n    ",i.__glslTransposeMat4="\n    mat4 transpose(mat4 m) {\n        return mat4(m[0][0],m[1][0],m[2][0],m[3][0],\n            m[0][1],m[1][1],m[2][1],m[3][1],\n            m[0][2],m[1][2],m[2][2],m[3][2],\n            m[0][3],m[1][3],m[2][3],m[3][3]);\n    }\n    ",i.__glslInverseMat3="\n    mat3 inverse(mat3 m) {\n        float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n        float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n        float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];  \n        float b01 = a22 * a11 - a12 * a21;\n        float b11 = -a22 * a10 + a12 * a20;\n        float b21 = a21 * a10 - a11 * a20;  \n        float det = a00 * b01 + a01 * b11 + a02 * b21;  \n        return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n                    b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n                    b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n    }\n    ",i.__glslInverseMat4="\n    mat4 inverse(mat4 m) {\n        float\n            a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n            a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n            a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n            a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n            b00 = a00 * a11 - a01 * a10,\n            b01 = a00 * a12 - a02 * a10,\n            b02 = a00 * a13 - a03 * a10,\n            b03 = a01 * a12 - a02 * a11,\n            b04 = a01 * a13 - a03 * a11,\n            b05 = a02 * a13 - a03 * a12,\n            b06 = a20 * a31 - a21 * a30,\n            b07 = a20 * a32 - a22 * a30,\n            b08 = a20 * a33 - a23 * a30,\n            b09 = a21 * a32 - a22 * a31,\n            b10 = a21 * a33 - a23 * a31,\n            b11 = a22 * a33 - a23 * a32,\n            det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n        return mat4(\n            a11 * b11 - a12 * b10 + a13 * b09,\n            a02 * b10 - a01 * b11 - a03 * b09,\n            a31 * b05 - a32 * b04 + a33 * b03,\n            a22 * b04 - a21 * b05 - a23 * b03,\n            a12 * b08 - a10 * b11 - a13 * b07,\n            a00 * b11 - a02 * b08 + a03 * b07,\n            a32 * b02 - a30 * b05 - a33 * b01,\n            a20 * b05 - a22 * b02 + a23 * b01,\n            a10 * b10 - a11 * b08 + a13 * b06,\n            a01 * b08 - a00 * b10 - a03 * b06,\n            a30 * b04 - a31 * b02 + a33 * b00,\n            a21 * b02 - a20 * b04 - a23 * b00,\n            a11 * b07 - a10 * b09 - a12 * b06,\n            a00 * b09 - a01 * b07 + a02 * b06,\n            a31 * b01 - a30 * b03 - a32 * b00,\n            a20 * b03 - a21 * b01 + a22 * b00) / det;\n        }\n    ",e.default=i},"839a":function(t,e,s){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t["Default"]=1]="Default",t[t["FragColor"]=2]="FragColor",t[t["SpecularMapColor"]=3]="SpecularMapColor"}(i||(i={})),e.SpecularMode=i},8875:function(t,e,s){var i,a,r;(function(s,l){a=[],i=l,r="function"===typeof i?i.apply(e,a):i,void 0===r||(t.exports=r)})("undefined"!==typeof self&&self,(function(){function t(){var e=Object.getOwnPropertyDescriptor(document,"currentScript");if(!e&&"currentScript"in document&&document.currentScript)return document.currentScript;if(e&&e.get!==t&&document.currentScript)return document.currentScript;try{throw new Error}catch(d){var s,i,a,r=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,l=/@([^@]*):(\d+):(\d+)\s*$/gi,n=r.exec(d.stack)||l.exec(d.stack),_=n&&n[1]||!1,h=n&&n[2]||!1,o=document.location.href.replace(document.location.hash,""),u=document.getElementsByTagName("script");_===o&&(s=document.documentElement.outerHTML,i=new RegExp("(?:[^\\n]+?\\n){0,"+(h-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),a=s.replace(i,"$1").trim());for(var m=0;m<u.length;m++){if("interactive"===u[m].readyState)return u[m];if(u[m].src===_)return u[m];if(_===o&&u[m].innerHTML&&u[m].innerHTML.trim()===a)return u[m]}return null}}return t}))},"8a0a":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("ca6c"));class r{static ToGL(t,e){switch(e){case r.VTX_STATIC_DRAW:return t.STATIC_DRAW;case r.VTX_DYNAMIC_DRAW:return t.DYNAMIC_DRAW;case r.VTX_STREAM_DRAW:return t.STREAM_DRAW;case r.VTX_STATIC_READ:return t.STATIC_READ;case r.VTX_DYNAMIC_READ:return t.DYNAMIC_READ;case r.VTX_STREAM_READ:return t.STREAM_READ;case r.VTX_STATIC_COPY:return t.STATIC_COPY;case r.VTX_DYNAMIC_COPY:return t.DYNAMIC_COPY;case r.VTX_STREAM_COPY:return t.STREAM_COPY;default:break}return t.STATIC_DRAW}static GetVBufTypeByNS(t){switch(t){case r.VBUF_VS_NS:return r.VBUF_VS;case r.VBUF_UVS_NS:return r.VBUF_UVS;case r.VBUF_NVS_NS:return r.VBUF_NVS;case r.VBUF_CVS_NS:return r.VBUF_CVS;case r.VBUF_VS2_NS:return r.VBUF_VS2;case r.VBUF_UVS2_NS:return r.VBUF_UVS2;case r.VBUF_NVS2_NS:return r.VBUF_NVS2;case r.VBUF_CVS2_NS:return r.VBUF_CVS2;case r.VBUF_TVS_NS:return r.VBUF_TVS;case r.VBUF_TVS2_NS:return r.VBUF_TVS2;default:}return-1}static GetVBufNSByType(t){switch(t){case r.VBUF_VS:return r.VBUF_VS_NS;case r.VBUF_UVS:return r.VBUF_UVS_NS;case r.VBUF_NVS:return r.VBUF_NVS_NS;case r.VBUF_CVS:return r.VBUF_CVS_NS;case r.VBUF_VS2:return r.VBUF_VS2_NS;case r.VBUF_UVS2:return r.VBUF_UVS2_NS;case r.VBUF_NVS2:return r.VBUF_NVS2_NS;case r.VBUF_CVS2:return r.VBUF_CVS2_NS;case r.VBUF_TVS:return r.VBUF_TVS_NS;case r.VBUF_TVS2:return r.VBUF_TVS2_NS;default:}return""}static GetVBufAttributeTypeByNS(t){return r.GetVBufTypeByNS(t)-3e3}static GetVBufAttributeTypeByVBufType(t){return t-3e3}}r.VTXTYPE_GL_POINTS=101,r.VTXTYPE_GL_LINES=102,r.VTXTYPE_GL_LINE_STRIP=103,r.VTXTYPE_GL_TRIANGLES=111,r.VTX_STATIC_DRAW=0,r.VTX_DYNAMIC_DRAW=1,r.VTX_STREAM_DRAW=2,r.VTX_STATIC_READ=3,r.VTX_DYNAMIC_READ=4,r.VTX_STREAM_READ=5,r.VTX_STATIC_COPY=6,r.VTX_DYNAMIC_COPY=7,r.VTX_STREAM_COPY=8,r.VBUF_VS=3001,r.VBUF_UVS=3002,r.VBUF_NVS=3003,r.VBUF_CVS=3004,r.VBUF_TVS=3005,r.VBUF_VS2=3006,r.VBUF_UVS2=3007,r.VBUF_NVS2=3008,r.VBUF_CVS2=3009,r.VBUF_TVS2=3010,r.VBUF_VS_INDEX=a.default.BIT_ONE_0,r.VBUF_UVS_INDEX=a.default.BIT_ONE_1,r.VBUF_NVS_INDEX=a.default.BIT_ONE_2,r.VBUF_CVS_INDEX=a.default.BIT_ONE_3,r.VBUF_TVS_INDEX=a.default.BIT_ONE_4,r.VBUF_VS2_INDEX=a.default.BIT_ONE_5,r.VBUF_UVS2_INDEX=a.default.BIT_ONE_6,r.VBUF_NVS2_INDEX=a.default.BIT_ONE_7,r.VBUF_CVS2_INDEX=a.default.BIT_ONE_8,r.VBUF_TVS2_INDEX=a.default.BIT_ONE_9,r.VBUF_VS_NS="a_vs",r.VBUF_VS2_NS="a_vs2",r.VBUF_UVS_NS="a_uvs",r.VBUF_UVS2_NS="a_uvs2",r.VBUF_NVS_NS="a_nvs",r.VBUF_NVS2_NS="a_nvs2",r.VBUF_CVS_NS="a_cvs",r.VBUF_CVS2_NS="a_cvs2",r.VBUF_TVS_NS="a_tvs",r.VBUF_TVS2_NS="a_tvs2";class l{}l.FLAT=210,l.GOURAND=310,e.VtxNormalType=l,e.default=r},"8d98":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("3b73")),r=i(s("030e"));class l{static ToGL(t,e){switch(e){case l.RGBA:break;case l.R8:return t.R8;case l.RGB:return t.RGB;case l.RGB8:return t.RGB8;case l.RGBA8:return t.RGBA8;case l.ALPHA:return t.ALPHA;case l.RGB16F:return a.default.IsWebGL2()?t.RGB16F:t.RGB;case l.RGBA16F:return a.default.IsWebGL2()?t.RGBA16F:t.RGBA;case l.RGB32F:return a.default.IsWebGL2()&&t.RGB32F,t.RGB;case l.RGBA32F:return a.default.IsWebGL2()&&t.RGBA32F,t.RGBA;case l.RED:return t.RED;case l.DEPTH_COMPONENT:return t.DEPTH_COMPONENT;case l.DEPTH_STENCIL:return t.DEPTH_STENCIL;default:break}return t.RGBA}}l.R8=101,l.RGB=110,l.RED=111,l.RGBA=121,l.RGB8=122,l.RGBA8=123,l.ALPHA=132,l.RGB16F=331,l.RGBA16F=332,l.RGB32F=341,l.RGBA32F=342,l.DEPTH_COMPONENT=351,l.DEPTH_STENCIL=352,e.TextureFormat=l;class n{static ToGL(t,e){switch(e){case n.UNSIGNED_BYTE:return t.UNSIGNED_BYTE;case n.BYTE:return t.BYTE;case n.FLOAT:return t.FLOAT;case n.HALF_FLOAT:return t.HALF_FLOAT;case n.HALF_FLOAT_OES:return null!=r.default.OES_texture_half_float?r.default.OES_texture_half_float.HALF_FLOAT_OES:t.FLOAT;case n.UNSIGNED_SHORT:return t.UNSIGNED_SHORT;case n.UNSIGNED_INT:return t.UNSIGNED_INT;case n.UNSIGNED_SHORT_5_6_5:return t.UNSIGNED_SHORT_5_6_5;case n.UNSIGNED_SHORT_4_4_4_4:return t.UNSIGNED_SHORT_4_4_4_4;case n.UNSIGNED_SHORT_5_5_5_1:return t.UNSIGNED_SHORT_5_5_5_1;case n.UNSIGNED_INT_24_8_WEBGL:return r.default.WEBGL_depth_texture.UNSIGNED_INT_24_8_WEBGL;default:break}return t.UNSIGNED_BYTE}}n.UNSIGNED_BYTE=1108,n.UNSIGNED_SHORT=1109,n.UNSIGNED_INT=1110,n.BYTE=1111,n.FLOAT=1211,n.HALF_FLOAT=1212,n.HALF_FLOAT_OES=1213,n.UNSIGNED_SHORT_5_6_5=1214,n.UNSIGNED_SHORT_4_4_4_4=1215,n.UNSIGNED_SHORT_5_5_5_1=1216,n.UNSIGNED_INT_24_8_WEBGL=1217,e.TextureDataType=n;class _{static GetValue(t,e){switch(e){case _.TEXTURE_2D:return t.TEXTURE_2D;case _.TEXTURE_2D_ARRAY:return t.TEXTURE_2D_ARRAY;case _.TEXTURE_CUBE:return t.TEXTURE_CUBE_MAP;case _.TEXTURE_3D:return t.TEXTURE_3D;default:break}return t.TEXTURE_2D}}_.TEXTURE_2D=20,_.TEXTURE_2D_ARRAY=22,_.TEXTURE_SHADOW_2D=23,_.TEXTURE_CUBE=25,_.TEXTURE_3D=30,e.TextureTarget=_;class h{static GetConst(t,e){switch(e){case h.NEAREST:return t.NEAREST;case h.LINEAR:return t.LINEAR;case h.LINEAR_MIPMAP_LINEAR:return t.LINEAR_MIPMAP_LINEAR;case h.NEAREST_MIPMAP_NEAREST:return t.NEAREST_MIPMAP_NEAREST;case h.LINEAR_MIPMAP_NEAREST:return t.LINEAR_MIPMAP_NEAREST;case h.NEAREST_MIPMAP_LINEAR:return t.NEAREST_MIPMAP_LINEAR;case h.WRAP_REPEAT:return t.REPEAT;case h.WRAP_CLAMP_TO_EDGE:return t.CLAMP_TO_EDGE;case h.WRAP_MIRRORED_REPEAT:return t.MIRRORED_REPEAT;default:break}return-1}}h.WRAP_REPEAT=3001,h.WRAP_CLAMP_TO_EDGE=3002,h.WRAP_MIRRORED_REPEAT=3003,h.NEAREST=4001,h.LINEAR=4002,h.LINEAR_MIPMAP_LINEAR=4003,h.NEAREST_MIPMAP_NEAREST=4004,h.LINEAR_MIPMAP_NEAREST=4005,h.NEAREST_MIPMAP_LINEAR=4006,e.TextureConst=h},"8e17":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=180/Math.PI,a=1e-5;class r{constructor(t=0,e=0,s=0,i=1){this.x=0,this.y=0,this.z=0,this.w=0,this.x=t,this.y=e,this.z=s,this.w=i}clone(){return new r(this.x,this.y,this.z,this.w)}setTo(t,e,s,i=1){this.x=t,this.y=e,this.z=s,this.w=i}setXYZ(t,e,s){this.x=t,this.y=e,this.z=s}copyFrom(t){this.x=t.x,this.y=t.y,this.z=t.z}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}multBy(t){this.x*=t.x,this.y*=t.y,this.z*=t.z}normalize(){let t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);t>a&&(this.x/=t,this.y/=t,this.z/=t)}normalizeTo(t){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);e>a?(t.x=this.x/e,t.y=this.y/e,t.z=this.z/e):(t.x=this.x,t.y=this.y,t.z=this.z)}scaleVector(t){this.x*=t.x,this.y*=t.y,this.z*=t.z}scaleBy(t){this.x*=t,this.y*=t,this.z*=t}negate(){this.x=-this.x,this.y=-this.y,this.z=-this.z}equalsXYZ(t){return Math.abs(this.x-t.x)<a&&Math.abs(this.y-t.y)<a&&Math.abs(this.z-t.z)<a}equalsAll(t){return Math.abs(this.x-t.x)<a&&Math.abs(this.y-t.y)<a&&Math.abs(this.z-t.z)<a&&Math.abs(this.w-t.w)<a}project(){let t=1/this.w;this.x*=t,this.y*=t,this.z*=t}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}getLengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}addBy(t){this.x+=t.x,this.y+=t.y,this.z+=t.z}subtractBy(t){this.x-=t.x,this.y-=t.y,this.z-=t.z}subtract(t){return new r(this.x-t.x,this.y-t.y,this.z-t.z)}add(t){return new r(this.x+t.x,this.y+t.y,this.z+t.z)}crossProduct(t){return new r(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}crossBy(t){let e=this.y*t.z-this.z*t.y,s=this.z*t.x-this.x*t.z,i=this.x*t.y-this.y*t.x;this.x=e,this.y=s,this.z=i}reflectBy(t){let e=2*(this.x*t.x+this.y*t.y+this.z*t.z);this.x=this.x-e*t.x,this.y=this.y-e*t.y,this.z=this.z-e*t.z}scaleVecTo(t,e){this.x=t.x*e,this.y=t.y*e,this.z=t.z*e}subVecsTo(t,e){this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z}addVecsTo(t,e){this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z}crossVecsTo(t,e){this.x=t.y*e.z-t.z*e.y,this.y=t.z*e.x-t.x*e.z,this.z=t.x*e.y-t.y*e.x}toString(){return"Vector3D("+this.x+this.y+this.z+")"}static Cross(t,e,s){s.x=t.y*e.z-t.z*e.y,s.y=t.z*e.x-t.x*e.z,s.z=t.x*e.y-t.y*e.x}static CrossSubtract(t,e,s,i,a){r.__vtor3Stv0.x=e.x-t.x,r.__vtor3Stv0.y=e.y-t.y,r.__vtor3Stv0.z=e.z-t.z,r.__vtor3Stv1.x=i.x-s.x,r.__vtor3Stv1.y=i.y-s.y,r.__vtor3Stv1.z=i.z-s.z,t=r.__vtor3Stv0,s=r.__vtor3Stv1,a.x=t.y*s.z-t.z*s.y,a.y=t.z*s.x-t.x*s.z,a.z=t.x*s.y-t.y*s.x}static Subtract(t,e,s){s.x=t.x-e.x,s.y=t.y-e.y,s.z=t.z-e.z}static DistanceSquared(t,e){return r.__vtor3Stv0.x=t.x-e.x,r.__vtor3Stv0.y=t.y-e.y,r.__vtor3Stv0.z=t.z-e.z,r.__vtor3Stv0.getLengthSquared()}static DistanceXYZ(t,e,s,i,a,l){return r.__vtor3Stv0.x=t-i,r.__vtor3Stv0.y=e-a,r.__vtor3Stv0.z=s-l,r.__vtor3Stv0.getLength()}static Distance(t,e){return r.__vtor3Stv0.x=t.x-e.x,r.__vtor3Stv0.y=t.y-e.y,r.__vtor3Stv0.z=t.z-e.z,r.__vtor3Stv0.getLength()}static AngleBetween(t,e){return t.normalizeTo(r.__vtor3Stv0),e.normalizeTo(r.__vtor3Stv1),Math.acos(r.__vtor3Stv0.dot(r.__vtor3Stv1))*i}static RadianBetween(t,e){return t.normalizeTo(r.__vtor3Stv0),e.normalizeTo(r.__vtor3Stv1),Math.acos(r.__vtor3Stv0.dot(r.__vtor3Stv1))}static RadianBetween2(t,e){let s=t.getLengthSquared(),i=e.getLengthSquared();return r.__vtor3Stv0.x=t.x-e.x,r.__vtor3Stv0.y=t.y-e.y,r.__vtor3Stv0.z=t.z-e.z,Math.acos((s+i-r.__vtor3Stv0.getLengthSquared())/(2*Math.sqrt(s)*Math.sqrt(i)))}static Reflect(t,e,s){let i=2*(t.x*e.x+t.y*e.y+t.z*e.z);s.x=t.x-i*e.x,s.y=t.y-i*e.y,s.z=t.z-i*e.z}}r.X_AXIS=new r(1,0,0),r.Y_AXIS=new r(0,1,0),r.Z_AXIS=new r(0,0,1),r.__vtor3Stv0=new r,r.__vtor3Stv1=new r,r.ZERO=new r,e.default=r},9156:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{static SetTransUniform(t,e){i.Bu.set(t.getUid(),e)}static GetTransUniform(t){if(t.getUid()<0)throw Error("mat.getUid() < 0");return i.Bu.has(t.getUid())?i.Bu.get(t.getUid()):null}static HasTransUniform(t){return i.Bu.has(t.getUid())}static RemoveTransUniform(t){i.Bu.delete(t.getUid())}}i.Bu=new Map,e.default=i},"91e2":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("8e17")),r=i(s("29ef")),l=i(s("402a")),n=i(s("f63e")),_=s("8a0a"),h=i(s("3bfb"));class o extends l.default{constructor(t=null){super(t),this.Ad=_.VtxNormalType.FLAT,this.Ae=new a.default(-50,-50,-50),this.Af=new a.default(50,50,50),this.G_=null,this.Ag=null,this.m=!0,this.vtxColor=null,this.uScale=1,this.vScale=1,this.normalScale=1,this.normalEnabled=!1,this.uvPartsNumber=0,this.wireframe=!1}setVtxTransformMatrix(t){this.G_=t}useFlatNormal(){this.Ad=_.VtxNormalType.FLAT}useGourandNormal(){this.Ad=_.VtxNormalType.GOURAND}createMaterial(t){if(null==this.getMaterial()){let e=new n.default;e.normalEnabled=this.normalEnabled,e.vertColorEnabled=null!=this.vtxColor,e.setTextureList(t),this.setMaterial(e)}else null!=t&&this.getMaterial().getTextureTotal()<1&&this.getMaterial().setTextureList(t)}initializeThis(t){if(this.m)this.createMaterial(t),this.activeDisplay();else{let t=this.getMesh();null!=t&&t.initialize(this.Ae,this.Af)}this.m=!1}showBackFace(){this.setRenderState(r.default.BACK_CULLFACE_NORMAL_STATE)}showFrontFace(){this.setRenderState(r.default.FRONT_CULLFACE_NORMAL_STATE)}showDoubleFace(){this.setRenderState(r.default.NONE_CULLFACE_NORMAL_STATE)}scaleUVFaceAt(t,e,s,i,a){let r=this.getMesh();null!=r&&r.scaleUVFaceAt(t,e,s,i,a)}scaleUVSFaceAt(t,e){let s=this.getMesh();null!=s&&s.setFaceUVSAt(t,e)}reinitializeMesh(){null!=this.Ag&&this.Ag.reinitialize()}initialize(t,e,s=null){null!=t&&this.Ae.copyFrom(t),null!=e&&this.Af.copyFrom(e),this.initializeThis(s)}initializeCube(t,e=null){t*=.5,this.Ae.setXYZ(-t,-t,-t),this.Af.setXYZ(t,t,t),this.initializeThis(e)}initializeSizeXYZ(t,e,s,i=null){this.Ae.setXYZ(.5*-t,.5*-e,.5*-s),this.Af.setXYZ(.5*t,.5*e,.5*s),this.initializeThis(i)}__activeMesh(t){if(this.Ag=this.getMesh(),null==this.Ag&&(this.Ag=new h.default),null!=this.Ag){let e=this.Ag;null!=this.G_&&e.setTransformMatrix(this.G_),e.vtxColor=this.vtxColor,e.uScale=this.uScale,e.vScale=this.vScale,e.wireframe=this.wireframe,e.normalType=this.Ad,e.normalScale=this.normalScale,e.vbWholeDataEnabled=this.vbWholeDataEnabled,e.uvPartsNumber=this.uvPartsNumber,e.setVtxBufRenderData(t),e.initialize(this.Ae,this.Af),this.setMesh(e),e.setTransformMatrix(null)}this.G_=null}updateMesh(){this.Ag=this.getMesh()}setFaceUVSAt(t,e,s=0){null!=this.Ag&&this.Ag.setFaceUVSAt(t,e,s)}transformFaceAt(t,e){null!=this.Ag&&this.Ag.transformFaceAt(t,e)}getFaceCenterAt(t,e){null!=this.Ag&&this.Ag.getFaceCenterAt(t,e)}destroy(){super.destroy(),this.vtxColor=null,this.Ag=null,this.m=!0}toString(){return"[Box3DEntity(uid = "+this.getUid()+", rseFlag = "+this.__$rseFlag+")"}}e.default=o},9666:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("3b73")),r=i(s("acfe"));class l{static CreateShdData(t,e,s,i,n){if(l.Bv.has(t))return l.Bv.get(t);let _=new r.default;return _.adaptationShaderVersion=i,_.preCompileInfo=n,_.initialize(t,e,s),l.Bw[_.getUid()]=_,++l.s_shdDataListLen,l.Bv.set(t,_),a.default.SHADERCODE_TRACE_ENABLED,_}static FindData(t){return l.Bv.has(t)?l.Bv.get(t):null}}l.Bv=new Map,l.Bw=[],l.s_shdDataListLen=0,e.default=l},"96e4":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("b3bd")),r=s("f3a2"),l=s("839a");e.SpecularMode=l.SpecularMode;class n{constructor(){this.n="lambert",this.s=null,this.Ah=1,this.Ai=null,this.r=null,this.Aj=1,this.Ak=1,this.vertColorEnabled=!1,this.premultiplyAlpha=!1,this.shadowReceiveEnabled=!1,this.lightEnabled=!0,this.fogEnabled=!1,this.envAmbientLightEnabled=!1,this.brightnessOverlayEnabeld=!1,this.glossinessEnabeld=!0,this.colorEnabled=!0,this.normalEnabled=!0,this.diffuseMap=null,this.diffuseMap2=null,this.normalMap=null,this.parallaxMap=null,this.aoMap=null,this.specularMap=null,this.specularMode=l.SpecularMode.Default,this.diffuseMap2Matrix=null,this.vertUniform=null}buildBufParams(){}buildTextureList(t){if(t.addDiffuseMap(this.diffuseMap),null!=this.diffuseMap2){let e=t.getCodeBuilder();this.diffuseMap2Matrix&&(e.addDefine("VOX_USE_DIFFUSEMAP2_MAT","1"),e.addVarying("vec4","v_map2Pos"),e.addVertUniform("mat4","u_map2ViewMat"),e.addUniqueNSKeyString("M2VM")),t.add2DMap(this.diffuseMap2,"VOX_DIFFUSE_MAP2",!this.diffuseMap2Matrix,!0,!1)}t.addNormalMap(this.normalMap),t.addParallaxMap(this.parallaxMap,this.Ah),t.addAOMap(this.aoMap),t.addSpecularMap(this.specularMap)}buildShader(t){t.addFragUniform("vec4","u_fragLocalParams",this.Aj),this.lightEnabled&&t.addDefine("VOX_LIGHT_LOCAL_PARAMS_INDEX",""+this.Ak),this.vertColorEnabled&&(t.addVertLayout("vec3","a_cvs"),t.addVarying("vec3","v_cv"))}getShaderCodeObjectUUID(){return r.ShaderCodeUUID.Lambert}getShaderCodeObject(){return null}createUniformData(){let t=new a.default;return t.uniformNameList=["u_fragLocalParams"],t.dataList=[this.r],null!=this.vertUniform&&this.vertUniform.buildShaderUniformData(t),null!=this.diffuseMap2Matrix&&(t.uniformNameList.push("u_map2ViewMat"),t.dataList.push(this.diffuseMap2Matrix.getLocalFS32())),t}getUniqueName(){return this.n}initialize(){if(null!=this.vertUniform&&this.vertUniform.initialize(),null==this.r){this.Aj=2,null!=this.parallaxMap&&(this.Aj+=1),this.lightEnabled&&(this.Aj+=3),this.r=new Float32Array(4*this.Aj),this.r.set([1,1,1,1,0,0,0,0]);let t=2;null!=this.parallaxMap&&(this.s=this.r.subarray(4*t,4*(t+1)),this.s.set([1,10,2,.1]),this.Ah=t,t+=1),this.lightEnabled&&(this.Ak=t,this.Ai=this.r.subarray(4*t),this.Ai.set([.5,.5,.5,32,.7,.3,.3,.7,.01,.01,.01,0]))}this.n="lambert",this.colorEnabled&&(this.n+="Col"),this.n+=this.Aj}setSpecularColor(t){null!=this.Ai&&(this.Ai[0]=t.r,this.Ai[1]=t.g,this.Ai[2]=t.b)}setSpecularIntensity(t){null!=this.Ai&&(this.Ai[3]=t)}setLightBlendFactor(t,e){null!=this.Ai&&(this.Ai[4]=t,this.Ai[5]=e)}setBlendFactor(t,e){null!=this.Ai&&(this.Ai[6]=t,this.Ai[7]=e)}setAmbientFactor(t,e,s){null!=this.Ai&&(this.Ai[8]=t,this.Ai[9]=e,this.Ai[10]=s)}setParallaxParams(t=1,e=10,s=2,i=.1){null!=this.s&&(this.s[0]=t,this.s[1]=e,this.s[2]=s,this.s[3]=i)}setRGB3f(t,e,s){this.r[0]=t,this.r[1]=e,this.r[2]=s}setColor(t,e=null){null!=t&&(this.r[0]=t.r,this.r[1]=t.g,this.r[2]=t.b,this.r[3]=t.a),null!=e&&(this.r[4]=e.r,this.r[5]=e.g,this.r[6]=e.b,this.r[7]=e.a)}setColorAlpha(t){this.r[3]=t}destroy(){this.r=null,this.vertUniform=null,this.diffuseMap2Matrix=null,this.diffuseMap=null,this.diffuseMap2=null,this.normalMap=null,this.parallaxMap=null,this.aoMap=null,this.specularMap=null}}e.default=n,e.LambertLightDecorator=n},a221:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},a5ba:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s("e08e");class a{constructor(t,e,s){this.A=-1,this.Al=0,this.Am=0,this.An=0,this.Ao=0,this.A=a.BF++,this.Al=t,this.Am=e,this.An=s}getUid(){return this.A}getCullFaceMode(){return this.Al}getDepthTestMode(){return this.An}getBlendMode(){return this.Am}use(){if(a.BA!=this.A){a.Rstate.setCullFaceMode(this.Al);a.B3[a.Am];a.Am<0?a.Rstate.setBlendMode(this.Am,a.B3[this.Am]):a.Rstate.setBlendMode(a.Am,a.B3[a.Am]),a.B1<0?a.Rstate.setDepthTestMode(this.An):a.Rstate.setDepthTestMode(a.B1),a.BA=this.A}}static CreateBlendModeSeparate(t,e,s,r,l,n=0,_=0){if(null!=t&&""!=t){let h;if(a.Bx.has(t))return h=a.Bx.get(t),a.By.get(h);n<1&&(n=i.GLBlendEquation.FUNC_ADD),_<1&&(_=i.GLBlendEquation.FUNC_ADD);let o=1;if(h=31,h=131*h+e,h=131*h+s,r>0&&l>0&&(h=131*h+r,h=131*h+l,o=1),a.By.has(h))return a.Bx.set(t,h),a.By.get(h);let u=++a.Bz;a.Bx.set(t,h),a.By.set(h,u);let m=[o,n,_,e,s,r,l];return a.B3[u]=m,u}return 0}static CreateBlendMode(t,e,s,r=0){if(null!=t&&""!=t){let l;if(a.Bx.has(t))return l=a.Bx.get(t),a.By.get(l);r<1&&(r=i.GLBlendEquation.FUNC_ADD);let n=0;if(l=31,l=131*l+e,l=131*l+s,a.By.has(l))return a.By.get(l);let _=++a.Bz;a.Bx.set(t,l),a.By.set(l,_);let h=[n,r,0,e,s,0,0];return a.B3[_]=h,_}return 0}static Create(t,e,s,i){if(a.BB.has(t)){let e=a.BB.get(t);return e.getUid()}let r=31;if(r=131*r+i,r=131*r+s,r=131*r+e,a.BC.has(r)){let t=a.BC.get(r);r=t.getUid()}else{let l=new a(e,s,i);r=l.getUid(),a.BC.set(r,l),a.BB.set(t,l),a.BD.push(l),++a.BG}return r}static GetRenderStateByName(t){if(a.BB.has(t)){let e=a.BB.get(t);return e.getUid()}return-1}static UseRenderState(t){a.BE&&a.BA!=t&&t>-1&&t<a.BG&&a.BD[t].use()}static UseRenderStateByName(t){if(a.BE){let e=a.GetRenderStateByName(t);a.BA!=e&&e>-1&&e<a.BG&&a.BD[e].use()}}static UnlockBlendMode(){a.Am=a.B0}static LockBlendMode(t){a.B0=a.Am,a.Am=t}static UnlockDepthTestMode(){a.B1=a.B2}static LockDepthTestMode(t){a.B2=a.B1,a.B1=t}static Lock(){a.BE=!1}static Unlock(){a.BE=!0}static Reset(){a.BA=-1}}a.BF=0,a.BA=-1,a.BD=[],a.BG=1,a.Am=-1,a.B1=-1,a.BC=new Map,a.BB=new Map,a.Bx=new Map,a.By=new Map,a.Bz=0,a.B3=new Array(256),a.BE=!0,a.Rstate=null,a.B0=-1,a.B2=-1,e.RenderStateObject=a},a9f4:function(t,e,s){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t["Default"]=1]="Default",t[t["VSM"]=1]="VSM"}(i||(i={})),e.ShadowMode=i},ab73:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(){this.type="vec4",this.data=null,this.name="u_vsmParams",this.arrayLength=3}}class a{constructor(){this.type="vec4",this.data=new Float32Array([.1,.1,.1,1,1,.1,600,3500,.3,0,.9,5e-4,0,0,800,800,-500,-500,1e3,1e3]),this.name="u_envLightParams",this.arrayLength=5}}class r{constructor(){this.type="mat4",this.data=null,this.name="u_shadowMat",this.arrayLength=0}}class l{constructor(){this.type="vec4",this.data=null,this.name="u_stageParam",this.arrayLength=0}}class n{constructor(){this.type="vec4",this.data=null,this.name="u_viewParam",this.arrayLength=0}}class _{constructor(){this.type="vec4",this.data=null,this.name="u_frustumParam",this.arrayLength=0}}class h{constructor(){this.type="vec4",this.data=null,this.name="u_cameraPosition",this.arrayLength=0}}class o{constructor(){this.type="vec4",this.positionName="u_lightPositions",this.colorName="u_lightColors"}}class u{}u.LocalTransformMatUNS="u_objMat",u.CameraViewMatUNS="u_viewMat",u.CameraProjectiveMatUNS="u_projMat",u.FrustumParam=new _,u.CameraPosParam=new h,u.StageParam=new l,u.ViewportParam=new n,u.ShadowMatrix=new r,u.ShadowVSMParams=new i,u.GlobalLight=new o,u.EnvLightParams=new a,e.default=u},abdb:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{}i.AXIS_ANGLE=0,i.QUATERNION=1,i.EULER_ANGLES=2,e.default=i},acfe:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("ca6c")),r=i(s("8a0a")),l=i(s("3b73")),n=i(s("81ce")),_=i(s("fc07"));class h{constructor(){this.A=-1,this.adaptationShaderVersion=!0,this.preCompileInfo=null,this.Ap="",this.Aq="",this.Ar="",this.As=0,this.At=null,this.Au=!1,this.Av=null,this.Aw=null,this.Ax=null,this.Ay=new Map,this.Az=null,this.A0=!1,this.A1=0,this.A2=0,this.A3=1,this.A4=null,this.dataUniformEnabled=!1,this.A=h.BF++}getVSCodeStr(){return this.Ap}getFSCodeStr(){return this.Aq}getLocationTypes(){return this.Az}getLayoutBit(){return this.A1}getMid(){return this.A2}getFragOutputTotal(){return this.A3}parseCode(t,e){h.B4.reset(),h.B4.parseVShaderCode(t),h.B4.parseFShaderCode(e),this.A3=h.B4.fragOutputTotal,this.At=h.B4.uniforms}initialize(t,e,s){this.Ar=t,this.adaptationShaderVersion&&null==this.preCompileInfo&&l.default.IsWebGL1()&&(e=n.default.Es3VtxShaderToES2(e),s=n.default.Es3FragShaderToES2(s)),this.preCompileInfo,this.parseCode(e,s);let i=h.B4.attributes,_=0,o=i.length,u=null;this.Av=[],this.Aw=[],this.A1=0;let m=0,d=this.Az=[];while(_<o){if(u=i[_],null!=u){this.Av.push(u.name),this.Aw.push(u.typeSize),m+=1;let t=r.default.GetVBufTypeByNS(u.name);switch(t){case r.default.VBUF_VS:this.A1|=a.default.BIT_ONE_0;break;case r.default.VBUF_UVS:this.A1|=a.default.BIT_ONE_1;break;case r.default.VBUF_NVS:this.A1|=a.default.BIT_ONE_2;break;case r.default.VBUF_CVS:this.A1|=a.default.BIT_ONE_3;break;case r.default.VBUF_TVS:this.A1|=a.default.BIT_ONE_4;break;case r.default.VBUF_VS2:this.A1|=a.default.BIT_ONE_5;break;case r.default.VBUF_UVS2:this.A1|=a.default.BIT_ONE_6;break;case r.default.VBUF_NVS2:this.A1|=a.default.BIT_ONE_7;break;case r.default.VBUF_CVS2:this.A1|=a.default.BIT_ONE_8;break;case r.default.VBUF_TVS2:this.A1|=a.default.BIT_ONE_9;break;default:m-=1,t=0;break}t>0&&d.push(r.default.GetVBufAttributeTypeByVBufType(t))}++_}let c=(m<<11)+this.A1;h.B5.has(c)||(h.B5.set(c,h.B6),h.B6++),this.A2=h.B5.get(c),this.As=h.B4.texTotal,this.Au=this.As>0,this.Au&&(this.A4=h.B4.texUniformNameListStr.split(",")),this.A0=this.As<this.At.length,this.Ap=e,this.Aq=s,this.Ar=t}getAttriSizeList(){return this.Aw}getTexUniformNames(){return this.A4}getUniforms(){return this.At}haveCommonUniform(){return this.A0}getAttriNSList(){return this.Av}getUid(){return this.A}getTexTotal(){return this.As}haveTexture(){return this.Au}getLocationsTotal(){return this.Ax.length}getUniformTypeNameByNS(t){let e=this.Ay.get(t);return null!=e?e.typeName:""}getUniformTypeByNS(t){let e=this.Ay.get(t);return null!=e?e.type:0}hasUniformByName(t){return this.Ay.has(t)}getUniformLengthByNS(t){return this.Ay.has(t)&&this.Ay.get(t).arrLength,0}getUniqueShaderName(){return this.Ar}destroy(){this.As=0}}h.BF=0,h.B4=new _.default,h.B5=new Map,h.B6=1,e.default=h},b3bd:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(){this.uns="",this.types=null,this.uniformSize=0,this.uniformNameList=null,this.locations=null,this.dataList=null,this.calcModels=null,this.always=!0,this.next=null}getDataRefFromUniformName(t){if(null!=this.uniformNameList){let e=this.uniformNameList,s=e.length;for(let i=0;i<s;++i)if(t==e[i])return this.dataList[i]}return null}setDataRefFromUniformName(t,e){if(null!=this.uniformNameList){let s=this.uniformNameList,i=s.length;for(let a=0;a<i;++a)if(t==s[a]){this.dataList[a]=e;break}}}copyDataFromProbe(t){this.types=[];for(let e=0;e<t.uniformsTotal;++e)this.types.push(t.uniformTypes[e]);this.uniformSize=t.uniformsTotal}destroy(){let t=0,e=this.dataList.length;for(;t<e;++t)this.dataList[t]=null;if(null!=this.calcModels)for(e=this.calcModels.length,t=0;t<e;++t)this.calcModels[t].destroy(),this.calcModels[t]=null;this.dataList=null,this.types=null,this.locations=null,this.calcModels=null}}e.default=i},b4ea:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("f63b")),r=s("8d98"),l=s("f3a2");e.ShaderCodeUUID=l.ShaderCodeUUID;const n=s("c052");e.ShaderCodeConfigure=n.ShaderCodeConfigure,e.ShaderCodeType=n.ShaderCodeType,e.IShaderLibConfigure=n.IShaderLibConfigure,e.IShaderLibListener=n.IShaderLibListener;const _=s("4301");e.MaterialContextParam=_.MaterialContextParam;class h{constructor(){this.m=!0,this.A5=null,this.A6=null,this.lightModule=null,this.envLightModule=null,this.vsmModule=null,this.pipeline=null}addShaderLibListener(t){null!=h.ShaderLib&&h.ShaderLib.setListener(t)}getTextureLoader(){return this.A5}isTextureLoadedAll(){return this.A5.isLoadedAll()}getTextureByUrl(t,e=!0,s=!0){let i=null,a=t.slice(t.lastIndexOf(".")+1);switch(a=a.toLocaleLowerCase(),a){case"jpeg":case"jpg":case"png":case"gif":i=this.A5.getImageTexByUrl(t),i.mipmapEnabled=s,e&&i.setWrap(r.TextureConst.WRAP_REPEAT);break;default:break}return i}createShaderLibConfig(){return{shaderCodeConfigures:[],version:""}}buildConfigure(t,e){if(null==e){let s=this.createShaderLibConfig();if(null==t&&(t=new _.MaterialContextParam),t.loadAllShaderCode){let e=h.ShaderLib.createShaderCodeConfigure(t);null!=e&&s.shaderCodeConfigures.push(e)}e=s}return e}initialize(t,e=null,s=null){if(this.m){s=this.buildConfigure(e,s),this.m=!1,this.A6=t,this.A5=new a.default(this.A6.textureBlock);let i=this;if(null==e&&(e=new _.MaterialContextParam),this.A7=e,""!=e.shaderLibVersion&&(s.version=e.shaderLibVersion),h.ShaderLib.initialize(s,e.shaderCodeBinary),e.loadAllShaderCode&&h.ShaderLib.addAllShaderCodeObject(),this.initPipes(this.A7),i.pipeline=this.createPipeline(),this.initEnd(e),!e.loadAllShaderCode){let t=h.ShaderLib.getListener();null!=t&&t.shaderLibLoadComplete(0,0)}}}initPipes(t){}initEnd(t){}addShaderCodeObject(t,e){h.ShaderLib.addShaderCodeObject(t,e)}addPipeline(t){null!=t&&t!=this.pipeline&&(null!=this.lightModule&&t.addPipe(this.lightModule),null!=this.envLightModule&&t.addPipe(this.envLightModule),null!=this.vsmModule&&t.addPipe(this.vsmModule))}createPipeline(){let t=this.A6.materialBlock.createMaterialPipeline(h.ShaderLib);return null!=this.lightModule&&t.addPipe(this.lightModule),null!=this.envLightModule&&t.addPipe(this.envLightModule),null!=this.vsmModule&&t.addPipe(this.vsmModule),t}run(){null!=this.vsmModule&&this.A7.vsmEnabled&&this.vsmModule.run()}destroy(){this.A6=null}}h.ShaderLib=new n.ShaderLib,e.MaterialContext=h},c052:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s("f3a2"),a=s("cc55"),r=s("69ed");e.ShaderCodeType=r.ShaderCodeType;const l=s("28a9");e.ShaderCodeConfigure=l.ShaderCodeConfigure;const n=s("a221");e.IShaderLibConfigure=n.IShaderLibConfigure;const _=s("ca2f"),h=s("12e2");e.IShaderLibListener=h.IShaderLibListener;class o{constructor(){this.A8=new Map,this.A9=[]}addConfigureWithUUID(t,e){""==t||this.A8.has(t)||(this.A8.set(t,e),this.A9.push(t))}getConfigureWithUUID(t){return this.A8.get(t)}getUUIDList(){return this.A9}getUUIDListLength(){return this.A9.length}}class u{constructor(t){this.A_A=0,this.A_B=new a.ShaderCodeObject,this.A_C=null,this.version="",this.A_C=t}decodeUint8Arr(t){return new TextDecoder("utf-8").decode(t)}encodeUint8Arr(t){return(new TextEncoder).encode(t)}loadedShdCode(t,e,s){if(this.A_A++,this.A_C.buildBinaryFile&&!this.A_C.binary){let s=this.encodeUint8Arr(t);for(let t=0;t<s.length;++t)s[t]=222-s[t];u.B7.downloadBinFile(s,e+"","bin")}switch(e){case r.ShaderCodeType.VertHead:this.A_B.vert_head=t;break;case r.ShaderCodeType.VertBody:this.A_B.vert_body=t;break;case r.ShaderCodeType.FragHead:this.A_B.frag_head=t;break;case r.ShaderCodeType.FragBody:this.A_B.frag_body=t;break;default:break}this.A_A==this.A_C.types.length&&(s(this.A_C.uuid,this.A_B),this.A_B=null,this.A_C=null)}async loadBinCode(t,e,s){const i=new FileReader;i.onload=t=>{let a=new Uint8Array(i.result);for(let e=0;e<a.length;++e)a[e]=222-a[e];this.loadedShdCode(this.decodeUint8Arr(a),e,s)};const a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType="blob",a.onload=t=>{a.status<=206&&i.readAsArrayBuffer(a.response)},a.onerror=t=>{},a.send()}loadTextCode(t,e,s){let i=new XMLHttpRequest;i.open("GET",t,!0),i.onload=()=>{i.status<=206&&this.loadedShdCode(i.responseText,e,s)},i.onerror=t=>{},i.send()}loadCode(t,e,s){this.A_C.binary?this.loadBinCode(t,e,s):this.loadTextCode(t,e,s)}load(t){if(this.A_A=0,null==this.A_C.urls){let e=""!=this.version?this.version+"/":"",s=this.A_C.binary?".bin":".glsl";for(let i=0;i<this.A_C.types.length;++i){let a="static/shader/"+e+"glsl/"+this.A_C.uuid+"/"+this.A_C.types[i]+s;this.loadCode(a,this.A_C.types[i],t)}}else for(let e=0;e<this.A_C.urls.length;++e){let s=this.A_C.urls[e];this.loadCode(s,this.A_C.types[e],t)}}}u.B7=new _.FileIO;class m{constructor(){this.A_A=0,this.A_D=0,this.A_E=new Map,this.A_F=new Map,this.A_G=null,this.A_H=null,this.A_I=""}setListener(t){this.A_H=t}getListener(){return this.A_H}initialize(t=null,e=!1){if(null==this.A_G){let s;this.A_G=new o;let a=null;if(null!=t&&(a=t.shaderCodeConfigures,this.A_I=t.version),null!=a)for(let t=0;t<a.length;++t)s=a[t],null!=s&&this.A_G.addConfigureWithUUID(s.uuid,s);else s=new l.ShaderCodeConfigure,s.uuid=i.ShaderCodeUUID.PBR,s.types=[r.ShaderCodeType.VertHead,r.ShaderCodeType.VertBody,r.ShaderCodeType.FragHead,r.ShaderCodeType.FragBody],s.binary=e,this.A_G.addConfigureWithUUID(s.uuid,s)}}addAllShaderCodeObject(){if(this.A_G.getUUIDListLength()>0){let t=this.A_G.getUUIDList();for(let e=0;e<t.length;++e)this.addShaderCodeObjectWithUUID(t[e])}else null!=this.A_H&&this.A_H.shaderLibLoadComplete(0,0)}addShaderCodeObjectWithUUID(t){if(!this.A_F.has(t)&&!this.A_E.has(t)){this.A_A++;let e=new u(this.A_G.getConfigureWithUUID(t));e.version=this.A_I,e.load((t,e)=>{this.A_F.set(t,e),this.A_D++,null!=this.A_H&&this.A_H.shaderLibLoadComplete(this.A_A,this.A_D)})}}addShaderCodeObject(t,e){null==e||e.uuid!=""+t||this.A_F.has(t)||this.A_F.set(t,e)}getShaderCodeObjectWithUUID(t){let e=null;return this.A_F.has(t)&&(e=this.A_F.get(t)),e}createShaderCodeConfigure(t){let e,s="static/shader/"+(""!=t.shaderLibVersion?t.shaderLibVersion+"/":"");s+="glsl/";let a=i.ShaderCodeUUID.None;return t.lambertMaterialEnabled?a=i.ShaderCodeUUID.Lambert:t.pbrMaterialEnabled&&(a=i.ShaderCodeUUID.PBR),a!=i.ShaderCodeUUID.None&&(e=new l.ShaderCodeConfigure,e.uuid=a,e.buildBinaryFile=t.buildBinaryFile,s+=e.uuid+"/",t.shaderCodeBinary&&t.shaderFileRename&&(e.urls=[s+"glsl01.bin",s+"glsl02.bin",s+"glsl03.bin",s+"glsl04.bin"]),e.binary=t.shaderCodeBinary),e}}e.ShaderLib=m},c164:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(){}}i.BasePredefined="\n#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n",e.MathShaderCode=i;class a{constructor(){}}a.BasePredefined="\nvec4 localPosition = vec4(0.0,0.0,0.0,1.0);\nvec4 worldPosition = vec4(0.0,0.0,0.0,1.0);\n// view space position\nvec4 viewPosition = vec4(0.0,0.0,0.0,1.0);\nvec3 worldNormal = vec3(0.0, 0.0, 1.0);\n",a.FragPredefined="\n",a.FragDefined="\n",a.VertPredefined="\n// origin world position\nvec4 oWorldPosition = vec4(0.0,0.0,0.0,1.0);\n",a.VertDefined="\n",e.ShaderCode=a},ca2f:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(){}downloadBinFile(t,e,s="vrd"){var i,a;i=function(t,e,s){var i,r;i=new Blob([t],{type:s}),r=window.URL.createObjectURL(i),a(r,e),setTimeout((function(){return window.URL.revokeObjectURL(r)}),1e3)},a=function(t,e){var s;s=document.createElement("a"),s.href=t,s.download=e,document.body.appendChild(s),s.style="display: none",s.click(),s.remove()},i(t,e+"."+s,"application/octet-stream")}}e.FileIO=i},ca6c:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{static PushThreeBitValueToInt(t,e){return(t<<3)+e}static PopThreeBitValueFromInt(t){return i.value=7&t,t>>3}static ContainsBit(t,e){return(e&t)>0}static RemoveBit(t,e){return~e&t}static AddBit(t,e){return e|t}static AssembleFromIntArray(t){let e=0,s=0,i=t.length;for(;e<i;++e)t[e]>0&&(s|=1<<e);return s}}i.BIT_ZERO=0,i.BIT_ONE_0=1,i.BIT_ONE_1=2,i.BIT_ONE_2=4,i.BIT_ONE_3=8,i.BIT_ONE_4=16,i.BIT_ONE_5=32,i.BIT_ONE_6=64,i.BIT_ONE_7=128,i.BIT_ONE_8=256,i.BIT_ONE_9=512,i.BIT_ONE_10=1024,i.BIT_ONE_11=2048,i.value=0,e.default=i},cb29:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("8a0a")),r=s("8a0a"),l=i(s("e7d2")),n=s("e08e");class _{constructor(t=a.default.VTX_STATIC_DRAW){this.A_J=0,this.A_K=null,this.A_L=null,this.A_M=null,this.A_N=null,this.A_O=null,this.A1=0,this.G_=null,this.H_=null,this.F_=null,this.forceUpdateIVS=!1,this.wireframe=!1,this.bounds=null,this.normalType=r.VtxNormalType.GOURAND,this.normalScale=1,this.vtxTotal=0,this.trisNumber=0,this.drawMode=n.RenderDrawMode.ELEMENTS_TRIANGLES,this.vtCount=0,this.vbWholeDataEnabled=!1,this.drawInsBeginIndex=0,this.drawInsStride=0,this.drawInsTotal=0,this.j=0,this.A_J=t}updateWireframeIvs(){if(this.drawMode=n.RenderDrawMode.ELEMENTS_TRIANGLES,this.wireframe&&null!==this.F_){let t,e,s,i,a=this.F_,r=2*a.length;t=r<65535?new Uint16Array(r):new Uint32Array(r);let l=0;for(let n=0,_=a.length;n<_;n+=3)e=a[n+0],s=a[n+1],i=a[n+2],t[l]=e,t[l+1]=s,t[l+2]=s,t[l+3]=i,t[l+4]=i,t[l+5]=e,l+=6;this.drawMode=n.RenderDrawMode.ELEMENTS_LINES}}buildEnd(){this.H_.setBufTypeList(this.A_N),this.H_.setBufSizeList(this.A_O),this.A_K=l.default.BufDataList,this.A_L=l.default.BufDataStepList,this.A_M=l.default.BufStatusList}setTransformMatrix(t){this.G_=t}getTransformMatrix(){return this.G_}isPolyhedral(){return!0}setPolyhedral(t){}testRay(t,e,s,i){return-1}rebuild(){if(null==this.H_&&null!=this.A_K){l.default.Reset();let t=0,e=this.A_K.length;for(;t<e;++t)l.default.AddFloat32Data(this.A_K[t],this.A_L[t],this.A_M[t]);this.H_=l.default.CreateBySaveData(this.getBufDataUsage()),null!=this.F_&&(this.H_.setUintIVSData(this.F_),this.vtCount=this.F_.length)}}__$attachVBuf(){return null==this.H_&&this.rebuild(),l.default.__$$AttachAt(this.H_.getUid()),this.H_}__$detachVBuf(t){if(this.H_!=t)throw Error("Fatal Error!");l.default.__$$DetachAt(this.H_.getUid())}isGeomDynamic(){return this.A_J}getBufDataUsage(){return this.A_J}getVS(){return null}getUVS(){return null}getNVS(){return null}getCVS(){return null}getIVS(){return this.F_}setVtxBufRenderData(t){null!=t&&(this.A_N=t.getBufTypeList(),this.A_O=t.getBufSizeList(),this.setBufSortFormat(t.getBufSortFormat()))}setBufSortFormat(t){this.A1=t}getBufSortFormat(){return this.A1}setBufTypeList(t){this.A_N=t}setBufSizeList(t){this.A_O=t}getBufTypeList(){return this.A_N}getBufSizeList(){return this.A_O}isVBufEnabledAt(t){return(t&this.A1)>0}__$attachThis(){++this.j}__$detachThis(){1==this.j?(--this.j,this.__$dispose()):--this.j,this.j<1&&(this.j=0)}getAttachCount(){return this.j}__$dispose(){this.getAttachCount()<1&&null!=this.H_&&(l.default.__$$DetachAt(this.H_.getUid()),this.H_=null)}isEnabled(){return null!=this.H_}isResFree(){return this.getAttachCount()<1&&null==this.H_}__$destroy(){this.isResFree()&&(this.F_=null,this.A_K=null,this.A_L=null,this.A_M=null,this.trisNumber=0,this.G_=null,this.A_N=null,this.A_O=null)}toString(){return"[MeshBase()]"}}e.default=_},cc48:function(t,e,s){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t["NONE"]=0]="NONE",t[t["CAMERA"]=1]="CAMERA",t[t["POV"]=2]="POV",t[t["INNER_POV_PASS"]=3]="INNER_POV_PASS",t[t["CAMERA_AND_POV"]=4]="CAMERA_AND_POV"}(i||(i={})),e.SpaceCullingMask=i},cc55:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(){this.vert="",this.vert_head="",this.vert_body="",this.frag="",this.frag_head="",this.frag_body="",this.uuid=""}}e.ShaderCodeObject=i},d08b:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(){}getBufSortFormat(){return 7}getBufTypeList(){return[1,2,3]}getBufSizeList(){return[3,2,3]}}e.VtxBufRenderData=i},dc2b:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=s("e08e"),r=i(s("29ef"));class l{constructor(){this.A=0,this.A_P=null,this.A_Q=null,this.name="RODisplay",this.visible=!0,this.ivsIndex=0,this.ivsCount=0,this.trisNumber=0,this.insCount=0,this.drawMode=a.RenderDrawMode.ELEMENTS_TRIANGLES,this.vbuf=null,this.renderState=r.default.NORMAL_STATE,this.rcolorMask=r.default.COLOR_MASK_ALL_TRUE,this.mouseEnabled=!1,this.A_R=null,this.A_S=null,this.__$ruid=-1,this.__$rpuid=-1,this.__$$rsign=a.DisplayRenderSign.NOT_IN_RENDERER,this.__$$runit=null,this.A=l.BF++}getPartGroup(){return this.A_R}createPartGroup(t){t<1&&(t=1),this.A_R=new Uint16Array(2*t)}setDrawPartAt(t,e,s){t*=2,this.A_R[t]=s,this.A_R[++t]=e}getUid(){return this.A}setTransform(t){this.A_S=t,this.A_Q=t.getLocalFS32()}getTransform(){return this.A_S}getMatrixFS32(){return this.A_Q}enableDrawInstanced(t,e){this.drawMode=a.RenderDrawMode.ELEMENTS_INSTANCED_TRIANGLES,this.ivsIndex=t,this.insCount=e}disableDrawInstanced(){this.drawMode=a.RenderDrawMode.ELEMENTS_TRIANGLES}getMaterial(){return this.A_P}setMaterial(t){null!=this.A_P&&this.A_P!=t&&(this.A_P.__$detachThis(),null!=t&&t.__$attachThis()),this.A_P=t}copyFrom(t){this.vbuf=t.vbuf,this.ivsIndex=t.ivsIndex,this.ivsCount=t.ivsCount,this.setMaterial(t.getMaterial())}toString(){return"RODisplay(name="+this.name+",uid="+this.getUid()+", __$ruid="+this.__$ruid+")"}destroy(){null!=this.A_P&&(this.A_P.__$detachThis(),this.A_P.destroy(),this.A_P=null),this.A_Q=null,this.vbuf=null,this.__$ruid=-1,this.__$rpuid=-1,this.__$$rsign=a.DisplayRenderSign.NOT_IN_RENDERER,this.ivsIndex=0,this.ivsCount=0,this.A_R=null,this.__$$runit=null}static GetFreeId(){return l.W.length>0?l.W.pop():-1}static GetByUid(t){return l.X[t]}static IsEnabledByUid(t){return l.Y[t]==l.BI}static Create(){let t=null,e=l.GetFreeId();return e>=0?(t=l.X[e],l.Y[e]=l.BI):(t=new l,l.X.push(t),l.Y.push(l.BI),l.Z++),t}static Restore(t){if(null!=t&&l.Y[t.getUid()]==l.BI){let e=t.getUid();l.W.push(e),l.Y[e]=l.BS,t.destroy()}}}l.BF=0,l.BI=1,l.BS=0,l.Y=[],l.Z=0,l.X=[],l.W=[],e.default=l},debe:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s("3221");class a extends i.UniformComp{constructor(){super(),this.A_T=null,this.A_U=null,this.A_V=null,this.A_W=-1,this.A_X=-1,this.A_Y=-1,this.uvTransformEnabled=!1,this.curveMoveMap=null,this.displacementMap=null}initialize(){if(null==this.z){this.v="";let t=0;if(this.uvTransformEnabled&&(this.A_W=t,t++,this.v+="UV"),null!=this.curveMoveMap&&(this.A_X=t,t++,this.v+="CM"),null!=this.displacementMap&&(this.A_Y=t,t++,this.v+="DC"),t>0){this.z=new Float32Array(4*t);let e=this.A_W;e>=0&&(this.A_T=this.z.subarray(4*e,4*(e+1)),this.A_T.set([1,1,0,0])),e=this.A_X,e>=0&&(this.A_U=this.z.subarray(4*e,4*(e+1))),e=this.A_Y,e>=0&&(this.A_V=this.z.subarray(4*e,4*(e+1)),this.A_V.set([10,0,0,0]))}}}use(t){this.getParamsTotal()>0&&(t.addVertUniform("vec4","u_vertLocalParams",this.getParamsTotal()),this.A_X>=0&&t.addVertLayout("vec4","a_vs"),this.A_W>=0&&t.addDefine("VOX_VTX_TRANSFORM_PARAM_INDEX",""+this.A_W))}reset(){}destroy(){}getTextures(t,e=null){return this.getParamsTotal()>0?(null==e&&(e=[]),this.A_X>=0&&(e.push(this.curveMoveMap),t.uniform.add2DMap("VTX_CURVE_MOVE_MAP",!1,!1,!0),t.addDefine("VOX_VTX_CURVE_MOVE_PARAM_INDEX",""+this.A_X)),this.A_Y>=0&&(e.push(this.displacementMap),t.uniform.addDisplacementMap(this.A_Y)),e):null}setCurveMoveParam(t,e){null!=this.A_U&&(this.A_U[0]=1/t,this.A_U[2]=e)}setCurveMoveDistance(t){null!=this.A_U&&(this.A_U[1]=t)}setUVScale(t,e){null!=this.A_T&&(this.A_T[0]=t,this.A_T[1]=e)}getUVScale(t){null!=this.A_T&&(t.x=this.A_T[0],t.y=this.A_T[1])}setUVTranslation(t,e){null!=this.A_T&&(this.A_T[2]=t,this.A_T[3]=e)}setDisplacementParams(t,e){null!=this.A_V&&(this.A_V[0]=t,this.A_V[1]=e)}clone(){let t=new a;return t.uvTransformEnabled=this.uvTransformEnabled,t.displacementMap=this.displacementMap,t.curveMoveMap=this.curveMoveMap,t}buildShaderUniformData(t){this.getParamsTotal()>0&&(t.uniformNameList.push("u_vertLocalParams"),t.dataList.push(this.getParams()))}}e.VertUniformComp=a},e08e:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{}i.ELEMENTS_TRIANGLES=1,i.ELEMENTS_TRIANGLE_STRIP=2,i.ELEMENTS_TRIANGLE_FAN=3,i.ELEMENTS_INSTANCED_TRIANGLES=4,i.ARRAYS_LINES=5,i.ARRAYS_LINE_STRIP=6,i.ARRAYS_POINTS=7,i.ELEMENTS_LINES=8,i.DISABLE=0,e.RenderDrawMode=i;class a{}a.NORMAL=1,a.OPAQUE=1,a.TRANSPARENT=2,a.ALPHA_ADD=3,a.ADD=4,a.ADD_LINEAR=5,a.INVERSE_ALPHA=6,a.BLAZE=7,a.OVERLAY=8,a.OVERLAY2=8,a.DISABLE=0,e.RenderBlendMode=a;class r{}r.NEVER=1,r.LESS=1,r.EQUAL=1,r.GREATER=1,r.NOTEQUAL=1,r.GEQUAL=1,r.ALWAYS=1,e.GLStencilFunc=r;class l{}l.KEEP=1,l.ZERO=1,l.REPLACE=1,l.INCR=1,l.INCR_WRAP=1,l.DECR=1,l.DECR_WRAP=1,l.INVERT=1,e.GLStencilOp=l;class n{}n.ZERO=1,n.ONE=1,n.SRC_COLOR=1,n.DST_COLOR=1,n.SRC_ALPHA=1,n.DST_ALPHA=1,n.ONE_MINUS_SRC_ALPHA=1,e.GLBlendMode=n;class _{}_.FUNC_ADD=1,_.FUNC_SUBTRACT=1,_.FUNC_REVERSE_SUBTRACT=1,_.MIN_EXT=1,_.MAX_EXT=1,_.MIN=1,_.MAX=1,e.GLBlendEquation=_;class h{}h.BACK=1,h.FRONT=2,h.FRONT_AND_BACK=3,h.NONE=0,h.DISABLE=0,e.CullFaceMode=h;class o{}o.NEVER=1,o.ALWAYS=2,o.SKY=3,o.TRUE_LESS_EQUAL=3,o.OPAQUE=4,o.TRUE_LESS=4,o.OPAQUE_OVERHEAD=5,o.FALSE_EQUAL=5,o.FALSE_LESS=6,o.BLEND=6,o.BLEND_SORT=6,o.TRANSPARENT_SORT=6,o.TRUE_LEQUAL=7,o.WIRE_FRAME=7,o.FALSE_LEQUAL=8,o.DECALS=8,o.NEXT_LAYER=11,o.WIRE_FRAME_NEXT=12,o.TRUE_EQUAL=13,o.TRUE_GREATER=14,o.TRUE_GEQUAL=15,o.DISABLE=0,e.DepthTestMode=o;class u{}u.SCENE_RO_FILTER_BEGIN=1<<19,u.SCENE_RO_FILTER_FINISH=2<<19,u.SCENE_RO_ERASE=0,e.RenderConst=u,function(t){t[t["NOT_IN_RENDERER"]=-1]="NOT_IN_RENDERER",t[t["GO_TO_RENDERER"]=1]="GO_TO_RENDERER",t[t["LIVE_IN_RENDERER"]=2]="LIVE_IN_RENDERER"}(e.DisplayRenderSign||(e.DisplayRenderSign={}))},e160:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{IntersectRL(t,e,s){let i=0,a=(s.min.x-e.x)/t.x,r=(s.max.x-e.x)/t.x;a>r&&(i=r,r=a,a=i);let l=(s.min.y-e.y)/t.y,n=(s.max.y-e.y)/t.y;if(l>n&&(i=n,n=l,l=i),a>n||l>r)return!1;l>a&&(a=l),n<r&&(r=n);let _=(s.min.z-e.z)/t.z,h=(s.max.z-e.z)/t.z;return _>h&&(i=h,h=_,_=i),!(a>h||_>r)&&(_>a&&(a=_),h<r&&(r=h),!0)}static IntersectionRL3(t,e,s,i,a,r){return s.w=(t[e[0]].x-a.x)*s.x,i.w=(t[1-e[0]].x-a.x)*s.x,r.x=(t[e[1]].y-a.y)*s.y,r.y=(t[1-e[1]].y-a.y)*s.y,!(s.w>r.y||r.x>i.w)&&(r.x>s.w&&(s.w=r.x),r.y<i.w&&(i.w=r.y),r.x=(t[e[2]].z-a.z)*s.z,r.y=(t[1-e[2]].z-a.z)*s.z,!(s.w>r.y||r.x>i.w)&&(r.x>s.w&&(s.w=r.x),r.y<i.w&&(i.w=r.y),r.copyFrom(i),r.scaleBy(s.w),r.addBy(a),i.w=1,!0))}static IntersectionRL1(t,e,s,i){let a=0,r=(s.min.x-e.x)/t.x,l=(s.max.x-e.x)/t.x;r>l&&(a=l,l=r,r=a);let n=(s.min.y-e.y)/t.y,_=(s.max.y-e.y)/t.y;if(n>_&&(a=_,_=n,n=a),r>_||n>l)return!1;n>r&&(r=n),_<l&&(l=_);let h=(s.min.z-e.z)/t.z,o=(s.max.z-e.z)/t.z;return h>o&&(a=o,o=h,h=a),!(r>o||h>l)&&(h>r&&(r=h),o<l&&(l=o),i.copyFrom(t),i.scaleBy(r),i.addBy(e),!0)}static IntersectionRL2(t,e,s,i){i.x=s.center.x-e.x,i.y=s.center.y-e.y,i.z=s.center.z-e.z;let a=i.dot(t);if(i.x-=a*t.x,i.y-=a*t.y,i.z-=a*t.z,i.getLengthSquared()>s.radius2)return!1;if(s.containsV(e))return i.copyFrom(e),!0;if(e.x<s.min.x){if(t.x>0&&(a=(s.min.x-e.x)/t.x,i.copyFrom(t),i.scaleBy(a),i.addBy(e),s.containsYZ(i.y,i.z)))return!0}else if(e.x>s.max.x&&t.x<0&&(a=(s.max.x-e.x)/t.x,i.copyFrom(t),i.scaleBy(a),i.addBy(e),s.containsYZ(i.y,i.z)))return!0;if(e.y<s.min.y){if(t.y>0&&(a=(s.min.y-e.y)/t.y,i.copyFrom(t),i.scaleBy(a),i.addBy(e),s.containsXZ(i.x,i.z)))return!0}else if(e.y>s.max.y&&t.y<0&&(a=s.max.y,a=(s.max.y-e.y)/t.y,i.copyFrom(t),i.scaleBy(a),i.addBy(e),s.containsXZ(i.x,i.z)))return!0;if(e.z<s.min.z){if(t.z>0&&(a=(s.min.z-e.z)/t.z,i.copyFrom(t),i.scaleBy(a),i.addBy(e),s.containsXY(i.x,i.y)))return!0}else if(e.z>s.max.z&&t.z<0&&(a=(s.max.z-e.z)/t.z,i.copyFrom(t),i.scaleBy(a),i.addBy(e),s.containsXY(i.x,i.y)))return!0;return!1}}e.AABBCalc=i},e7d2:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("8a0a")),r=i(s("710f")),l=i(s("f0f0")),n=i(s("7a04")),_=s("e08e");class h{constructor(t=a.default.VTX_STATIC_DRAW){this.A=0,this.A_Z=null,this.F_=null,this.A_J=0,this.A_a=2,this.A_N=null,this.A_O=null,this.layoutBit=0,this.vertexVer=0,this.indicesVer=0,this.version=0,this.drawMode=_.RenderDrawMode.ELEMENTS_TRIANGLES,this.bufData=null,this.A=h.BF++,this.A_J=t}setVtxBuf(t){t!=this&&(this.A_Z=t,null!=t&&(t.layoutBit=this.layoutBit))}setBufDataUsage(t){this.A_J=t}getUid(){return this.A}getType(){return this.A_Z.getType()}setBufTypeList(t){this.A_N=t}setBufSizeList(t){this.A_O=t}getBufTypeList(){return this.A_N}getBufSizeList(){return this.A_O}getIBufStep(){return this.A_a}getBufDataUsage(){return this.A_J}getBuffersTotal(){return this.A_Z.getBuffersTotal()}getAttribsTotal(){return this.A_Z.getAttribsTotal()}getF32DataAt(t){return this.A_Z.getF32DataAt(t)}getIvsData(){return this.F_}setF32DataAt(t,e,s,i){this.A_Z.setF32DataAt(t,e,s,i),this.vertexVer++}setUintIVSData(t,e=a.default.VTX_STATIC_DRAW){if(t instanceof Uint16Array)this.A_a=2;else{if(!(t instanceof Uint32Array))return;this.A_a=4}this.F_=t,null!=t&&this.indicesVer++}setData4fAt(t,e,s,i,a,r){null!=this.A_Z&&(this.A_Z.setData4fAt(t,e,s,i,a,r),this.vertexVer++)}setData3fAt(t,e,s,i,a){null!=this.A_Z&&(this.A_Z.setData3fAt(t,e,s,i,a),this.vertexVer++)}setData2fAt(t,e,s,i){null!=this.A_Z&&(this.A_Z.setData2fAt(t,e,s,i),this.vertexVer++)}destroy(){}__$destroy(){this.A_Z.destroy(),this.A_Z.getType()<1?h.B8.push(this.A_Z):h.B9.push(this.A_Z),this.A_Z=null,this.F_=null,this.bufData=null,this.A_N=null,this.A_O=null}toString(){return"ROVertexBuffer(uid = "+this.A+")"}static GetFreeId(){return h.B_A.length>0?h.B_A.pop():-1}static GetVtxByUid(t){return h.B_B[t]}static Create(t=a.default.VTX_STATIC_DRAW){let e=null,s=h.GetFreeId();return s>=0?(e=h.B_B[s],e.setBufDataUsage(t),h.B_F[s]=h.BI):(e=new h(t),h.B_B.push(e),h.B_F.push(h.BI),h.s_unitListLen++),e.vertexVer=0,e.indicesVer=0,e.version++,h.B_C.__$attachAt(e.getUid()),e}static __$Restore(t){if(null!=t&&h.B_F[t.getUid()]==h.BI){let e=t.getUid();h.B_A.push(e),h.B_F[e]=h.BS,t.__$destroy()}}static __$$AttachAt(t){h.B_C.__$attachAt(t)}static __$$DetachAt(t){h.B_C.__$detachAt(t)}static Reset(){h.BufDataList=[],h.B_D=0,h.BufStatusList=[],h.BufDataStepList=[],h.vtxFS32=null,h.vbWholeDataEnabled=!1,h.dynBufSegEnabled=!1,h.useBufByIndexEnabled=!1}static AddFloat32Data(t,e,s=a.default.VTX_STATIC_DRAW){h.BufDataList.push(t),h.BufDataStepList.push(e),h.BufStatusList.push(s),h.B_D+=e}static CreateBySaveData(t=a.default.VTX_STATIC_DRAW,e=0){let s=0,i=0,r=0,n=h.BufDataStepList.length,_=[];for(;s<n;s++)_.push(r),r+=h.BufDataStepList[s];let o=h.BufDataList[0].length/h.BufDataStepList[0],u=new Float32Array(r*o),m=0,d=0,c=null,f=null;for(s=0;s<o;++s)for(i=s*r,m=0;m<n;++m)d=h.BufDataStepList[m],c=h.BufDataList[m],f=c.subarray(s*d,(s+1)*d),u.set(f,i),i+=d;let p=h.Create(t);if(p.layoutBit=e,h.B8.length>0){let t=h.B8.pop();p.setVtxBuf(t)}else p.setVtxBuf(new l.default(p.getBufDataUsage()));return p.setF32DataAt(0,u,r,_),p}static CreateVtxCombinedBuf(t,e,s=a.default.VTX_STATIC_DRAW,i=0){let r=0,n=0,_=e.length,o=[];for(;r<_;r++)o.push(n),n+=e[r];let u=h.Create(s);if(u.layoutBit=i,h.B8.length>0){let t=h.B8.pop();u.setVtxBuf(t)}else u.setVtxBuf(new l.default(u.getBufDataUsage()));return u.setF32DataAt(0,t,n,o),u}static UpdateBufData(t){let e=0,s=0,i=0,a=h.BufDataStepList.length,r=h.BufDataList[0].length/h.BufDataStepList[0],l=t.getF32DataAt(0),n=h.B_D*r!=l.length,_=null;if(n)for(_=[],l=new Float32Array(h.B_D*r);e<a;e++)_.push(i),i+=h.BufDataStepList[e];else i=h.B_D;let o=0,u=0,m=null,d=null;for(e=0;e<r;++e)for(s=e*i,o=0;o<a;++o)u=h.BufDataStepList[o],m=h.BufDataList[o],d=m.subarray(e*u,(e+1)*u),l.set(d,s),s+=u;n?t.setF32DataAt(0,l,i,_):t.setF32DataAt(0,l,i,null)}static CreateByBufDataSeparate(t,e=a.default.VTX_STATIC_DRAW,s=0){let i=0,r=0,l=t.getAttributesTotal(),_=new Array(l);_.fill(0);let o=h.Create(e);if(o.layoutBit=s,h.B9.length>0){let t=h.B9.pop();o.setVtxBuf(t)}else o.setVtxBuf(new n.default);for(i=0;i<l;i++)o.setF32DataAt(i,t.getAttributeDataAt(i,0),r,_);return o.setUintIVSData(t.getIndexDataAt(0)),o.bufData=t,o}static CreateBySaveDataSeparate(t=a.default.VTX_STATIC_DRAW){let e=0,s=0,i=h.BufDataStepList.length,r=new Array(i);r.fill(0);let l=h.Create(t);if(h.B9.length>0){let t=h.B9.pop();l.setVtxBuf(t)}else l.setVtxBuf(new n.default);for(e=0;e<i;e++)l.setF32DataAt(e,h.BufDataList[e],s,r);return l}static GetVtxAttachCountAt(t){return h.B_C.getAttachCountAt(t)}static GetVtxAttachAllCount(){return h.B_C.getAttachAllCount()}static ClearTest(){if(--h.B_E,h.B_E<1){h.B_E=128;let t=h.B_C;if(t.__$getRemovedListLen()>0){let e=t.__$getRemovedList(),s=e.length,i=0,a=0,r=null,l=32;for(s=s>l?l:s;i<s;++i)a=e.shift(),t.getAttachCountAt(a)<1&&(r=h.GetVtxByUid(a),h.__$Restore(r))}}}}h.BF=0,h.B8=[],h.B9=[],h.BI=1,h.BS=0,h.B_F=[],h.s_unitListLen=0,h.B_B=[],h.B_A=[],h.B_C=new r.default,h.B_D=0,h.BufDataList=null,h.BufDataStepList=null,h.BufStatusList=null,h.vtxDataFS32=null,h.vbWholeDataEnabled=!1,h.dynBufSegEnabled=!1,h.useBufByIndexEnabled=!1,h.vtxFS32=null,h.B_E=128,e.default=h},ea5a:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=s("1b95"),r=s("251a"),l=i(s("f63e")),n=s("b4ea"),_=s("6c6b"),h=i(s("96e4")),o=s("debe"),u=s("2fe4"),m=i(s("91e2"));e.Box3DEntity=m.default;const d=i(s("402a"));e.DisplayEntity=d.default;const c=i(s("3bfb"));e.Box3DMesh=c.default;const f=s("8d98"),p=i(s("76b0"));e.RectPlaneMesh=p.default;class S{constructor(){this.hdrBrnEnabled=!1,this.texture=null,this.width=128,this.height=128}createTexture(t,e){if(null==this.texture){let s=e.textureBlock;this.texture=t?s.createBytesCubeTex(32,32):s.createFloatCubeTex(32,32)}}createFloat(t,e){this.createTexture(!1,t);let s=0,i=this.width,a=this.height,r=3,l=new Float32Array(e),n=null,_=this.texture;_.toRGBFormat(),_.minFilter=f.TextureConst.LINEAR_MIPMAP_LINEAR,_.magFilter=f.TextureConst.LINEAR;for(let h=0;h<9;h++){for(let t=0;t<6;t++){const e=i*a*r;n=l.subarray(s,s+e),_.setDataFromBytesToFaceAt(t,n,i,a,h),s+=e}i>>=1,a>>=1}return this.texture}createHdrBrn(t,e){this.createTexture(!0,t);let s=new Uint16Array(e),i=new Uint8Array(e),a=0,r=s[4],l=s[5],n=s[6],_=0,h=i.subarray(32),o=this.texture;o.mipmapEnabled=n<=1,o.minFilter=f.TextureConst.LINEAR_MIPMAP_LINEAR,o.magFilter=f.TextureConst.LINEAR;for(let u=0;u<n;u++){for(let t=0;t<6;t++)_=r*l*4,o.setDataFromBytesToFaceAt(t,h.subarray(a,a+_),r,l,u),a+=_;r>>=1,l>>=1}return this.texture}}e.SpecularTextureBuilder=S;class g{constructor(){this.A6=null,this.A_b=null}initialize(t){this.A6=t;let e=t,s=new a.RenderableMaterialBlock;s.initialize(),e.materialBlock=s;let i=new r.RenderableEntityBlock;i.initialize(),e.entityBlock=i}createDefaultMaterial(t=!1){let e=new l.default;return e.normalEnabled=t,e}createMaterialContext(){return new n.MaterialContext}createLambertMaterial(t=!0){let e=t?new o.VertUniformComp:null,s=new h.default;s.vertUniform=e;let i=new _.Material;return i.setDecorator(s),i}createPBRMaterial(t=!0){let e=t?new o.VertUniformComp:null,s=new u.PBRDecorator;s.vertUniform=e;let i=new _.Material;return i.setDecorator(s),i}createSpecularTex(t,e){return t?this.A_b.createHdrBrn(this.A6,e):this.A_b.createFloat(this.A6,e)}}e.Instance=g},ee6e:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("0fc4")),r=i(s("faa5"));class l extends r.default{constructor(){super(),this.n="",this.decorator=null,this.vertUniform=null}initialize(t){super.initialize(t),this.n="SMS_",t&&(this.n+="Tex")}createTextureList(){return this.AR.reset(),this.decorator.buildTextureList(this.AR),this.AR.getTextures()}buildShader(){null!=this.vertUniform&&this.vertUniform.use(this.A_y),this.decorator.buildShader(this.A_y)}getUniqueShaderName(){let t=this.n+this.decorator.getUniqueName();return null!=this.vertUniform&&(t+=this.vertUniform.getUniqueNSKeyString()),t}}class n extends a.default{constructor(){super(),this.AS=null,this.vertUniform=null,null==n.Bs&&(n.Bs=new l)}buildBuf(){let t=n.Bs,e=this.AS;t.decorator=e,e.buildBufParams(),t.vertColorEnabled=e.vertColorEnabled,t.shadowReceiveEnabled=e.premultiplyAlpha,t.fogEnabled=e.fogEnabled,t.buildPipelineParams(),t.vertUniform=this.vertUniform;let s=t.createTextureList();null!=this.vertUniform&&this.vertUniform.getTextures(t.getShaderCodeBuilder(),s),t.getTexturesFromPipeline(s),super.setTextureList(s)}getCodeBuf(){return n.Bs}setTextureList(t){}setDecorator(t){this.AS=t}getDecorator(){return this.AS}createSelfUniformData(){let t=this.AS.createUniformData();return null!=this.vertUniform&&null!=t&&this.vertUniform.buildShaderUniformData(t),t}destroy(){super.destroy(),this.AS=null,this.vertUniform=null}}n.Bs=null,e.SimpleMaterial=n},f044:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{static CreateNewID(){return i.BF++}}i.BF=0,e.default=i},f0f0:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("f044"));class r{constructor(t){this.A=-1,this.AW=0,this.layoutBit=0,this.A_c=null,this.A_d=null,this.A_e=0,this.A=a.default.CreateNewID()}getUid(){return this.A}getType(){return 0}getBuffersTotal(){return 1}getAttribsTotal(){return this.A_c.length}getF32DataAt(t){return this.A_d}setF32DataAt(t,e,s,i){null!=i&&(this.A_c=i),this.A_e=s,this.A_d=e}setData4fAt(t,e,s,i,a,r){t=this.A_e*t+this.A_c[e],this.A_d[t++]=s,this.A_d[t++]=i,this.A_d[t++]=a,this.A_d[t++]=r}setData3fAt(t,e,s,i,a){t=this.A_e*t+this.A_c[e],this.A_d[t++]=s,this.A_d[t++]=i,this.A_d[t++]=a}setData2fAt(t,e,s,i){t=this.A_e*t+this.A_c[e],this.A_d[t++]=s,this.A_d[t++]=i}destroy(){this.A_c=null,this.A_d=null}toString(){return"VtxCombinedBuf(uid = "+this.A+")"}}e.default=r},f208:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(){this.info=""}}e.default=i},f3a2:function(t,e,s){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t["None"]="",t["Default"]="pbr",t["Lambert"]="lambert",t["PBR"]="pbr"}(i||(i={})),e.ShaderCodeUUID=i},f63b:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("6e01")),r=s("8d98"),l=i(s("3b73"));function n(t,e,s){var i=document.createElement("canvas");i.width=e,i.height=s,i.style.backgroundColor="transparent",i.style.display="block",i.style.left="0px",i.style.top="0px",i.style.position="absolute";let a=i.getContext("2d");return a.drawImage(t,0,0,t.width,t.height,0,0,i.width,i.height),{canvas:i,ctx2d:a}}function _(t,e,s){var i=document.createElement("canvas");i.width=e,i.height=s,i.style.backgroundColor="transparent",i.style.display="block",i.style.left="0px",i.style.top="0px",i.style.position="absolute";let a=i.getContext("2d");return a.globalCompositeOperation="destination-atop",a.fillStyle="rgba(255, 255, 255, 1.0)",a.rect(0,0,i.width,i.height),a.fill(),a.drawImage(t,0,0,t.width,t.height,0,0,i.width,i.height),{canvas:i,ctx2d:a}}class h{constructor(t,e){this.A_f="",this.A_g=null,this.A_h=!1,this.A_i=0,this.texture=null,this.bytesTex=null,this.powerOf2Fix=!1,this.offsetTex=null,this.premultipliedAlpha=!0,this.A_f=t,this.A_i=e}startLoad(){if(null==this.A_g){let t=this;this.A_g=new Image,this.A_g.onload=function(e){t.A_h=!0,t.buildTex()},this.A_g.addEventListener("error",e=>{t.A_f}),this.A_g.crossOrigin="",this.A_g.src=this.A_f}}buildTex(){let t=this.A_g;if(null!=t&&this.A_h){let e=this.texture,s=this.offsetTex,i=this.bytesTex,r=null,h=a.default.IsPowerOf2(t.width)&&a.default.IsPowerOf2(t.height),o=this.powerOf2Fix;if(l.default.IsWebGL1()&&(o=!0),!h&&o){let h=a.default.CalcCeilPowerOfTwo(t.width),o=a.default.CalcCeilPowerOfTwo(t.height);h>l.default.MAX_TEXTURE_SIZE&&(h=l.default.MAX_TEXTURE_SIZE),o>l.default.MAX_TEXTURE_SIZE&&(h=l.default.MAX_TEXTURE_SIZE);let u=n(t,h,o),m=this.A_i;if(null!=e&&(e.setDataFromImage(u.canvas,m),e.name=this.A_g.src,null!=s&&(u=_(t,h,o),s.setDataFromImage(u.canvas,m))),null!=i)if(this.premultipliedAlpha)r=u.ctx2d.getImageData(0,0,u.canvas.width,u.canvas.height),i.setDataFromBytes(r.data,m,u.canvas.width,u.canvas.height),i.name=this.A_g.src;else{r=u.ctx2d.getImageData(0,0,u.canvas.width,u.canvas.height);let e=r.data,s=_(t,h,o);r=s.ctx2d.getImageData(0,0,s.canvas.width,s.canvas.height);let a=r.data,l=0,n=0,d=0;for(;l<o;++l)for(n=0;n<h;++n)e[d]+=255-a[d],e[d+1]+=255-a[d+1],e[d+2]+=255-a[d+2],d+=4;i.setDataFromBytes(e,m,u.canvas.width,u.canvas.height),i.name=this.A_g.src}}else if(null!=e)this.powerOf2Fix,e.setDataFromImage(t,this.A_i),e.name=this.A_g.src;else if(null!=i){let e=a.default.CalcNearestCeilPow2(t.width),s=a.default.CalcNearestCeilPow2(t.height);e>2048&&(e=2048),s>2048&&(e=2048);let l=n(t,e,s),_=this.A_i;r=l.ctx2d.getImageData(0,0,l.canvas.width,l.canvas.height),i.setDataFromBytes(r.data,_,l.canvas.width,l.canvas.height),i.name=this.A_g.src}this.A_h=!0}}getURL(){return this.A_f}getImage(){return this.A_g}isLoaded(){return this.A_h}destroy(){this.A_h=!1,this.A_f="",this.texture=null,this.A_g.src="",this.A_g=null}}class o{constructor(t){this.A_j=null,this.A_k=[],this.A_D=0,this.A_h=!1,this.g=[],this.A_l=[],this.A_j=t;var e=this;let s=0,i=null;for(;s<6;++s)i=new Image,i.onload=function(t){if(e.A_D++,e.A_D>=6){let t=0;for(t=0;t<6;++t)e.g[0].setDataFromImageToFaceAt(t,e.A_k[t],e.A_l[0]);e.g[0].name=e.A_k.src}},i.crossOrigin="",i.src=e.A_j[s],e.A_k.push(i)}addTex(t,e){this.g.push(t),this.A_l.push(e)}getURLAt(t){return this.A_j[0]}getTexAt(t){return this.g[t]}isLoaded(){return this.A_h}destroy(){}}class u{constructor(t){this.A_m=new Map,this.A_n=new Map,this.A_o=[],this.A_p=[],this.A_q=[],this.A_r=5,this.A_s=17,this.A_t=17,this.A_u=512,this.A_v=512,this.A_w=null,this.A_x=0,this.A_w=t,null!=t&&t.addTexLoader(this)}getTexByUrl(t,e=!0,s=!0,i=!1){let a=this.getImageTexByUrl(t,0,!1,i);return a.mipmapEnabled=s,e&&a.setWrap(r.TextureConst.WRAP_REPEAT),a}getBytesNoPremultipliedAlphaTexByUrl(t,e=0){if(""==t)return null;e<0&&(e=0);let s=this.A_n.get(t);if(null==s){s=new h(t,e),s.premultipliedAlpha=!1,this.A_n.set(t,s);let i=this.A_w.createBytesTex(1,1);return i.name=t,s.bytesTex=i,this.A_p.push(s),i}return s.bytesTex.isDestroyed()&&(s.bytesTex=this.A_w.createBytesTex(1,1)),s.bytesTex}getBytesTexByUrl(t,e=0){if(""==t)return null;e<0&&(e=0);let s=this.A_n.get(t);if(null==s){s=new h(t,e),this.A_n.set(t,s);let i=this.A_w.createBytesTex(1,1);return i.name=t,s.bytesTex=i,this.A_p.push(s),i}return s.bytesTex.isDestroyed()&&(s.bytesTex=this.A_w.createBytesTex(1,1)),s.bytesTex}getImageOffsetTexByUrl(t,e=0){if(""==t)return null;e<0&&(e=0);let s=this.A_n.get(t);return null!=s?s.offsetTex:null}getImageTexByUrl(t,e=0,s=!1,i=!1){if(""==t)return null;e<0&&(e=0);let a=this.A_n.get(t);if(null==a){a=new h(t,e),a.powerOf2Fix=i,s&&(a.offsetTex=this.A_w.createImageTex2D(1,1,!1)),this.A_n.set(t,a);let r=this.A_w.createImageTex2D(1,1,!1);return r.name=t,a.texture=r,this.A_p.push(a),r}return a.texture.isDestroyed()&&(a.texture=this.A_w.createImageTex2D(1,1,!1)),a.texture}getCubeTexAndLoadImg(t,e,s=0){if(""==t||null==e||e.length<6)return null;s<0&&(s=0);let i=this.A_m.get(t);if(null==i){i=new o(e),this.A_m.set(t,i);let a=this.A_w.createImageCubeTex(8,8);return i.addTex(a,s),a}return i.getTexAt(0)}setRunFlag(t){this.A_x=t}getRunFlag(){return this.A_x}isRunning(){return!0}isStopped(){return!1}run(){let t=0,e=null;if(--this.A_s,this.A_s<1){this.A_s=this.A_t;let s=this.A_q.length;if(s>0)for(;t<s;++t)this.A_q[t].isLoaded()&&(this.A_o.push(this.A_q[t]),this.A_q.splice(t,1),--t,--s);let i=this.A_p.length;if(i>0&&s<this.A_r)for(t=s;t<this.A_r;++t){if(!(this.A_p.length>0))break;e=this.A_p.pop(),this.A_q.push(e),e.startLoad()}}if(--this.A_u,this.A_u<1){this.A_u=this.A_v;let s=null,i=this.A_o.length;for(t=0;t<i;++t)e=this.A_o[t],s=null!=e.texture?e.texture:e.bytesTex,s.isDestroyed()&&(this.A_n.delete(e.getURL()),this.A_o.splice(t,1),e.destroy(),--t,--i)}}getWaitTotal(){return this.A_p.length}isLoadedAll(){return this.A_p.length<1}}e.default=u},f63e:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("b3bd")),r=i(s("0fc4")),l=i(s("faa5"));class n extends l.default{constructor(){super(),this.n="",this.normalEnabled=!1,this.vtxMatrixTransform=!0}initialize(t){super.initialize(t),this.n="VOX_Default3DShd",this.A_1&&(this.n+="_tex"),this.vertColorEnabled&&(this.n+="_vtxColor"),this.premultiplyAlpha&&(this.n+="_preMulAlpha"),this.adaptationShaderVersion=!1}buildShader(){let t=this.A_y;t.addVertLayout("vec3","a_vs"),t.addFragUniform("vec4","u_color"),this.vtxMatrixTransform?(t.addDefine("VOX_VTX_MAT_TRANSFORM"),t.useVertSpaceMats(!0,!0,!0)):t.useVertSpaceMats(!1,!1,!1),this.A_1&&(this.AL.addDiffuseMap(),t.addVertLayout("vec2","a_uvs"),t.addVarying("vec2","v_uv")),this.normalEnabled&&t.addFragHeadCode("const vec3 direc = normalize(vec3(0.3,0.6,0.9));"),this.vertColorEnabled&&(t.addVertLayout("vec3","a_cvs"),t.addVarying("vec3","v_cv")),t.addFragOutput("vec4","FragColor0"),t.addFragMainCode("\n    FragColor0 = vec4(1.0);\n    #ifdef VOX_USE_2D_MAP\n        //  FragColor0 *= VOX_Texture2D(VOX_DIFFUSE_MAP, vec2(v_uv[0],v_uv[1]));\n        FragColor0 *= VOX_Texture2D(VOX_DIFFUSE_MAP, v_uv.xy);\n    #endif\n    #ifdef VOX_USE_VTX_COLOR\n        FragColor0.xyz *= v_cv.xyz;\n    #endif\n    #ifdef VOX_PREMULTIPLY_ALPHA\n        FragColor0.rgb *= u_color.xyz;\n        FragColor0.a *= u_color.w;\n        FragColor0.rgb *= u_color.aaa;\n    #else\n        FragColor0 *= u_color;\n    #endif\n    #ifdef VOX_USE_NORMAL\n        float nDotL = max(dot(v_worldNormal.xyz, direc), 0.0);\n        FragColor0.xyz = FragColor0.xyz * 0.7 + 0.3 * FragColor0.xyz * vec3(nDotL);\n    #endif\n"),t.addVertMainCode("\n    localPosition = vec4(a_vs.xyz,1.0);\n    #ifdef VOX_VTX_MAT_TRANSFORM\n        worldPosition = u_objMat * localPosition;\n        oWorldPosition = worldPosition;\n        viewPosition = u_viewMat * worldPosition;\n        gl_Position = u_projMat * viewPosition;\n        #ifdef VOX_USE_NORMAL\n            v_worldNormal = normalize( a_nvs.xyz * inverse(mat3(u_objMat)) );\n        #endif\n    #else\n        gl_Position = localPosition;\n        #ifdef VOX_USE_NORMAL\n            v_worldNormal = normalize( a_nvs.xyz );\n        #endif\n    #endif\n\n    #ifdef VOX_USE_2D_MAP\n        v_uv = a_uvs.xy;\n    #endif\n    #ifdef VOX_USE_VTX_COLOR\n        v_cv = a_cvs.xyz;\n    #endif\n")}getUniqueShaderName(){return this.n}}class _ extends r.default{constructor(){super(),this.A_z=new Float32Array([1,1,1,1]),this.vertColorEnabled=!1,this.premultiplyAlpha=!1,this.normalEnabled=!1,this.shadowReceiveEnabled=!1,this.vtxMatrixTransform=!0,null==_.B_G&&(_.B_G=new n)}buildBuf(){let t=_.B_G;t.getShaderCodeBuilder().normalEnabled=this.normalEnabled,t.vertColorEnabled=this.vertColorEnabled,t.premultiplyAlpha=this.premultiplyAlpha,t.normalEnabled=this.normalEnabled,t.shadowReceiveEnabled=this.shadowReceiveEnabled,t.vtxMatrixTransform=this.vtxMatrixTransform}getCodeBuf(){return _.B_G}setRGB3f(t,e,s){this.A_z[0]=t,this.A_z[1]=e,this.A_z[2]=s}getRGB3f(t){let e=this.A_z;t.setRGB3f(e[0],e[1],e[2])}setRGBA4f(t,e,s,i){this.A_z[0]=t,this.A_z[1]=e,this.A_z[2]=s,this.A_z[3]=i}getRGBA4f(t){let e=this.A_z;t.setRGBA4f(e[0],e[1],e[2],e[3])}setAlpha(t){this.A_z[3]=t}createSelfUniformData(){let t=new a.default;return t.uniformNameList=["u_color"],t.dataList=[this.A_z],t}}_.B_G=null,e.default=_},faa5:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=s("f3a2"),r=i(s("4a54")),l=s("5216"),n=s("3113"),_=s("4efa");class h{constructor(){this.A_y=null,this.A_0=null,this.g=null,this.A_1=!0,this.pipeline=null,this.vertColorEnabled=!1,this.premultiplyAlpha=!1,this.shadowReceiveEnabled=!1,this.lightEnabled=!1,this.fogEnabled=!1,this.envAmbientLightEnabled=!1,this.brightnessOverlayEnabeld=!1,this.glossinessEnabeld=!0,this.pipeTypes=null,this.keysString="",this.adaptationShaderVersion=!0,null==h.B_I&&(h.B_H=new n.ShaderCodeUniform,h.B_I=new r.default(h.B_H),h.B_H.__$setCodeBuilder(h.B_I),h.B_J=new _.ShaderTextureBuilder(h.B_I))}reset(){this.A_y=h.B_I,this.AL=h.B_H,this.AR=h.B_J,this.A_2=this.AL,this.A_y.reset(),this.g=null,this.pipeTypes=null,this.vertColorEnabled=!1,this.premultiplyAlpha=!1,this.shadowReceiveEnabled=!1,this.lightEnabled=!1,this.fogEnabled=!1,this.envAmbientLightEnabled=!1,this.brightnessOverlayEnabeld=!1,this.glossinessEnabeld=!0,this.keysString=""}clear(){this.A_y=null}setShaderCodeObject(t){this.A_0=t}getShaderCodeObject(){return this.A_0}getShaderCodeObjectUUID(){return a.ShaderCodeUUID.None}getShaderCodeBuilder(){return h.B_I}static GetPreCompileInfo(){return h.B_I.getPreCompileInfo()}initialize(t){this.A_1=t,this.bufInitWithPipeline()}buildDefine(){this.premultiplyAlpha&&(this.A_y.addDefine("VOX_PREMULTIPLY_ALPHA"),this.keysString+="A"),this.vertColorEnabled&&(this.A_y.addDefine("VOX_USE_VTX_COLOR"),this.keysString+="UVC"),this.brightnessOverlayEnabeld&&(this.A_y.addDefine("VOX_USE_BRIGHTNESS_OVERLAY_COLOR"),this.keysString+="UBOC"),this.glossinessEnabeld&&(this.A_y.addDefine("VOX_USE_GLOSSINESS"),this.keysString+="UG")}buildPipelineParams(){if(null!=this.pipeline){null==this.pipeTypes&&(this.pipeTypes=[]);let t=l.MaterialPipeType;this.lightEnabled&&!this.pipeTypes.includes(t.GLOBAL_LIGHT)&&this.pipeTypes.push(t.GLOBAL_LIGHT),this.shadowReceiveEnabled&&!this.pipeTypes.includes(t.VSM_SHADOW)&&this.pipeTypes.push(t.VSM_SHADOW),this.fogEnabled&&!this.pipeTypes.includes(t.FOG_EXP2)&&this.pipeTypes.push(t.FOG_EXP2),this.envAmbientLightEnabled&&!this.pipeTypes.includes(t.ENV_AMBIENT_LIGHT)&&this.pipeTypes.push(t.ENV_AMBIENT_LIGHT)}}getTexturesFromPipeline(t){null!=this.pipeline&&this.pipeline.getTextures(this.A_y,t,this.pipeTypes)}bufInitWithPipeline(){null!=this.pipeline&&(this.buildPipelineParams(),this.pipeline.buildSharedUniforms(this.pipeTypes),this.pipeline.createKeys(this.pipeTypes),this.keysString+=this.pipeline.getKeysString())}isTexEanbled(){return this.A_1}setIRenderTextureList(t){this.g=t}getIRenderTextureList(){return this.g}buildShader(){}getFragShaderCode(){return this.A_y.buildFragCode()}getVertShaderCode(){return this.A_y.buildVertCode()}getUniqueShaderName(){throw Error("Illgel operation !!!")}toString(){return"[ShaderCodeBuffer()]"}}e.default=h},fae3:function(t,e,s){"use strict";s.r(e);s("1eb2");var i=s("ea5a");for(var a in i)["default"].indexOf(a)<0&&function(t){s.d(e,t,(function(){return i[t]}))}(a)},fc07:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("3b73")),r=i(s("2e8a")),l=i(s("78e9"));class n{constructor(){this.A_3=new Map,this.attriNSList=null,this.attriSizeList=null,this.uniformNameListStr="",this.texUniformNameListStr="",this.attributes=[null,null,null,null,null,null,null,null,null,null,null,null],this.uniforms=null,this.texTotal=0,this.fragOutputTotal=0}reset(){this.attriNSList=null,this.uniformNameListStr="",this.texUniformNameListStr="";let t=0;for(;t<12;++t)this.attributes[t]=null;this.uniforms=null,this.A_3.clear(),this.texTotal=0}parseVShaderCode(t){let e=new RegExp(";","g");t=t.replace(e,";\n"),t=t.replace("{","{\n"),t=t.replace("}","\n}");let s="\n",i=t.indexOf(s),a=0,n=[],_="",h="",o=new RegExp(" ","g");while(i>=0)_=t.slice(a,i),_.length>0&&(h=_.replace(o,""),0!=h.indexOf("//")&&n.push(_)),a=i+1,i=t.indexOf(s,a);_=t.slice(a,t.length),_.length>0&&(h=_.replace(o,""),0!=h.indexOf("//")&&n.push(_));let u="uniform ",m=n.length,d=null;for(i=0;i<12;++i)this.attributes[i]=null;this.attriNSList=[],this.attriSizeList=[];let c=null;null==this.uniforms&&(this.uniforms=[]),i=0;let f=!1,p=!1;while(i<m)_=n[i],f=_.indexOf("layout")>=0,p=_.indexOf("attribute ")>=0,f&&_.indexOf("location")>0||p?(d=new r.default,d.layoutEnabled=f,d.parseCode(_),this.attributes[d.attriType]=d,this.attriNSList.push(d.name),this.attriSizeList.push(d.typeSize)):_.indexOf(u)>=0&&(c=new l.default,c.parseCode(_)&&(this.uniforms.push(c),this.uniformNameListStr+=c.name+",",c.isTex&&!this.A_3.has(c.name)&&(this.A_3.set(c.name,1),this.texUniformNameListStr+=c.name+",",this.texTotal++))),++i}parseFShaderCode(t){let e=new RegExp(";","g");t=t.replace(e,";\n"),t=t.replace("{","{\n"),t=t.replace("}","\n}");let s="\n",i=t.indexOf(s),r=0,n=[],_="",h="",o=new RegExp(" ","g");while(i>=0)_=t.slice(r,i),_.length>0&&(h=_.replace(o,""),0!=h.indexOf("//")&&n.push(_)),r=i+1,i=t.indexOf(s,r);_=t.slice(r,t.length),_.length>0&&(h=h.replace(o,""),0!=h.indexOf("//")&&n.push(_));let u="uniform ",m=n.length,d=null;null==this.uniforms&&(this.uniforms=[]),i=0;while(i<m)_=n[i],_.indexOf(u)>=0&&this.uniformNameListStr.indexOf(u)<0&&(d=new l.default,d.parseCode(_)&&(this.uniforms.push(d),this.uniformNameListStr+=d.name+",",d.isTex&&!this.A_3.has(d.name)&&(this.A_3.set(d.name,1),this.texUniformNameListStr+=d.name+",",this.texTotal++))),++i;let c="layout";a.default.IsWebGL1()&&(c="gl_FragData"),i=t.indexOf(c),this.fragOutputTotal=0;while(i>0)this.fragOutputTotal++,i=t.indexOf(c,i+2);this.fragOutputTotal<1&&(this.fragOutputTotal=1)}}e.default=n},fecb:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s("6e01")),r=i(s("8e17"));class l{constructor(){this.min=new r.default,this.max=new r.default,this.version=-1,this.radius=50,this.radius2=2500,this.center=new r.default(0,0,0),this.A_4=100,this.A_5=100,this.A_6=100,this.A_7=50,this.A_8=50,this.A_9=50,this.A_=new r.default,this.reset()}getLong(){return this.A_4}getWidth(){return this.A_5}getHeight(){return this.A_6}reset(){let t=this.min;t.x=t.y=t.z=a.default.MATH_MAX_POSITIVE,t=this.max,t.x=t.y=t.z=a.default.MATH_MIN_NEGATIVE}equals(t){return this.min.equalsXYZ(t.min)&&this.max.equalsXYZ(t.max)}setVolume(t,e,s){this.A_5=t,this.A_6=e,this.A_4=s,this.A_7=.5*this.A_4,this.A_8=.5*this.A_5,this.A_9=.5*this.A_6,this.max.x=this.center.x+this.A_8,this.max.y=this.center.y+this.A_9,this.max.z=this.center.z+this.A_7,this.min.x=this.center.x-this.A_8,this.min.y=this.center.y-this.A_9,this.min.z=this.center.z-this.A_7,this.radius2=this.A_8*this.A_8+this.A_9*this.A_9+this.A_7*this.A_7,this.radius=Math.sqrt(this.radius2)}union(t){this.addPosition(t.min),this.addPosition(t.max)}addPosition(t){this.min.x>t.x&&(this.min.x=t.x),this.min.y>t.y&&(this.min.y=t.y),this.min.z>t.z&&(this.min.z=t.z),this.max.x<t.x&&(this.max.x=t.x),this.max.y<t.y&&(this.max.y=t.y),this.max.z<t.z&&(this.max.z=t.z)}addXYZ(t,e,s){this.min.x>t&&(this.min.x=t),this.min.y>e&&(this.min.y=e),this.min.z>s&&(this.min.z=s),this.max.x<t&&(this.max.x=t),this.max.y<e&&(this.max.y=e),this.max.z<s&&(this.max.z=s)}addXYZFloat32Arr(t,e=3){let s=t.length,i=0,a=0,r=0;for(let l=0;l<s;)i=t[l],a=t[l+1],r=t[l+2],l+=e,this.min.x>i&&(this.min.x=i),this.min.y>a&&(this.min.y=a),this.min.z>r&&(this.min.z=r),this.max.x<i&&(this.max.x=i),this.max.y<a&&(this.max.y=a),this.max.z<r&&(this.max.z=r)}addXYZFloat32AndIndicesArr(t,e){let s,i=e.length,a=0,r=0,l=0;for(let n=0;n<i;n++)s=3*n,a=t[s++],r=t[s++],l=t[s],this.min.x>a&&(this.min.x=a),this.min.y>r&&(this.min.y=r),this.min.z>l&&(this.min.z=l),this.max.x<a&&(this.max.x=a),this.max.y<r&&(this.max.y=r),this.max.z<l&&(this.max.z=l)}getClosePosition(t,e,s=0){e.copyFrom(t),e.x<this.min.x?e.x=this.min.x+s:e.x>this.max.x&&(e.x=this.max.x-s),e.y<this.min.y?e.y=this.min.y+s:e.y>this.max.y&&(e.y=this.max.y-s),e.z<this.min.z?e.z=this.min.z+s:e.z>this.max.z&&(e.z=this.max.z-s)}containsV(t){return!(t.x<this.max.x||t.x>this.max.x)&&(!(t.y<this.max.y||t.y>this.max.y)&&!(t.z<this.max.z||t.z>this.max.z))}containsXY(t,e){return!(t<this.min.x||t>this.max.x)&&!(e<this.min.y||e>this.max.y)}containsXZ(t,e){return!(t<this.min.x||t>this.max.x)&&!(e<this.min.z||e>this.max.z)}containsYZ(t,e){return!(t<this.min.y||t>this.max.y)&&!(e<this.min.z||e>this.max.z)}copyFrom(t){this.radius=t.radius,this.radius2=t.radius2,this.min.copyFrom(t.min),this.max.copyFrom(t.max),this.center.copyFrom(t.center),this.updateVolume()}expand(t){this.min.subtractBy(t),this.max.addBy(t)}updateVolume(){this.A_5=this.max.x-this.min.x,this.A_6=this.max.y-this.min.y,this.A_4=this.max.z-this.min.z,this.A_7=.5*this.A_4,this.A_8=.5*this.A_5,this.A_9=.5*this.A_6,++this.version}updateThis(){this.center.x=.5*this.A_5,this.center.y=.5*this.A_6,this.center.z=.5*this.A_4,this.A_7=this.center.z,this.A_8=this.center.x,this.A_9=this.center.y,this.radius2=this.A_8*this.A_8+this.A_9*this.A_9+this.A_7*this.A_7,this.radius=Math.sqrt(this.radius2),this.center.addBy(this.min),++this.version}update(){this.A_5=this.max.x,this.min.x>this.max.x&&(this.max.x=this.min.x,this.min.x=this.A_5),this.A_5=this.max.x-this.min.x,this.A_6=this.max.y,this.min.y>this.max.y&&(this.max.y=this.min.y,this.min.y=this.A_6),this.A_6=this.max.y-this.min.y,this.A_4=this.max.z,this.min.z>this.max.z&&(this.max.z=this.min.z,this.min.z=this.A_4),this.A_4=this.max.z-this.min.z,this.updateThis()}updateFast(){this.A_5=this.max.x-this.min.x,this.A_6=this.max.y-this.min.y,this.A_4=this.max.z-this.min.z,this.updateThis()}toString(){return"[AABB(min->"+this.min+",size("+this.A_5+","+this.A_6+","+this.A_4+"))]"}sphereIntersect(t,e){this.A_.x=this.center.x-t.x,this.A_.y=this.center.y-t.y,this.A_.z=this.center.z-t.z;let s=this.A_.getLengthSquared();return s<this.radius2||(e+=this.radius,e*=e,e>=s)}}e.default=l}})}));