(function(t,i){"object"===typeof exports&&"object"===typeof module?module.exports=i():"function"===typeof define&&define.amd?define([],i):"object"===typeof exports?exports["AppLightModule"]=i():t["AppLightModule"]=i()})("undefined"!==typeof self?self:this,(function(){return function(t){var i={};function e(s){if(i[s])return i[s].exports;var r=i[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,e),r.l=!0,r.exports}return e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:s})},e.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var r in t)e.d(s,r,function(i){return t[i]}.bind(null,r));return s},e.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s="fae3")}({"05f8":function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});class s{constructor(t){this.A=-1,this.B=null,this.C=!1,this.D=null,this.D=t,this.A=s.L++}getUid(){return this.A}update(){null!=this.B&&this.C&&(this.C=!1,this.B.uProbe.update())}getGlobalUinform(){return null!=this.B?this.B.cloneUniform():null}destroy(){null!=this.B&&this.B.destroy(),this.B=null,this.D=null}}s.L=0,i.MaterialPipeBase=s},"084e":function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});class s{constructor(t,i=!0){this.D=null,this.uProbe=null,this.uniform=null,this.D=t,i&&(this.uProbe=t.createShaderUniformProbe(),this.uniform=t.createShaderGlobalUniform())}getNames(){return[]}cloneUniform(){return this.D.cloneShaderGlobalUniform(this.uniform)}buildData(){this.D.updateGlobalUinformDataFromProbe(this.uniform,this.uProbe,this.getNames()),this.uProbe.update()}destroy(){this.uProbe=null,this.uniform=null,this.D=null}}i.GlobalUniformParamBase=s},"1eb2":function(t,i,e){"use strict";if("undefined"!==typeof window){var s=window.document.currentScript,r=e("8875");s=r(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:r});var h=s&&s.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);h&&(e.p=h[1])}},3930:function(t,i,e){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(i,"__esModule",{value:!0});const r=s(e("6e01"));class h{constructor(t=1,i=1,e=1,s=1){this.r=1,this.g=1,this.b=1,this.a=1,this.r=t,this.g=i,this.b=e,this.a=s}setRGB3Bytes(t,i,e){this.r=t/255,this.g=i/255,this.b=e/255}setRGB3f(t,i,e){this.r=t,this.g=i,this.b=e}setRGBUint24(t){this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255}setRGBA4f(t,i,e,s){this.r=t,this.g=i,this.b=e,this.a=s}copyFrom(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a}copyFromRGB(t){this.r=t.r,this.g=t.g,this.b=t.b}scaleBy(t){this.r*=t,this.g*=t,this.b*=t}inverseRGB(){this.r=1-this.r,this.g=1-this.g,this.b=1-this.b}randomRGB(t=1,i=0){this.r=Math.random()*t,this.g=Math.random()*t,this.b=Math.random()*t,this.r+=i,this.g+=i,this.b+=i}normalizeRandom(t=1,i=0){this.r=Math.random(),this.g=Math.random(),this.b=Math.random();let e=Math.sqrt(this.r*this.r+this.g*this.g+this.b*this.b);e>r.default.MATH_MIN_POSITIVE&&(this.r=t*this.r/e,this.g=t*this.g/e,this.b=t*this.b/e),this.r+=i,this.g+=i,this.b+=i}normalize(t){void 0==t&&(t=1);let i=Math.sqrt(this.r*this.r+this.g*this.g+this.b*this.b);i>r.default.MATH_MIN_POSITIVE&&(this.r=t*this.r/i,this.g=t*this.g/i,this.b=t*this.b/i)}getCSSDecRGBAColor(){let t=Math.floor(255*this.r),i=Math.floor(255*this.g),e=Math.floor(255*this.b),s=this.a;return"rgba("+t+","+i+","+e+","+s+")"}getCSSHeXRGBColor(){let t="#",i=Math.floor(255*this.r);return t+=i<15?"0"+i.toString(16):""+i.toString(16),i=Math.floor(255*this.g),t+=i<15?"0"+i.toString(16):""+i.toString(16),i=Math.floor(255*this.b),t+=i<15?"0"+i.toString(16):""+i.toString(16),t}toString(){return"[Color4(r="+this.r+", g="+this.g+",b="+this.b+",a="+this.a+")]"}}i.default=h},5216:function(t,i,e){"use strict";var s;Object.defineProperty(i,"__esModule",{value:!0}),function(t){t[t["ENV_LIGHT_PARAM"]=0]="ENV_LIGHT_PARAM",t[t["ENV_AMBIENT_LIGHT"]=1]="ENV_AMBIENT_LIGHT",t[t["FOG"]=2]="FOG",t[t["FOG_EXP2"]=3]="FOG_EXP2",t[t["VSM_SHADOW"]=4]="VSM_SHADOW",t[t["GLOBAL_LIGHT"]=5]="GLOBAL_LIGHT"}(s||(s={})),i.MaterialPipeType=s},6390:function(t,i,e){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(i,"__esModule",{value:!0});const r=s(e("ab73")),h=e("084e");class o extends h.GlobalUniformParamBase{getNames(){return[r.default.GlobalLight.positionName,r.default.GlobalLight.colorName]}buildUniformData(t,i,e,s){this.uProbe.addVec4Data(t,i),this.uProbe.addVec4Data(e,s),this.buildData()}use(t,i=1,e=1){t.uniform.useCameraPosition(!1,!0),t.addFragUniform(r.default.GlobalLight.type,r.default.GlobalLight.positionName,i),t.addFragUniform(r.default.GlobalLight.type,r.default.GlobalLight.colorName,e)}}i.GlobalLightUniformParam=o},"6a30":function(t,i,e){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(i,"__esModule",{value:!0});const r=s(e("8e17")),h=s(e("3930"));class o{constructor(t=16777215,i=null){this.direction=new r.default(0,-1,0,0),this.color=new h.default(1,1,1,1),this.attenuationFactor1=0,this.attenuationFactor2=0,this.color.setRGBUint24(t),null!=i&&this.direction.copyFrom(i)}}i.DirectionLight=o},"6e01":function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});class s{static Clamp(t,i,e){return Math.max(Math.min(t,e),i)}static IsPowerOf2(t){return 0==(t&t-1)}static CalcCeilPowerOfTwo(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}static CalcNearestCeilPow2(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))}static CalcFloorCeilPow2(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}static DegreeToRadian(t){return s.MATH_PI_OVER_180*t}static Log2(t){return Math.log(t)/Math.LN2}static GetMaxMipMapLevel(t,i){return Math.round(s.Log2(Math.max(t,i))+1)}static SafeACos(t){return t<=-1?s.MATH_PI:t>=1?0:Math.acos(t)}static GetNearestCeilPow2(t){let i=1;while(i<t)i<<=1;return i}static GetMinRadian(t,i){return i%=s.MATH_2PI,t%=s.MATH_2PI,i<t?(i=s.MATH_2PI-t+i,i>s.MATH_PI?i-s.MATH_2PI:i):i>t?(t=s.MATH_2PI-i+t,t>s.MATH_PI?s.MATH_2PI-t:-t):0}static GetMinDegree(t,i){let e=0;return i>=270&&t<90?e=(i-(t+360))%180:i<=90&&t>=270?e=(i+360-t)%180:(e=i-t,e>180?(e-=360,e%=360):e<-180&&(e+=360,e%=360)),e}static GetDegreeByXY(t,i){if(Math.abs(t)<1e-5)return i>=0?270:90;let e=180*Math.atan(i/t)/Math.PI;return t>=0?e:180+e}static GetRadianByXY(t,i){if(Math.abs(t)<s.MATH_MIN_POSITIVE)return i>=0?s.MATH_1PER2PI:s.MATH_3PER2PI;let e=Math.atan(i/t);return t>=0?e:s.MATH_PI+e}static GetRadianByCos(t,i,e){var r=Math.acos(t);return i>=0?r:s.MATH_PI+r}}s.MATH_MIN_POSITIVE=1e-5,s.MATH_MAX_NEGATIVE=-1e-5,s.MATH_MAX_POSITIVE=268435454,s.MATH_MIN_NEGATIVE=-268435454,s.MATH_1_OVER_255=1/255,s.MATH_PI=Math.PI,s.MATH_2PI=2*s.MATH_PI,s.MATH_3PER2PI=1.5*s.MATH_PI,s.MATH_1PER2PI=.5*s.MATH_PI,s.MATH_1_OVER_PI=1/s.MATH_PI,s.MATH_1_OVER_360=1/360,s.MATH_1_OVER_180=1/180,s.MATH_180_OVER_PI=180/s.MATH_PI,s.MATH_PI_OVER_180=s.MATH_PI/180,s.MATH_LN2=.6931471805599453,i.default=s},8602:function(t,i,e){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(i,"__esModule",{value:!0});const r=s(e("8e17")),h=s(e("3930"));class o{constructor(t=16777215,i=null){this.position=new r.default(0,100,0),this.color=new h.default(1,1,1,1),this.attenuationFactor1=1e-4,this.attenuationFactor2=5e-4,this.color.setRGBUint24(t),null!=i&&this.position.copyFrom(i)}}i.PointLight=o},8875:function(t,i,e){var s,r,h;(function(e,o){r=[],s=o,h="function"===typeof s?s.apply(i,r):s,void 0===h||(t.exports=h)})("undefined"!==typeof self&&self,(function(){function t(){var i=Object.getOwnPropertyDescriptor(document,"currentScript");if(!i&&"currentScript"in document&&document.currentScript)return document.currentScript;if(i&&i.get!==t&&document.currentScript)return document.currentScript;try{throw new Error}catch(g){var e,s,r,h=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,o=/@([^@]*):(\d+):(\d+)\s*$/gi,a=h.exec(g.stack)||o.exec(g.stack),n=a&&a[1]||!1,l=a&&a[2]||!1,u=document.location.href.replace(document.location.hash,""),c=document.getElementsByTagName("script");n===u&&(e=document.documentElement.outerHTML,s=new RegExp("(?:[^\\n]+?\\n){0,"+(l-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),r=e.replace(s,"$1").trim());for(var _=0;_<c.length;_++){if("interactive"===c[_].readyState)return c[_];if(c[_].src===n)return c[_];if(n===u&&c[_].innerHTML&&c[_].innerHTML.trim()===r)return c[_]}return null}}return t}))},"8e17":function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const s=180/Math.PI,r=1e-5;class h{constructor(t=0,i=0,e=0,s=1){this.x=0,this.y=0,this.z=0,this.w=0,this.x=t,this.y=i,this.z=e,this.w=s}clone(){return new h(this.x,this.y,this.z,this.w)}setTo(t,i,e,s=1){this.x=t,this.y=i,this.z=e,this.w=s}setXYZ(t,i,e){this.x=t,this.y=i,this.z=e}copyFrom(t){this.x=t.x,this.y=t.y,this.z=t.z}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}multBy(t){this.x*=t.x,this.y*=t.y,this.z*=t.z}normalize(){let t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);t>r&&(this.x/=t,this.y/=t,this.z/=t)}normalizeTo(t){let i=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);i>r?(t.x=this.x/i,t.y=this.y/i,t.z=this.z/i):(t.x=this.x,t.y=this.y,t.z=this.z)}scaleVector(t){this.x*=t.x,this.y*=t.y,this.z*=t.z}scaleBy(t){this.x*=t,this.y*=t,this.z*=t}negate(){this.x=-this.x,this.y=-this.y,this.z=-this.z}equalsXYZ(t){return Math.abs(this.x-t.x)<r&&Math.abs(this.y-t.y)<r&&Math.abs(this.z-t.z)<r}equalsAll(t){return Math.abs(this.x-t.x)<r&&Math.abs(this.y-t.y)<r&&Math.abs(this.z-t.z)<r&&Math.abs(this.w-t.w)<r}project(){let t=1/this.w;this.x*=t,this.y*=t,this.z*=t}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}getLengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}addBy(t){this.x+=t.x,this.y+=t.y,this.z+=t.z}subtractBy(t){this.x-=t.x,this.y-=t.y,this.z-=t.z}subtract(t){return new h(this.x-t.x,this.y-t.y,this.z-t.z)}add(t){return new h(this.x+t.x,this.y+t.y,this.z+t.z)}crossProduct(t){return new h(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}crossBy(t){let i=this.y*t.z-this.z*t.y,e=this.z*t.x-this.x*t.z,s=this.x*t.y-this.y*t.x;this.x=i,this.y=e,this.z=s}reflectBy(t){let i=2*(this.x*t.x+this.y*t.y+this.z*t.z);this.x=this.x-i*t.x,this.y=this.y-i*t.y,this.z=this.z-i*t.z}scaleVecTo(t,i){this.x=t.x*i,this.y=t.y*i,this.z=t.z*i}subVecsTo(t,i){this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z}addVecsTo(t,i){this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z}crossVecsTo(t,i){this.x=t.y*i.z-t.z*i.y,this.y=t.z*i.x-t.x*i.z,this.z=t.x*i.y-t.y*i.x}toString(){return"Vector3D("+this.x+this.y+this.z+")"}static Cross(t,i,e){e.x=t.y*i.z-t.z*i.y,e.y=t.z*i.x-t.x*i.z,e.z=t.x*i.y-t.y*i.x}static CrossSubtract(t,i,e,s,r){h.__vtor3Stv0.x=i.x-t.x,h.__vtor3Stv0.y=i.y-t.y,h.__vtor3Stv0.z=i.z-t.z,h.__vtor3Stv1.x=s.x-e.x,h.__vtor3Stv1.y=s.y-e.y,h.__vtor3Stv1.z=s.z-e.z,t=h.__vtor3Stv0,e=h.__vtor3Stv1,r.x=t.y*e.z-t.z*e.y,r.y=t.z*e.x-t.x*e.z,r.z=t.x*e.y-t.y*e.x}static Subtract(t,i,e){e.x=t.x-i.x,e.y=t.y-i.y,e.z=t.z-i.z}static DistanceSquared(t,i){return h.__vtor3Stv0.x=t.x-i.x,h.__vtor3Stv0.y=t.y-i.y,h.__vtor3Stv0.z=t.z-i.z,h.__vtor3Stv0.getLengthSquared()}static DistanceXYZ(t,i,e,s,r,o){return h.__vtor3Stv0.x=t-s,h.__vtor3Stv0.y=i-r,h.__vtor3Stv0.z=e-o,h.__vtor3Stv0.getLength()}static Distance(t,i){return h.__vtor3Stv0.x=t.x-i.x,h.__vtor3Stv0.y=t.y-i.y,h.__vtor3Stv0.z=t.z-i.z,h.__vtor3Stv0.getLength()}static AngleBetween(t,i){return t.normalizeTo(h.__vtor3Stv0),i.normalizeTo(h.__vtor3Stv1),Math.acos(h.__vtor3Stv0.dot(h.__vtor3Stv1))*s}static RadianBetween(t,i){return t.normalizeTo(h.__vtor3Stv0),i.normalizeTo(h.__vtor3Stv1),Math.acos(h.__vtor3Stv0.dot(h.__vtor3Stv1))}static RadianBetween2(t,i){let e=t.getLengthSquared(),s=i.getLengthSquared();return h.__vtor3Stv0.x=t.x-i.x,h.__vtor3Stv0.y=t.y-i.y,h.__vtor3Stv0.z=t.z-i.z,Math.acos((e+s-h.__vtor3Stv0.getLengthSquared())/(2*Math.sqrt(e)*Math.sqrt(s)))}static Reflect(t,i,e){let s=2*(t.x*i.x+t.y*i.y+t.z*i.z);e.x=t.x-s*i.x,e.y=t.y-s*i.y,e.z=t.z-s*i.z}}h.X_AXIS=new h(1,0,0),h.Y_AXIS=new h(0,1,0),h.Z_AXIS=new h(0,0,1),h.__vtor3Stv0=new h,h.__vtor3Stv1=new h,h.ZERO=new h,i.default=h},ab73:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});class s{constructor(){this.type="vec4",this.data=null,this.name="u_vsmParams",this.arrayLength=3}}class r{constructor(){this.type="vec4",this.data=new Float32Array([.1,.1,.1,1,1,.1,600,3500,.3,0,.9,5e-4,0,0,800,800,-500,-500,1e3,1e3]),this.name="u_envLightParams",this.arrayLength=5}}class h{constructor(){this.type="mat4",this.data=null,this.name="u_shadowMat",this.arrayLength=0}}class o{constructor(){this.type="vec4",this.data=null,this.name="u_stageParam",this.arrayLength=0}}class a{constructor(){this.type="vec4",this.data=null,this.name="u_viewParam",this.arrayLength=0}}class n{constructor(){this.type="vec4",this.data=null,this.name="u_frustumParam",this.arrayLength=0}}class l{constructor(){this.type="vec4",this.data=null,this.name="u_cameraPosition",this.arrayLength=0}}class u{constructor(){this.type="vec4",this.positionName="u_lightPositions",this.colorName="u_lightColors"}}class c{}c.LocalTransformMatUNS="u_objMat",c.CameraViewMatUNS="u_viewMat",c.CameraProjectiveMatUNS="u_projMat",c.FrustumParam=new n,c.CameraPosParam=new l,c.StageParam=new o,c.ViewportParam=new a,c.ShadowMatrix=new h,c.ShadowVSMParams=new s,c.GlobalLight=new u,c.EnvLightParams=new r,i.default=c},e753:function(t,i,e){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(i,"__esModule",{value:!0});const r=s(e("ab73")),h=e("5216"),o=e("05f8"),a=e("6390"),n=e("8602"),l=e("6a30"),u=e("f043");class c extends o.MaterialPipeBase{constructor(){super(...arguments),this.E=null,this.F=null,this.G=0,this.H=0,this.I=null,this.J=null,this.K=null}clamp(t,i,e){return Math.max(Math.min(t,e),i)}degreeToRadian(t){return 180*t/Math.PI}getPointLightsTotal(){return null!=this.I?this.I.length:0}getDirecLightsTotal(){return null!=this.J?this.J.length:0}getSpotLightsTotal(){return null!=this.K?this.K.length:0}getPointLightAt(t){return null!=this.I&&t>=0&&t<this.I.length?this.I[t]:null}getDirectionLightAt(t){return null!=this.J&&t>=0&&t<this.J.length?this.J[t]:null}getSpotLightAt(t){return null!=this.K&&t>=0&&t<this.K.length?this.K[t]:null}appendPointLight(){null==this.I&&(this.I=[]);let t=new n.PointLight;return this.I.push(t),this.H++,t}appendDirectionLight(){null==this.J&&(this.J=[]);let t=new l.DirectionLight;return this.J.push(t),this.H++,t}appendSpotLight(){null==this.K&&(this.K=[]);let t=new u.SpotLight;return this.K.push(t),this.H++,t}updatePointLightData(){if(null!=this.I){let t,i=this.E,e=this.F,s=0;for(let r=0;r<this.I.length;++r)t=this.I[r],s=4*r,i[s]=t.position.x,i[s+1]=t.position.y,i[s+2]=t.position.z,i[s+3]=t.attenuationFactor1,e[s]=t.color.r,e[s+1]=t.color.g,e[s+2]=t.color.b,e[s+3]=t.attenuationFactor2}}updateDirecLighttData(){if(null!=this.J){let t,i=this.E,e=this.F,s=0,r=null!=this.I?this.I.length:0;r*=4;for(let h=0;h<this.J.length;++h)t=this.J[h],s=r+4*h,i[s]=t.direction.x,i[s+1]=t.direction.y,i[s+2]=t.direction.z,i[s+3]=t.attenuationFactor1,e[s]=t.color.r,e[s+1]=t.color.g,e[s+2]=t.color.b,e[s+3]=t.attenuationFactor2}}updateSpotLighttData(){if(null!=this.K){let t,i=this.E,e=this.F,s=0,r=null!=this.I?this.I.length:0;r+=null!=this.J?this.J.length:0,r*=4;for(let h=0;h<this.K.length;++h)t=this.K[h],s=r+4*h,i[s]=t.position.x,i[s+1]=t.position.y,i[s+2]=t.position.z,i[s+3]=t.attenuationFactor1,e[s]=t.color.r,e[s+1]=t.color.g,e[s+2]=t.color.b,e[s+3]=t.attenuationFactor2;r+=4*this.K.length;for(let h=0;h<this.K.length;++h){t=this.K[h];let e=90-this.clamp(t.angleDegree,0,90);e=Math.cos(this.degreeToRadian(e)),s=r+4*h,i[s]=t.direction.x,i[s+1]=t.direction.y,i[s+2]=t.direction.z,i[s+3]=e}}}buildData(){if(null==this.B){let t=this.H,i=this.H,e=4*t;this.G=this.H,null==this.K||(e+=4*this.K.length,this.G+=this.K.length),null==this.E&&(this.E=new Float32Array(e)),null==this.F&&(this.F=new Float32Array(4*i));let s=new a.GlobalLightUniformParam(this.D);s.buildUniformData(this.E,this.G,this.F,i),this.B=s}this.updatePointLightData(),this.updateDirecLighttData(),this.updateSpotLighttData()}showInfo(){}resetPipe(){}getTextures(t,i,e){return null}useShaderPipe(t,i){if(null!=this.B){t.normalEnabled=!0;let i=this.getPointLightsTotal()+this.getDirecLightsTotal()+this.getSpotLightsTotal();i>0?(t.addDefine("VOX_LIGHTS_TOTAL",""+i),this.getPointLightsTotal()>0?t.addDefine("VOX_POINT_LIGHTS_TOTAL",""+this.getPointLightsTotal()):t.addDefine("VOX_POINT_LIGHTS_TOTAL","0"),this.getDirecLightsTotal()>0?t.addDefine("VOX_DIRECTION_LIGHTS_TOTAL",""+this.getDirecLightsTotal()):t.addDefine("VOX_DIRECTION_LIGHTS_TOTAL","0"),this.getSpotLightsTotal()>0?t.addDefine("VOX_SPOT_LIGHTS_TOTAL",""+this.getSpotLightsTotal()):t.addDefine("VOX_SPOT_LIGHTS_TOTAL","0")):t.addDefine("VOX_LIGHTS_TOTAL","0"),this.B.use(t,this.G,this.H)}}getPipeTypes(){return[h.MaterialPipeType.GLOBAL_LIGHT]}getPipeKey(t){switch(t){case h.MaterialPipeType.GLOBAL_LIGHT:let i="";if(this.getPointLightsTotal()>0&&(i=""+this.getPointLightsTotal()),this.getDirecLightsTotal()>0&&(i+=""+this.getDirecLightsTotal()),this.getSpotLightsTotal()>0&&(i+=""+this.getSpotLightsTotal()),""!=i)return"["+t+":"+i+"]";break;default:break}return""}useUniforms(t){null!=this.B&&(t.addFragUniform(r.default.GlobalLight.type,r.default.GlobalLight.positionName,this.G),t.addFragUniform(r.default.GlobalLight.type,r.default.GlobalLight.colorName,this.H))}update(){this.buildData(),null!=this.B&&this.B.uProbe.update()}destroy(){this.E=null,this.F=null,this.H=0,this.I=null,this.J=null,this.K=null,super.destroy()}}i.LightModule=c},ec69:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const s=e("e753");i.LightModule=s.LightModule;const r=e("8602");i.PointLight=r.PointLight;const h=e("6a30");i.DirectionLight=h.DirectionLight;const o=e("f043");i.SpotLight=o.SpotLight;class a{constructor(){}createLightModule(t){let i=t.getRenderProxy().uniformContext;return new s.LightModule(i)}}i.Instance=a,new r.PointLight,new h.DirectionLight,new o.SpotLight},f043:function(t,i,e){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(i,"__esModule",{value:!0});const r=s(e("8e17")),h=s(e("3930"));class o{constructor(){this.position=new r.default(0,100,0),this.direction=new r.default(0,-1,0,0),this.color=new h.default(1,1,1,1),this.angleDegree=30,this.attenuationFactor1=1e-4,this.attenuationFactor2=5e-4}}i.SpotLight=o},fae3:function(t,i,e){"use strict";e.r(i);e("1eb2");var s=e("ec69");for(var r in s)["default"].indexOf(r)<0&&function(t){e.d(i,t,(function(){return s[t]}))}(r)}})}));